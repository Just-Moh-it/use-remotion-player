"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@remotion+player@4.0.47_react-dom@18.2.0_react@18.2.0";
exports.ids = ["vendor-chunks/@remotion+player@4.0.47_react-dom@18.2.0_react@18.2.0"];
exports.modules = {

/***/ "(ssr)/../../node_modules/.pnpm/@remotion+player@4.0.47_react-dom@18.2.0_react@18.2.0/node_modules/@remotion/player/dist/esm/index.mjs":
/*!***************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@remotion+player@4.0.47_react-dom@18.2.0_react@18.2.0/node_modules/@remotion/player/dist/esm/index.mjs ***!
  \***************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Player: () => (/* binding */ Player),\n/* harmony export */   PlayerInternals: () => (/* binding */ PlayerInternals),\n/* harmony export */   Thumbnail: () => (/* binding */ Thumbnail)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/../../node_modules/.pnpm/next@13.5.4_react-dom@18.2.0_react@18.2.0/node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var remotion__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! remotion */ \"(ssr)/../../node_modules/.pnpm/remotion@4.0.47_react-dom@18.2.0_react@18.2.0/node_modules/remotion/dist/esm/index.mjs\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/../../node_modules/.pnpm/next@13.5.4_react-dom@18.2.0_react@18.2.0/node_modules/next/dist/server/future/route-modules/app-page/vendored/shared/react-jsx-runtime.js\");\n\"use client\";\n\n\n\n\nconst calculatePlayerSize = ({ currentSize, width, height, compositionWidth, compositionHeight, }) => {\n    if (width !== undefined && height === undefined) {\n        return {\n            aspectRatio: [compositionWidth, compositionHeight].join('/'),\n        };\n    }\n    // Opposite: If has height specified, evaluate the height and specify a default width.\n    if (height !== undefined && width === undefined) {\n        return {\n            // Aspect ratio CSS prop will work\n            aspectRatio: [compositionWidth, compositionHeight].join('/'),\n        };\n    }\n    if (!currentSize) {\n        return {\n            width: compositionWidth,\n            height: compositionHeight,\n        };\n    }\n    return {\n        width: compositionWidth,\n        height: compositionHeight,\n    };\n};\n\nconst calculateScale = ({ canvasSize, compositionHeight, compositionWidth, previewSize, }) => {\n    const heightRatio = canvasSize.height / compositionHeight;\n    const widthRatio = canvasSize.width / compositionWidth;\n    const ratio = Math.min(heightRatio, widthRatio);\n    return previewSize === 'auto' ? ratio : Number(previewSize);\n};\nconst calculateCanvasTransformation = ({ previewSize, compositionWidth, compositionHeight, canvasSize, }) => {\n    const scale = calculateScale({\n        canvasSize,\n        compositionHeight,\n        compositionWidth,\n        previewSize,\n    });\n    const correction = 0 - (1 - scale) / 2;\n    const xCorrection = correction * compositionWidth;\n    const yCorrection = correction * compositionHeight;\n    const width = compositionWidth * scale;\n    const height = compositionHeight * scale;\n    const centerX = canvasSize.width / 2 - width / 2;\n    const centerY = canvasSize.height / 2 - height / 2;\n    return {\n        centerX,\n        centerY,\n        xCorrection,\n        yCorrection,\n        scale,\n    };\n};\nconst calculateOuterStyle = ({ config, style, canvasSize, }) => {\n    if (!config) {\n        return {};\n    }\n    return {\n        position: 'relative',\n        overflow: 'hidden',\n        ...calculatePlayerSize({\n            compositionHeight: config.height,\n            compositionWidth: config.width,\n            currentSize: canvasSize,\n            height: style === null || style === void 0 ? void 0 : style.height,\n            width: style === null || style === void 0 ? void 0 : style.width,\n        }),\n        ...style,\n    };\n};\nconst calculateContainerStyle = ({ config, canvasSize, layout, scale, }) => {\n    if (!config || !canvasSize || !layout) {\n        return {};\n    }\n    return {\n        position: 'absolute',\n        width: config.width,\n        height: config.height,\n        display: 'flex',\n        transform: `scale(${scale})`,\n        marginLeft: layout.xCorrection,\n        marginTop: layout.yCorrection,\n        overflow: 'hidden',\n    };\n};\nconst calculateOuter = ({ layout, scale, config, }) => {\n    if (!layout || !config) {\n        return {};\n    }\n    const { centerX, centerY } = layout;\n    return {\n        width: config.width * scale,\n        height: config.height * scale,\n        display: 'flex',\n        flexDirection: 'column',\n        position: 'absolute',\n        left: centerX,\n        top: centerY,\n        overflow: 'hidden',\n    };\n};\n\nconst PlayerEventEmitterContext = react__WEBPACK_IMPORTED_MODULE_0__.createContext(undefined);\nconst ThumbnailEmitterContext = react__WEBPACK_IMPORTED_MODULE_0__.createContext(undefined);\n\nclass PlayerEmitter {\n    constructor() {\n        this.listeners = {\n            ended: [],\n            error: [],\n            pause: [],\n            play: [],\n            ratechange: [],\n            scalechange: [],\n            seeked: [],\n            timeupdate: [],\n            frameupdate: [],\n            fullscreenchange: [],\n            volumechange: [],\n            mutechange: [],\n        };\n    }\n    addEventListener(name, callback) {\n        this.listeners[name].push(callback);\n    }\n    removeEventListener(name, callback) {\n        this.listeners[name] = this.listeners[name].filter((l) => l !== callback);\n    }\n    dispatchEvent(dispatchName, context) {\n        this.listeners[dispatchName].forEach((callback) => {\n            callback({ detail: context });\n        });\n    }\n    dispatchSeek(frame) {\n        this.dispatchEvent('seeked', {\n            frame,\n        });\n    }\n    dispatchVolumeChange(volume) {\n        this.dispatchEvent('volumechange', {\n            volume,\n        });\n    }\n    dispatchPause() {\n        this.dispatchEvent('pause', undefined);\n    }\n    dispatchPlay() {\n        this.dispatchEvent('play', undefined);\n    }\n    dispatchEnded() {\n        this.dispatchEvent('ended', undefined);\n    }\n    dispatchRateChange(playbackRate) {\n        this.dispatchEvent('ratechange', {\n            playbackRate,\n        });\n    }\n    dispatchScaleChange(scale) {\n        this.dispatchEvent('scalechange', {\n            scale,\n        });\n    }\n    dispatchError(error) {\n        this.dispatchEvent('error', {\n            error,\n        });\n    }\n    dispatchTimeUpdate(event) {\n        this.dispatchEvent('timeupdate', event);\n    }\n    dispatchFrameUpdate(event) {\n        this.dispatchEvent('frameupdate', event);\n    }\n    dispatchFullscreenChange(event) {\n        this.dispatchEvent('fullscreenchange', event);\n    }\n    dispatchMuteChange(event) {\n        this.dispatchEvent('mutechange', event);\n    }\n}\nclass ThumbnailEmitter {\n    constructor() {\n        this.listeners = {\n            error: [],\n        };\n    }\n    addEventListener(name, callback) {\n        this.listeners[name].push(callback);\n    }\n    removeEventListener(name, callback) {\n        this.listeners[name] = this.listeners[name].filter((l) => l !== callback);\n    }\n    dispatchEvent(dispatchName, context) {\n        this.listeners[dispatchName].forEach((callback) => {\n            callback({ detail: context });\n        });\n    }\n    dispatchError(error) {\n        this.dispatchEvent('error', {\n            error,\n        });\n    }\n}\n\nconst useHoverState = (ref) => {\n    const [hovered, stetHovered] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        const { current } = ref;\n        if (!current) {\n            return;\n        }\n        const onHover = () => {\n            stetHovered(true);\n        };\n        const onLeave = () => {\n            stetHovered(false);\n        };\n        current.addEventListener('mouseenter', onHover);\n        current.addEventListener('mouseleave', onLeave);\n        return () => {\n            current.removeEventListener('mouseenter', onHover);\n            current.removeEventListener('mouseenter', onLeave);\n        };\n    }, [ref]);\n    return hovered;\n};\n\nconst calculateNextFrame = ({ time, currentFrame: startFrame, playbackSpeed, fps, actualLastFrame, actualFirstFrame, framesAdvanced, shouldLoop, }) => {\n    const op = playbackSpeed < 0 ? Math.ceil : Math.floor;\n    const framesToAdvance = op((time * playbackSpeed) / (1000 / fps)) - framesAdvanced;\n    const nextFrame = framesToAdvance + startFrame;\n    const isCurrentFrameOutside = startFrame > actualLastFrame || startFrame < actualFirstFrame;\n    const isNextFrameOutside = nextFrame > actualLastFrame || nextFrame < actualFirstFrame;\n    const hasEnded = !shouldLoop && isNextFrameOutside && !isCurrentFrameOutside;\n    if (playbackSpeed > 0) {\n        // Play forwards\n        if (isNextFrameOutside) {\n            return {\n                nextFrame: actualFirstFrame,\n                framesToAdvance,\n                hasEnded,\n            };\n        }\n        return { nextFrame, framesToAdvance, hasEnded };\n    }\n    // Reverse playback\n    if (isNextFrameOutside) {\n        return { nextFrame: actualLastFrame, framesToAdvance, hasEnded };\n    }\n    return { nextFrame, framesToAdvance, hasEnded };\n};\n\nconst getIsBackgrounded = () => {\n    if (typeof document === 'undefined') {\n        return false;\n    }\n    return document.visibilityState === 'hidden';\n};\nconst useIsBackgrounded = () => {\n    const isBackgrounded = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(getIsBackgrounded());\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        const onVisibilityChange = () => {\n            isBackgrounded.current = getIsBackgrounded();\n        };\n        document.addEventListener('visibilitychange', onVisibilityChange);\n        return () => {\n            document.removeEventListener('visibilitychange', onVisibilityChange);\n        };\n    }, []);\n    return isBackgrounded;\n};\n\nconst usePlayer = () => {\n    var _a;\n    const [playing, setPlaying, imperativePlaying] = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.usePlayingState();\n    const [hasPlayed, setHasPlayed] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const frame = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.useTimelinePosition();\n    const playStart = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(frame);\n    const setFrame = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.useTimelineSetFrame();\n    const setTimelinePosition = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.useTimelineSetFrame();\n    const audioContext = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.SharedAudioContext);\n    const { audioAndVideoTags } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.TimelineContext);\n    const frameRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();\n    frameRef.current = frame;\n    const video = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useVideo();\n    const config = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useUnsafeVideoConfig();\n    const emitter = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(PlayerEventEmitterContext);\n    const lastFrame = ((_a = config === null || config === void 0 ? void 0 : config.durationInFrames) !== null && _a !== void 0 ? _a : 1) - 1;\n    const isLastFrame = frame === lastFrame;\n    const isFirstFrame = frame === 0;\n    if (!emitter) {\n        throw new TypeError('Expected Player event emitter context');\n    }\n    const seek = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((newFrame) => {\n        if (video === null || video === void 0 ? void 0 : video.id) {\n            setTimelinePosition((c) => ({ ...c, [video.id]: newFrame }));\n        }\n        emitter.dispatchSeek(newFrame);\n    }, [emitter, setTimelinePosition, video === null || video === void 0 ? void 0 : video.id]);\n    const play = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        if (imperativePlaying.current) {\n            return;\n        }\n        setHasPlayed(true);\n        if (isLastFrame) {\n            seek(0);\n        }\n        /**\n         * Play silent audio tags to warm them up for autoplay\n         */\n        if (audioContext && audioContext.numberOfAudioTags > 0 && e) {\n            audioContext.playAllAudios();\n        }\n        /**\n         * Play audios and videos directly here so they can benefit from\n         * being triggered by a click\n         */\n        audioAndVideoTags.current.forEach((a) => a.play());\n        imperativePlaying.current = true;\n        setPlaying(true);\n        playStart.current = frameRef.current;\n        emitter.dispatchPlay();\n    }, [\n        imperativePlaying,\n        isLastFrame,\n        audioContext,\n        setPlaying,\n        emitter,\n        seek,\n        audioAndVideoTags,\n    ]);\n    const pause = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (imperativePlaying.current) {\n            imperativePlaying.current = false;\n            setPlaying(false);\n            emitter.dispatchPause();\n        }\n    }, [emitter, imperativePlaying, setPlaying]);\n    const pauseAndReturnToPlayStart = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (imperativePlaying.current) {\n            imperativePlaying.current = false;\n            if (config) {\n                setTimelinePosition((c) => ({\n                    ...c,\n                    [config.id]: playStart.current,\n                }));\n                setPlaying(false);\n                emitter.dispatchPause();\n            }\n        }\n    }, [config, emitter, imperativePlaying, setPlaying, setTimelinePosition]);\n    const videoId = video === null || video === void 0 ? void 0 : video.id;\n    const frameBack = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((frames) => {\n        if (!videoId) {\n            return null;\n        }\n        if (imperativePlaying.current) {\n            return;\n        }\n        setFrame((c) => {\n            var _a, _b;\n            const prev = (_b = (_a = c[videoId]) !== null && _a !== void 0 ? _a : window.remotion_initialFrame) !== null && _b !== void 0 ? _b : 0;\n            return {\n                ...c,\n                [videoId]: Math.max(0, prev - frames),\n            };\n        });\n    }, [imperativePlaying, setFrame, videoId]);\n    const frameForward = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((frames) => {\n        if (!videoId) {\n            return null;\n        }\n        if (imperativePlaying.current) {\n            return;\n        }\n        setFrame((c) => {\n            var _a, _b;\n            const prev = (_b = (_a = c[videoId]) !== null && _a !== void 0 ? _a : window.remotion_initialFrame) !== null && _b !== void 0 ? _b : 0;\n            return {\n                ...c,\n                [videoId]: Math.min(lastFrame, prev + frames),\n            };\n        });\n    }, [videoId, imperativePlaying, lastFrame, setFrame]);\n    const returnValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            frameBack,\n            frameForward,\n            isLastFrame,\n            emitter,\n            playing,\n            play,\n            pause,\n            seek,\n            isFirstFrame,\n            getCurrentFrame: () => frameRef.current,\n            isPlaying: () => imperativePlaying.current,\n            pauseAndReturnToPlayStart,\n            hasPlayed,\n        };\n    }, [\n        frameBack,\n        frameForward,\n        isLastFrame,\n        emitter,\n        playing,\n        play,\n        pause,\n        seek,\n        isFirstFrame,\n        pauseAndReturnToPlayStart,\n        imperativePlaying,\n        hasPlayed,\n    ]);\n    return returnValue;\n};\n\n/* eslint-disable @typescript-eslint/no-use-before-define */\nconst usePlayback = ({ loop, playbackRate, moveToBeginningWhenEnded, inFrame, outFrame, }) => {\n    const config = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useUnsafeVideoConfig();\n    const frame = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.useTimelinePosition();\n    const { playing, pause, emitter } = usePlayer();\n    const setFrame = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.useTimelineSetFrame();\n    // requestAnimationFrame() does not work if the tab is not active.\n    // This means that audio will keep playing even if it has ended.\n    // In that case, we use setTimeout() instead.\n    const isBackgroundedRef = useIsBackgrounded();\n    const frameRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(frame);\n    frameRef.current = frame;\n    const lastTimeUpdateEvent = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (!config) {\n            return;\n        }\n        if (!playing) {\n            return;\n        }\n        let hasBeenStopped = false;\n        let reqAnimFrameCall = null;\n        const startedTime = performance.now();\n        let framesAdvanced = 0;\n        const cancelQueuedFrame = () => {\n            if (reqAnimFrameCall !== null) {\n                if (reqAnimFrameCall.type === 'raf') {\n                    cancelAnimationFrame(reqAnimFrameCall.id);\n                }\n                else {\n                    clearTimeout(reqAnimFrameCall.id);\n                }\n            }\n        };\n        const stop = () => {\n            hasBeenStopped = true;\n            cancelQueuedFrame();\n        };\n        const callback = () => {\n            const time = performance.now() - startedTime;\n            const actualLastFrame = outFrame !== null && outFrame !== void 0 ? outFrame : config.durationInFrames - 1;\n            const actualFirstFrame = inFrame !== null && inFrame !== void 0 ? inFrame : 0;\n            const { nextFrame, framesToAdvance, hasEnded } = calculateNextFrame({\n                time,\n                currentFrame: frameRef.current,\n                playbackSpeed: playbackRate,\n                fps: config.fps,\n                actualFirstFrame,\n                actualLastFrame,\n                framesAdvanced,\n                shouldLoop: loop,\n            });\n            framesAdvanced += framesToAdvance;\n            if (nextFrame !== frameRef.current &&\n                (!hasEnded || moveToBeginningWhenEnded)) {\n                setFrame((c) => ({ ...c, [config.id]: nextFrame }));\n            }\n            if (hasEnded) {\n                stop();\n                pause();\n                emitter.dispatchEnded();\n                return;\n            }\n            if (!hasBeenStopped) {\n                queueNextFrame();\n            }\n        };\n        const queueNextFrame = () => {\n            if (isBackgroundedRef.current) {\n                reqAnimFrameCall = {\n                    type: 'timeout',\n                    // Note: Most likely, this will not be 1000 / fps, but the browser will throttle it to ~1/sec.\n                    id: setTimeout(callback, 1000 / config.fps),\n                };\n            }\n            else {\n                reqAnimFrameCall = { type: 'raf', id: requestAnimationFrame(callback) };\n            }\n        };\n        queueNextFrame();\n        const onVisibilityChange = () => {\n            if (document.visibilityState === 'visible') {\n                return;\n            }\n            // If tab goes into the background, cancel requestAnimationFrame() and update immediately.\n            // , so the transition to setTimeout() can be fulfilled.\n            cancelQueuedFrame();\n            callback();\n        };\n        window.addEventListener('visibilitychange', onVisibilityChange);\n        return () => {\n            window.removeEventListener('visibilitychange', onVisibilityChange);\n            stop();\n        };\n    }, [\n        config,\n        loop,\n        pause,\n        playing,\n        setFrame,\n        emitter,\n        playbackRate,\n        inFrame,\n        outFrame,\n        moveToBeginningWhenEnded,\n        isBackgroundedRef,\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        const interval = setInterval(() => {\n            if (lastTimeUpdateEvent.current === frameRef.current) {\n                return;\n            }\n            emitter.dispatchTimeUpdate({ frame: frameRef.current });\n            lastTimeUpdateEvent.current = frameRef.current;\n        }, 250);\n        return () => clearInterval(interval);\n    }, [emitter]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        emitter.dispatchFrameUpdate({ frame });\n    }, [emitter, frame]);\n};\n\nlet elementSizeHooks = [];\nconst updateAllElementsSizes = () => {\n    for (const listener of elementSizeHooks) {\n        listener();\n    }\n};\nconst useElementSize = (ref, options) => {\n    const [size, setSize] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => {\n        if (!ref.current) {\n            return null;\n        }\n        const rect = ref.current.getClientRects();\n        if (!rect[0]) {\n            return null;\n        }\n        return {\n            width: rect[0].width,\n            height: rect[0].height,\n            left: rect[0].x,\n            top: rect[0].y,\n            windowSize: {\n                height: window.innerHeight,\n                width: window.innerWidth,\n            },\n        };\n    });\n    const observer = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        if (typeof ResizeObserver === 'undefined') {\n            return null;\n        }\n        return new ResizeObserver((entries) => {\n            // The contentRect returns the width without any `scale()`'s being applied. The height is wrong\n            const { contentRect, target } = entries[0];\n            // The clientRect returns the size with `scale()` being applied.\n            const newSize = target.getClientRects();\n            if (!(newSize === null || newSize === void 0 ? void 0 : newSize[0])) {\n                setSize(null);\n                return;\n            }\n            const probableCssParentScale = contentRect.width === 0 ? 1 : newSize[0].width / contentRect.width;\n            const width = options.shouldApplyCssTransforms\n                ? newSize[0].width\n                : newSize[0].width * (1 / probableCssParentScale);\n            const height = options.shouldApplyCssTransforms\n                ? newSize[0].height\n                : newSize[0].height * (1 / probableCssParentScale);\n            setSize({\n                width,\n                height,\n                left: newSize[0].x,\n                top: newSize[0].y,\n                windowSize: {\n                    height: window.innerHeight,\n                    width: window.innerWidth,\n                },\n            });\n        });\n    }, [options.shouldApplyCssTransforms]);\n    const updateSize = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (!ref.current) {\n            return;\n        }\n        const rect = ref.current.getClientRects();\n        if (!rect[0]) {\n            setSize(null);\n            return;\n        }\n        setSize((prevState) => {\n            const isSame = prevState &&\n                prevState.width === rect[0].width &&\n                prevState.height === rect[0].height &&\n                prevState.left === rect[0].x &&\n                prevState.top === rect[0].y &&\n                prevState.windowSize.height === window.innerHeight &&\n                prevState.windowSize.width === window.innerWidth;\n            if (isSame) {\n                return prevState;\n            }\n            return {\n                width: rect[0].width,\n                height: rect[0].height,\n                left: rect[0].x,\n                top: rect[0].y,\n                windowSize: {\n                    height: window.innerHeight,\n                    width: window.innerWidth,\n                },\n            };\n        });\n    }, [ref]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (!observer) {\n            return;\n        }\n        const { current } = ref;\n        if (ref.current) {\n            observer.observe(ref.current);\n        }\n        return () => {\n            if (current) {\n                observer.unobserve(current);\n            }\n        };\n    }, [observer, ref, updateSize]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (!options.triggerOnWindowResize) {\n            return;\n        }\n        window.addEventListener('resize', updateSize);\n        return () => {\n            window.removeEventListener('resize', updateSize);\n        };\n    }, [options.triggerOnWindowResize, updateSize]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        elementSizeHooks.push(updateSize);\n        return () => {\n            elementSizeHooks = elementSizeHooks.filter((e) => e !== updateSize);\n        };\n    }, [updateSize]);\n    return (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        if (!size) {\n            return null;\n        }\n        return { ...size, refresh: updateSize };\n    }, [size, updateSize]);\n};\n\nconst PLAYER_CSS_CLASSNAME = '__remotion-player';\n\nconst errorStyle = {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flex: 1,\n    height: '100%',\n    width: '100%',\n};\nclass ErrorBoundary extends react__WEBPACK_IMPORTED_MODULE_0__.Component {\n    constructor() {\n        super(...arguments);\n        this.state = { hasError: null };\n    }\n    static getDerivedStateFromError(error) {\n        // Update state so the next render will show the fallback UI.\n        return { hasError: error };\n    }\n    componentDidCatch(error) {\n        this.props.onError(error);\n    }\n    render() {\n        if (this.state.hasError) {\n            // You can render any custom fallback UI\n            return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: errorStyle, children: this.props.errorFallback({\n                    error: this.state.hasError,\n                }) }));\n        }\n        return this.props.children;\n    }\n}\n\nconst formatTime = (timeInSeconds) => {\n    const minutes = Math.floor(timeInSeconds / 60);\n    const seconds = Math.floor(timeInSeconds - minutes * 60);\n    return `${String(minutes)}:${String(seconds).padStart(2, '0')}`;\n};\n\nconst ICON_SIZE = 25;\nconst fullscreenIconSize = 16;\nconst PlayIcon = () => {\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"svg\", { width: ICON_SIZE, height: ICON_SIZE, viewBox: \"0 0 25 25\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { d: \"M8 6.375C7.40904 8.17576 7.06921 10.2486 7.01438 12.3871C6.95955 14.5255 7.19163 16.6547 7.6875 18.5625C9.95364 18.2995 12.116 17.6164 14.009 16.5655C15.902 15.5147 17.4755 14.124 18.6088 12.5C17.5158 10.8949 15.9949 9.51103 14.1585 8.45082C12.3222 7.3906 10.2174 6.68116 8 6.375Z\", fill: \"white\", stroke: \"white\", strokeWidth: \"6.25\", strokeLinejoin: \"round\" }) }));\n};\nconst PauseIcon = () => {\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"svg\", { viewBox: \"0 0 100 100\", width: ICON_SIZE, height: ICON_SIZE, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"rect\", { x: \"25\", y: \"20\", width: \"20\", height: \"60\", fill: \"#fff\", ry: \"5\", rx: \"5\" }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"rect\", { x: \"55\", y: \"20\", width: \"20\", height: \"60\", fill: \"#fff\", ry: \"5\", rx: \"5\" })] }));\n};\nconst FullscreenIcon = ({ isFullscreen, }) => {\n    const strokeWidth = 6;\n    const viewSize = 32;\n    const out = isFullscreen ? 0 : strokeWidth / 2;\n    const middleInset = isFullscreen ? strokeWidth * 1.6 : strokeWidth / 2;\n    const inset = isFullscreen ? strokeWidth * 1.6 : strokeWidth * 2;\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"svg\", { viewBox: `0 0 ${viewSize} ${viewSize}`, height: fullscreenIconSize, width: fullscreenIconSize, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { d: `\n\t\t\t\tM ${out} ${inset}\n\t\t\t\tL ${middleInset} ${middleInset}\n\t\t\t\tL ${inset} ${out}\n\t\t\t\t`, stroke: \"#fff\", strokeWidth: strokeWidth, fill: \"none\" }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { d: `\n\t\t\t\tM ${viewSize - out} ${inset}\n\t\t\t\tL ${viewSize - middleInset} ${middleInset}\n\t\t\t\tL ${viewSize - inset} ${out}\n\t\t\t\t`, stroke: \"#fff\", strokeWidth: strokeWidth, fill: \"none\" }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { d: `\n\t\t\t\tM ${out} ${viewSize - inset}\n\t\t\t\tL ${middleInset} ${viewSize - middleInset}\n\t\t\t\tL ${inset} ${viewSize - out}\n\t\t\t\t`, stroke: \"#fff\", strokeWidth: strokeWidth, fill: \"none\" }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { d: `\n\t\t\t\tM ${viewSize - out} ${viewSize - inset}\n\t\t\t\tL ${viewSize - middleInset} ${viewSize - middleInset}\n\t\t\t\tL ${viewSize - inset} ${viewSize - out}\n\t\t\t\t`, stroke: \"#fff\", strokeWidth: strokeWidth, fill: \"none\" })] }));\n};\nconst VolumeOffIcon = () => {\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"svg\", { width: ICON_SIZE, height: ICON_SIZE, viewBox: \"0 0 24 24\", children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { d: \"M3.63 3.63a.996.996 0 000 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34a.996.996 0 101.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12A4.5 4.5 0 0014 7.97v1.79l2.48 2.48c.01-.08.02-.16.02-.24z\", fill: \"#fff\" }) }));\n};\nconst VolumeOnIcon = () => {\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"svg\", { width: ICON_SIZE, height: ICON_SIZE, viewBox: \"0 0 24 24\", children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { d: \"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2A4.5 4.5 0 0014 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z\", fill: \"#fff\" }) }));\n};\n\nconst BAR_HEIGHT$1 = 5;\nconst KNOB_SIZE$1 = 12;\nconst VOLUME_SLIDER_WIDTH = 100;\nconst MediaVolumeSlider = ({ displayVerticalVolumeSlider }) => {\n    const [mediaMuted, setMediaMuted] = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useMediaMutedState();\n    const [mediaVolume, setMediaVolume] = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useMediaVolumeState();\n    const [focused, setFocused] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const parentDivRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const inputRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const hover = useHoverState(parentDivRef);\n    // Need to import it from React to fix React 17 ESM support.\n    const randomId = \n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    typeof react__WEBPACK_IMPORTED_MODULE_0__.useId === 'undefined' ? 'volume-slider' : react__WEBPACK_IMPORTED_MODULE_0__.useId();\n    const [randomClass] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => `__remotion-volume-slider-${(0,remotion__WEBPACK_IMPORTED_MODULE_1__.random)(randomId)}`.replace('.', ''));\n    const isMutedOrZero = mediaMuted || mediaVolume === 0;\n    const onVolumeChange = (e) => {\n        setMediaVolume(parseFloat(e.target.value));\n    };\n    const onBlur = () => {\n        setTimeout(() => {\n            // We need a small delay to check which element was focused next,\n            // and if it wasn't the volume slider, we hide it\n            if (document.activeElement !== inputRef.current) {\n                setFocused(false);\n            }\n        }, 10);\n    };\n    const onClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (mediaVolume === 0) {\n            setMediaVolume(1);\n            setMediaMuted(false);\n            return;\n        }\n        setMediaMuted((mute) => !mute);\n    }, [mediaVolume, setMediaMuted, setMediaVolume]);\n    const parentDivStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            display: 'inline-flex',\n            background: 'none',\n            border: 'none',\n            justifyContent: 'center',\n            alignItems: 'center',\n            touchAction: 'none',\n            ...(displayVerticalVolumeSlider && { position: 'relative' }),\n        };\n    }, [displayVerticalVolumeSlider]);\n    const volumeContainer = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            display: 'inline',\n            width: ICON_SIZE,\n            height: ICON_SIZE,\n            cursor: 'pointer',\n            appearance: 'none',\n            background: 'none',\n            border: 'none',\n            padding: 0,\n        };\n    }, []);\n    const inputStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        const commonStyle = {\n            WebkitAppearance: 'none',\n            backgroundColor: 'rgba(255, 255, 255, 0.5)',\n            borderRadius: BAR_HEIGHT$1 / 2,\n            cursor: 'pointer',\n            height: BAR_HEIGHT$1,\n            width: VOLUME_SLIDER_WIDTH,\n            backgroundImage: `linear-gradient(\n\t\t\t\tto right,\n\t\t\t\twhite ${mediaVolume * 100}%, rgba(255, 255, 255, 0) ${mediaVolume * 100}%\n\t\t\t)`,\n        };\n        if (displayVerticalVolumeSlider) {\n            return {\n                ...commonStyle,\n                transform: `rotate(-90deg)`,\n                position: 'absolute',\n                bottom: ICON_SIZE + VOLUME_SLIDER_WIDTH / 2 + 5,\n            };\n        }\n        return {\n            ...commonStyle,\n            marginLeft: 5,\n        };\n    }, [displayVerticalVolumeSlider, mediaVolume]);\n    const sliderStyle = `\n\t.${randomClass}::-webkit-slider-thumb {\n\t\t-webkit-appearance: none;\n\t\tbackground-color: white;\n\t\tborder-radius: ${KNOB_SIZE$1 / 2}px;\n\t\tbox-shadow: 0 0 2px black;\n\t\theight: ${KNOB_SIZE$1}px;\n\t\twidth: ${KNOB_SIZE$1}px;\n\t}\n\n\t.${randomClass}::-moz-range-thumb {\n\t\t-webkit-appearance: none;\n\t\tbackground-color: white;\n\t\tborder-radius: ${KNOB_SIZE$1 / 2}px;\n\t\tbox-shadow: 0 0 2px black;\n\t\theight: ${KNOB_SIZE$1}px;\n\t\twidth: ${KNOB_SIZE$1}px;\n\t}\n`;\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { ref: parentDivRef, style: parentDivStyle, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"style\", { \n                // eslint-disable-next-line react/no-danger\n                dangerouslySetInnerHTML: {\n                    __html: sliderStyle,\n                } }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"button\", { \"aria-label\": isMutedOrZero ? 'Unmute sound' : 'Mute sound', title: isMutedOrZero ? 'Unmute sound' : 'Mute sound', onClick: onClick, onBlur: onBlur, onFocus: () => setFocused(true), style: volumeContainer, type: \"button\", children: isMutedOrZero ? (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(VolumeOffIcon, {}) : (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(VolumeOnIcon, {}) }), (focused || hover) && !mediaMuted && !remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.isIosSafari() ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"input\", { ref: inputRef, \"aria-label\": \"Change volume\", className: randomClass, max: 1, min: 0, onBlur: () => setFocused(false), onChange: onVolumeChange, step: 0.01, type: \"range\", value: mediaVolume, style: inputStyle })) : null] }));\n};\n\n// hook to hide a popup/modal when clicked outside\nfunction useComponentVisible(initialIsVisible) {\n    const [isComponentVisible, setIsComponentVisible] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialIsVisible);\n    const ref = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        const handleClickOutside = (event) => {\n            if (ref.current && !ref.current.contains(event.target)) {\n                setIsComponentVisible(false);\n            }\n        };\n        document.addEventListener('pointerup', handleClickOutside, true);\n        return () => {\n            document.removeEventListener('pointerup', handleClickOutside, true);\n        };\n    }, []);\n    return { ref, isComponentVisible, setIsComponentVisible };\n}\n\n// To align\nconst BOTTOM = 35;\n// Arbitrary to clamp the height of the popup\nconst THRESHOLD = 70;\nconst rateDiv = {\n    height: 30,\n    paddingRight: 15,\n    paddingLeft: 12,\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n};\nconst checkmarkContainer = {\n    width: 22,\n    display: 'flex',\n    alignItems: 'center',\n};\nconst checkmarkStyle = {\n    width: 14,\n    height: 14,\n    color: 'black',\n};\nconst Checkmark = () => ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"svg\", { viewBox: \"0 0 512 512\", style: checkmarkStyle, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"path\", { fill: \"currentColor\", d: \"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z\" }) }));\nconst PlaybackrateOption = ({ rate, onSelect, selectedRate, keyboardSelectedRate }) => {\n    const onClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        onSelect(rate);\n    }, [onSelect, rate]);\n    const [hovered, setHovered] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const onMouseEnter = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        setHovered(true);\n    }, []);\n    const onMouseLeave = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        setHovered(false);\n    }, []);\n    const actualStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            ...rateDiv,\n            backgroundColor: hovered || keyboardSelectedRate === rate ? '#eee' : 'transparent',\n        };\n    }, [hovered, keyboardSelectedRate, rate]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { onMouseEnter: onMouseEnter, onMouseLeave: onMouseLeave, tabIndex: 0, style: actualStyle, onClick: onClick, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: checkmarkContainer, children: rate === selectedRate ? (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(Checkmark, {}) : null }), rate.toFixed(1), \"x\"] }, rate));\n};\nconst PlaybackPopup = ({ setIsComponentVisible, playbackRates, canvasSize }) => {\n    const { setPlaybackRate, playbackRate } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.TimelineContext);\n    const [keyboardSelectedRate, setKeyboardSelectedRate] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(playbackRate);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        const listener = (e) => {\n            e.preventDefault();\n            if (e.key === 'ArrowUp') {\n                const currentIndex = playbackRates.findIndex((rate) => rate === keyboardSelectedRate);\n                if (currentIndex === 0) {\n                    return;\n                }\n                if (currentIndex === -1) {\n                    setKeyboardSelectedRate(playbackRates[0]);\n                }\n                else {\n                    setKeyboardSelectedRate(playbackRates[currentIndex - 1]);\n                }\n            }\n            else if (e.key === 'ArrowDown') {\n                const currentIndex = playbackRates.findIndex((rate) => rate === keyboardSelectedRate);\n                if (currentIndex === playbackRates.length - 1) {\n                    return;\n                }\n                if (currentIndex === -1) {\n                    setKeyboardSelectedRate(playbackRates[playbackRates.length - 1]);\n                }\n                else {\n                    setKeyboardSelectedRate(playbackRates[currentIndex + 1]);\n                }\n            }\n            else if (e.key === 'Enter') {\n                setPlaybackRate(keyboardSelectedRate);\n                setIsComponentVisible(false);\n            }\n        };\n        window.addEventListener('keydown', listener);\n        return () => {\n            window.removeEventListener('keydown', listener);\n        };\n    }, [\n        playbackRates,\n        keyboardSelectedRate,\n        setPlaybackRate,\n        setIsComponentVisible,\n    ]);\n    const onSelect = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((rate) => {\n        setPlaybackRate(rate);\n        setIsComponentVisible(false);\n    }, [setIsComponentVisible, setPlaybackRate]);\n    const playbackPopup = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            position: 'absolute',\n            right: 0,\n            width: 125,\n            maxHeight: canvasSize.height - THRESHOLD - BOTTOM,\n            bottom: 35,\n            background: '#fff',\n            borderRadius: 4,\n            overflow: 'auto',\n            color: 'black',\n            textAlign: 'left',\n        };\n    }, [canvasSize.height]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: playbackPopup, children: playbackRates.map((rate) => {\n            return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlaybackrateOption, { selectedRate: playbackRate, onSelect: onSelect, rate: rate, keyboardSelectedRate: keyboardSelectedRate }, rate));\n        }) }));\n};\nconst label = {\n    fontSize: 13,\n    fontWeight: 'bold',\n    color: 'white',\n    border: '2px solid white',\n    borderRadius: 20,\n    paddingLeft: 8,\n    paddingRight: 8,\n    paddingTop: 2,\n    paddingBottom: 2,\n};\nconst playerButtonStyle = {\n    appearance: 'none',\n    backgroundColor: 'transparent',\n    border: 'none',\n    cursor: 'pointer',\n    paddingLeft: 0,\n    paddingRight: 0,\n    paddingTop: 6,\n    paddingBottom: 6,\n    height: 37,\n    display: 'inline-flex',\n    marginBottom: 0,\n    marginTop: 0,\n    alignItems: 'center',\n};\nconst button = {\n    ...playerButtonStyle,\n    position: 'relative',\n};\nconst PlaybackrateControl = ({ playbackRates, canvasSize }) => {\n    const { ref, isComponentVisible, setIsComponentVisible } = useComponentVisible(false);\n    const { playbackRate } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.TimelineContext);\n    const onClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        setIsComponentVisible(!isComponentVisible);\n    }, [isComponentVisible, setIsComponentVisible]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { ref: ref, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"button\", { type: \"button\", \"aria-label\": \"Change playback rate\", style: button, onClick: onClick, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { style: label, children: [playbackRate, \"x\"] }), isComponentVisible && ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlaybackPopup, { canvasSize: canvasSize, playbackRates: playbackRates, setIsComponentVisible: setIsComponentVisible }))] }) }));\n};\n\nconst getFrameFromX = (clientX, durationInFrames, width) => {\n    var _a;\n    const pos = clientX;\n    const frame = Math.round((0,remotion__WEBPACK_IMPORTED_MODULE_1__.interpolate)(pos, [0, width], [0, (_a = durationInFrames - 1) !== null && _a !== void 0 ? _a : 0], {\n        extrapolateLeft: 'clamp',\n        extrapolateRight: 'clamp',\n    }));\n    return frame;\n};\nconst BAR_HEIGHT = 5;\nconst KNOB_SIZE = 12;\nconst VERTICAL_PADDING = 4;\nconst containerStyle$1 = {\n    userSelect: 'none',\n    paddingTop: VERTICAL_PADDING,\n    paddingBottom: VERTICAL_PADDING,\n    boxSizing: 'border-box',\n    cursor: 'pointer',\n    position: 'relative',\n    touchAction: 'none',\n};\nconst barBackground = {\n    height: BAR_HEIGHT,\n    backgroundColor: 'rgba(255, 255, 255, 0.25)',\n    width: '100%',\n    borderRadius: BAR_HEIGHT / 2,\n};\nconst findBodyInWhichDivIsLocated = (div) => {\n    let current = div;\n    while (current.parentElement) {\n        current = current.parentElement;\n    }\n    return current;\n};\nconst PlayerSeekBar = ({ durationInFrames, onSeekEnd, onSeekStart, inFrame, outFrame }) => {\n    const containerRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const barHovered = useHoverState(containerRef);\n    const size = useElementSize(containerRef, {\n        triggerOnWindowResize: true,\n        shouldApplyCssTransforms: true,\n    });\n    const { seek, play, pause, playing } = usePlayer();\n    const frame = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.useTimelinePosition();\n    const [dragging, setDragging] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({\n        dragging: false,\n    });\n    const onPointerDown = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        if (!size) {\n            throw new Error('Player has no size');\n        }\n        const _frame = getFrameFromX(e.clientX - size.left, durationInFrames, size.width);\n        pause();\n        seek(_frame);\n        setDragging({\n            dragging: true,\n            wasPlaying: playing,\n        });\n        onSeekStart();\n    }, [size, durationInFrames, pause, seek, playing, onSeekStart]);\n    const onPointerMove = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        var _a;\n        if (!size) {\n            throw new Error('Player has no size');\n        }\n        if (!dragging.dragging) {\n            return;\n        }\n        const _frame = getFrameFromX(e.clientX - ((_a = size === null || size === void 0 ? void 0 : size.left) !== null && _a !== void 0 ? _a : 0), durationInFrames, size.width);\n        seek(_frame);\n    }, [dragging.dragging, durationInFrames, seek, size]);\n    const onPointerUp = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        setDragging({\n            dragging: false,\n        });\n        if (!dragging.dragging) {\n            return;\n        }\n        if (dragging.wasPlaying) {\n            play();\n        }\n        else {\n            pause();\n        }\n        onSeekEnd();\n    }, [dragging, onSeekEnd, pause, play]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (!dragging.dragging) {\n            return;\n        }\n        const body = findBodyInWhichDivIsLocated(containerRef.current);\n        body.addEventListener('pointermove', onPointerMove);\n        body.addEventListener('pointerup', onPointerUp);\n        return () => {\n            body.removeEventListener('pointermove', onPointerMove);\n            body.removeEventListener('pointerup', onPointerUp);\n        };\n    }, [dragging.dragging, onPointerMove, onPointerUp]);\n    const knobStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        var _a;\n        return {\n            height: KNOB_SIZE,\n            width: KNOB_SIZE,\n            borderRadius: KNOB_SIZE / 2,\n            position: 'absolute',\n            top: VERTICAL_PADDING - KNOB_SIZE / 2 + 5 / 2,\n            backgroundColor: 'white',\n            left: Math.max(0, (frame / Math.max(1, durationInFrames - 1)) * ((_a = size === null || size === void 0 ? void 0 : size.width) !== null && _a !== void 0 ? _a : 0) -\n                KNOB_SIZE / 2),\n            boxShadow: '0 0 2px black',\n            opacity: Number(barHovered),\n        };\n    }, [barHovered, durationInFrames, frame, size]);\n    const fillStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            height: BAR_HEIGHT,\n            backgroundColor: 'rgba(255, 255, 255, 1)',\n            width: ((frame - (inFrame !== null && inFrame !== void 0 ? inFrame : 0)) / (durationInFrames - 1)) * 100 + '%',\n            marginLeft: ((inFrame !== null && inFrame !== void 0 ? inFrame : 0) / (durationInFrames - 1)) * 100 + '%',\n            borderRadius: BAR_HEIGHT / 2,\n        };\n    }, [durationInFrames, frame, inFrame]);\n    const active = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            height: BAR_HEIGHT,\n            backgroundColor: 'rgba(255, 255, 255, 0.25)',\n            width: (((outFrame !== null && outFrame !== void 0 ? outFrame : durationInFrames - 1) - (inFrame !== null && inFrame !== void 0 ? inFrame : 0)) /\n                (durationInFrames - 1)) *\n                100 +\n                '%',\n            marginLeft: ((inFrame !== null && inFrame !== void 0 ? inFrame : 0) / (durationInFrames - 1)) * 100 + '%',\n            borderRadius: BAR_HEIGHT / 2,\n            position: 'absolute',\n        };\n    }, [durationInFrames, inFrame, outFrame]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { ref: containerRef, onPointerDown: onPointerDown, style: containerStyle$1, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { style: barBackground, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: active }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: fillStyle })] }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: knobStyle })] }));\n};\n\nconst X_SPACER = 10;\nconst X_PADDING = 12;\nconst useVideoControlsResize = ({ allowFullscreen: allowFullScreen, playerWidth, }) => {\n    const resizeInfo = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        const playPauseIconSize = ICON_SIZE;\n        const volumeIconSize = ICON_SIZE;\n        const _fullscreenIconSize = allowFullScreen ? fullscreenIconSize : 0;\n        const elementsSize = volumeIconSize +\n            playPauseIconSize +\n            _fullscreenIconSize +\n            X_PADDING * 2 +\n            X_SPACER * 2;\n        const maxTimeLabelWidth = playerWidth - elementsSize;\n        const maxTimeLabelWidthWithoutNegativeValue = Math.max(maxTimeLabelWidth, 0);\n        const availableTimeLabelWidthIfVolumeOpen = maxTimeLabelWidthWithoutNegativeValue - VOLUME_SLIDER_WIDTH;\n        // If max label width is lower than the volume width\n        // then it means we need to take it's width as the max label width\n        // otherwise we took the available width when volume open\n        const computedLabelWidth = availableTimeLabelWidthIfVolumeOpen < VOLUME_SLIDER_WIDTH\n            ? maxTimeLabelWidthWithoutNegativeValue\n            : availableTimeLabelWidthIfVolumeOpen;\n        const minWidthForHorizontalDisplay = computedLabelWidth + elementsSize + VOLUME_SLIDER_WIDTH;\n        const displayVerticalVolumeSlider = playerWidth < minWidthForHorizontalDisplay;\n        return {\n            maxTimeLabelWidth: maxTimeLabelWidthWithoutNegativeValue === 0\n                ? null\n                : maxTimeLabelWidthWithoutNegativeValue,\n            displayVerticalVolumeSlider,\n        };\n    }, [allowFullScreen, playerWidth]);\n    return resizeInfo;\n};\n\nconst gradientSteps = [\n    0, 0.013, 0.049, 0.104, 0.175, 0.259, 0.352, 0.45, 0.55, 0.648, 0.741, 0.825,\n    0.896, 0.951, 0.987,\n];\nconst gradientOpacities = [\n    0, 8.1, 15.5, 22.5, 29, 35.3, 41.2, 47.1, 52.9, 58.8, 64.7, 71, 77.5, 84.5,\n    91.9,\n];\nconst globalGradientOpacity = 1 / 0.7;\nconst containerStyle = {\n    boxSizing: 'border-box',\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    paddingTop: 40,\n    paddingBottom: 10,\n    backgroundImage: `linear-gradient(to bottom,${gradientSteps\n        .map((g, i) => {\n        return `hsla(0, 0%, 0%, ${g}) ${gradientOpacities[i] * globalGradientOpacity}%`;\n    })\n        .join(', ')}, hsl(0, 0%, 0%) 100%)`,\n    backgroundSize: 'auto 145px',\n    display: 'flex',\n    paddingRight: X_PADDING,\n    paddingLeft: X_PADDING,\n    flexDirection: 'column',\n    transition: 'opacity 0.3s',\n};\nconst controlsRow = {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n    alignItems: 'center',\n    justifyContent: 'center',\n    userSelect: 'none',\n};\nconst leftPartStyle = {\n    display: 'flex',\n    flexDirection: 'row',\n    userSelect: 'none',\n    alignItems: 'center',\n};\nconst xSpacer = {\n    width: 12,\n};\nconst ySpacer = {\n    height: 8,\n};\nconst flex1 = {\n    flex: 1,\n};\nconst fullscreen = {};\nconst PlayPauseButton = ({ playing }) => playing ? (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PauseIcon, {}) : (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlayIcon, {});\nconst Controls = ({ durationInFrames, isFullscreen, fps, player, showVolumeControls, onFullscreenButtonClick, allowFullscreen, onExitFullscreenButtonClick, spaceKeyToPlayOrPause, onSeekEnd, onSeekStart, inFrame, outFrame, initiallyShowControls, canvasSize, renderPlayPauseButton, renderFullscreenButton, alwaysShowControls, showPlaybackRateControl, containerRef, }) => {\n    var _a;\n    const playButtonRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const frame = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.useTimelinePosition();\n    const [supportsFullscreen, setSupportsFullscreen] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const hovered = useHoverState(containerRef);\n    const { maxTimeLabelWidth, displayVerticalVolumeSlider } = useVideoControlsResize({\n        allowFullscreen,\n        playerWidth: (_a = canvasSize === null || canvasSize === void 0 ? void 0 : canvasSize.width) !== null && _a !== void 0 ? _a : 0,\n    });\n    const [shouldShowInitially, setInitiallyShowControls] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => {\n        if (typeof initiallyShowControls === 'boolean') {\n            return initiallyShowControls;\n        }\n        if (typeof initiallyShowControls === 'number') {\n            if (initiallyShowControls % 1 !== 0) {\n                throw new Error('initiallyShowControls must be an integer or a boolean');\n            }\n            if (Number.isNaN(initiallyShowControls)) {\n                throw new Error('initiallyShowControls must not be NaN');\n            }\n            if (!Number.isFinite(initiallyShowControls)) {\n                throw new Error('initiallyShowControls must be finite');\n            }\n            if (initiallyShowControls <= 0) {\n                throw new Error('initiallyShowControls must be a positive integer');\n            }\n            return initiallyShowControls;\n        }\n        throw new TypeError('initiallyShowControls must be a number or a boolean');\n    });\n    const containerCss = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        // Hide if playing and mouse outside\n        const shouldShow = hovered || !player.playing || shouldShowInitially || alwaysShowControls;\n        return {\n            ...containerStyle,\n            opacity: Number(shouldShow),\n        };\n    }, [hovered, shouldShowInitially, player.playing, alwaysShowControls]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (playButtonRef.current && spaceKeyToPlayOrPause) {\n            // This switches focus to play button when player.playing flag changes\n            playButtonRef.current.focus({\n                preventScroll: true,\n            });\n        }\n    }, [player.playing, spaceKeyToPlayOrPause]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        var _a;\n        // Must be handled client-side to avoid SSR hydration mismatch\n        setSupportsFullscreen((_a = (typeof document !== 'undefined' &&\n            (document.fullscreenEnabled || document.webkitFullscreenEnabled))) !== null && _a !== void 0 ? _a : false);\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (shouldShowInitially === false) {\n            return;\n        }\n        const time = shouldShowInitially === true ? 2000 : shouldShowInitially;\n        const timeout = setTimeout(() => {\n            setInitiallyShowControls(false);\n        }, time);\n        return () => {\n            clearInterval(timeout);\n        };\n    }, [shouldShowInitially]);\n    const timeLabel = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            color: 'white',\n            fontFamily: 'sans-serif',\n            fontSize: 14,\n            maxWidth: maxTimeLabelWidth === null ? undefined : maxTimeLabelWidth,\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n        };\n    }, [maxTimeLabelWidth]);\n    const playbackRates = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        if (showPlaybackRateControl === true) {\n            return [0.5, 0.8, 1, 1.2, 1.5, 1.8, 2, 2.5, 3];\n        }\n        if (Array.isArray(showPlaybackRateControl)) {\n            for (const rate of showPlaybackRateControl) {\n                if (typeof rate !== 'number') {\n                    throw new Error('Every item in showPlaybackRateControl must be a number');\n                }\n                if (rate <= 0) {\n                    throw new Error('Every item in showPlaybackRateControl must be positive');\n                }\n            }\n            return showPlaybackRateControl;\n        }\n        return null;\n    }, [showPlaybackRateControl]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { style: containerCss, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { style: controlsRow, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { style: leftPartStyle, children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"button\", { ref: playButtonRef, type: \"button\", style: playerButtonStyle, onClick: player.playing ? player.pause : player.play, \"aria-label\": player.playing ? 'Pause video' : 'Play video', title: player.playing ? 'Pause video' : 'Play video', children: renderPlayPauseButton === null ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlayPauseButton, { playing: player.playing })) : (renderPlayPauseButton({ playing: player.playing })) }), showVolumeControls ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment, { children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: xSpacer }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(MediaVolumeSlider, { displayVerticalVolumeSlider: displayVerticalVolumeSlider })] })) : null, (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: xSpacer }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(\"div\", { style: timeLabel, children: [formatTime(frame / fps), \" / \", formatTime(durationInFrames / fps)] }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: xSpacer })] }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: flex1 }), playbackRates && canvasSize && ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlaybackrateControl, { canvasSize: canvasSize, playbackRates: playbackRates })), playbackRates && supportsFullscreen && allowFullscreen ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: xSpacer })) : null, (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: fullscreen, children: supportsFullscreen && allowFullscreen ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"button\", { type: \"button\", \"aria-label\": isFullscreen ? 'Exit fullscreen' : 'Enter Fullscreen', title: isFullscreen ? 'Exit fullscreen' : 'Enter Fullscreen', style: playerButtonStyle, onClick: isFullscreen\n                                ? onExitFullscreenButtonClick\n                                : onFullscreenButtonClick, children: renderFullscreenButton === null ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(FullscreenIcon, { isFullscreen: isFullscreen })) : (renderFullscreenButton({ isFullscreen })) })) : null })] }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: ySpacer }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlayerSeekBar, { onSeekEnd: onSeekEnd, onSeekStart: onSeekStart, durationInFrames: durationInFrames, inFrame: inFrame, outFrame: outFrame })] }));\n};\n\nconst IS_NODE = typeof document === 'undefined';\n\nconst cancellablePromise = (promise) => {\n    let isCanceled = false;\n    const wrappedPromise = new Promise((resolve, reject) => {\n        promise\n            .then((value) => {\n            if (isCanceled) {\n                reject({ isCanceled, value });\n                return;\n            }\n            resolve(value);\n        })\n            .catch((error) => {\n            reject({ isCanceled, error });\n        });\n    });\n    return {\n        promise: wrappedPromise,\n        cancel: () => {\n            isCanceled = true;\n        },\n    };\n};\n\n/* eslint-disable no-promise-executor-return */\nconst delay = (n) => new Promise((resolve) => setTimeout(resolve, n));\n\nconst useCancellablePromises = () => {\n    const pendingPromises = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)([]);\n    const appendPendingPromise = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((promise) => {\n        pendingPromises.current = [...pendingPromises.current, promise];\n    }, []);\n    const removePendingPromise = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((promise) => {\n        pendingPromises.current = pendingPromises.current.filter((p) => p !== promise);\n    }, []);\n    const clearPendingPromises = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => pendingPromises.current.map((p) => p.cancel()), []);\n    const api = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => ({\n        appendPendingPromise,\n        removePendingPromise,\n        clearPendingPromises,\n    }), [appendPendingPromise, clearPendingPromises, removePendingPromise]);\n    return api;\n};\n\nconst useClickPreventionOnDoubleClick = (onClick, onDoubleClick, doubleClickToFullscreen) => {\n    const api = useCancellablePromises();\n    const handleClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(async (e) => {\n        api.clearPendingPromises();\n        const waitForClick = cancellablePromise(delay(200));\n        api.appendPendingPromise(waitForClick);\n        try {\n            await waitForClick.promise;\n            api.removePendingPromise(waitForClick);\n            onClick(e);\n        }\n        catch (errorInfo) {\n            const info = errorInfo;\n            api.removePendingPromise(waitForClick);\n            if (!info.isCanceled) {\n                throw info.error;\n            }\n        }\n    }, [api, onClick]);\n    const handleDoubleClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        api.clearPendingPromises();\n        onDoubleClick();\n    }, [api, onDoubleClick]);\n    const returnValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        if (!doubleClickToFullscreen) {\n            return [onClick, onDoubleClick];\n        }\n        return [handleClick, handleDoubleClick];\n    }, [\n        doubleClickToFullscreen,\n        handleClick,\n        handleDoubleClick,\n        onClick,\n        onDoubleClick,\n    ]);\n    return returnValue;\n};\n\nconst reactVersion$1 = react__WEBPACK_IMPORTED_MODULE_0__.version.split('.')[0];\nif (reactVersion$1 === '0') {\n    throw new Error(`Version ${reactVersion$1} of \"react\" is not supported by Remotion`);\n}\nconst doesReactVersionSupportSuspense$1 = parseInt(reactVersion$1, 10) >= 18;\nconst PlayerUI = ({ controls, style, loop, autoPlay, allowFullscreen, inputProps, clickToPlay, showVolumeControls, doubleClickToFullscreen, spaceKeyToPlayOrPause, errorFallback, playbackRate, renderLoading, renderPoster, className, moveToBeginningWhenEnded, showPosterWhenUnplayed, showPosterWhenEnded, showPosterWhenPaused, inFrame, outFrame, initiallyShowControls, renderFullscreen: renderFullscreenButton, renderPlayPauseButton, alwaysShowControls, showPlaybackRateControl, }, ref) => {\n    var _a, _b, _c;\n    const config = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useUnsafeVideoConfig();\n    const video = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useVideo();\n    const container = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const canvasSize = useElementSize(container, {\n        triggerOnWindowResize: false,\n        shouldApplyCssTransforms: false,\n    });\n    const [hasPausedToResume, setHasPausedToResume] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [shouldAutoplay, setShouldAutoPlay] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(autoPlay);\n    const [isFullscreen, setIsFullscreen] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => false);\n    const [seeking, setSeeking] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    usePlayback({\n        loop,\n        playbackRate,\n        moveToBeginningWhenEnded,\n        inFrame,\n        outFrame,\n    });\n    const player = usePlayer();\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (hasPausedToResume && !player.playing) {\n            setHasPausedToResume(false);\n            player.play();\n        }\n    }, [hasPausedToResume, player]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        const { current } = container;\n        if (!current) {\n            return;\n        }\n        const onFullscreenChange = () => {\n            setIsFullscreen(document.fullscreenElement === current ||\n                document.webkitFullscreenElement === current);\n        };\n        document.addEventListener('fullscreenchange', onFullscreenChange);\n        document.addEventListener('webkitfullscreenchange', onFullscreenChange);\n        return () => {\n            document.removeEventListener('fullscreenchange', onFullscreenChange);\n            document.removeEventListener('webkitfullscreenchange', onFullscreenChange);\n        };\n    }, []);\n    const toggle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        if (player.isPlaying()) {\n            player.pause();\n        }\n        else {\n            player.play(e);\n        }\n    }, [player]);\n    const requestFullscreen = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (!allowFullscreen) {\n            throw new Error('allowFullscreen is false');\n        }\n        const supportsFullScreen = document.fullscreenEnabled || document.webkitFullscreenEnabled;\n        if (!supportsFullScreen) {\n            throw new Error('Browser doesnt support fullscreen');\n        }\n        if (!container.current) {\n            throw new Error('No player ref found');\n        }\n        if (container.current.webkitRequestFullScreen) {\n            container.current.webkitRequestFullScreen();\n        }\n        else {\n            container.current.requestFullscreen();\n        }\n    }, [allowFullscreen]);\n    const exitFullscreen = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (document.webkitExitFullscreen) {\n            document.webkitExitFullscreen();\n        }\n        else {\n            document.exitFullscreen();\n        }\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        const { current } = container;\n        if (!current) {\n            return;\n        }\n        const fullscreenChange = () => {\n            var _a;\n            const element = (_a = document.webkitFullscreenElement) !== null && _a !== void 0 ? _a : document.fullscreenElement;\n            if (element && element === container.current) {\n                player.emitter.dispatchFullscreenChange({\n                    isFullscreen: true,\n                });\n            }\n            else {\n                player.emitter.dispatchFullscreenChange({\n                    isFullscreen: false,\n                });\n            }\n        };\n        current.addEventListener('webkitfullscreenchange', fullscreenChange);\n        current.addEventListener('fullscreenchange', fullscreenChange);\n        return () => {\n            current.removeEventListener('webkitfullscreenchange', fullscreenChange);\n            current.removeEventListener('fullscreenchange', fullscreenChange);\n        };\n    }, [player.emitter]);\n    const durationInFrames = (_a = config === null || config === void 0 ? void 0 : config.durationInFrames) !== null && _a !== void 0 ? _a : 1;\n    const layout = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        if (!config || !canvasSize) {\n            return null;\n        }\n        return calculateCanvasTransformation({\n            canvasSize,\n            compositionHeight: config.height,\n            compositionWidth: config.width,\n            previewSize: 'auto',\n        });\n    }, [canvasSize, config]);\n    const scale = (_b = layout === null || layout === void 0 ? void 0 : layout.scale) !== null && _b !== void 0 ? _b : 1;\n    const initialScaleIgnored = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (!initialScaleIgnored.current) {\n            initialScaleIgnored.current = true;\n            return;\n        }\n        player.emitter.dispatchScaleChange(scale);\n    }, [player.emitter, scale]);\n    const { setMediaVolume, setMediaMuted } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.SetMediaVolumeContext);\n    const { mediaMuted, mediaVolume } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.MediaVolumeContext);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        player.emitter.dispatchVolumeChange(mediaVolume);\n    }, [player.emitter, mediaVolume]);\n    const isMuted = mediaMuted || mediaVolume === 0;\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        player.emitter.dispatchMuteChange({\n            isMuted,\n        });\n    }, [player.emitter, isMuted]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useImperativeHandle)(ref, () => {\n        const methods = {\n            play: player.play,\n            pause: () => {\n                // If, after .seek()-ing, the player was explicitly paused, we don't resume\n                setHasPausedToResume(false);\n                player.pause();\n            },\n            toggle,\n            getContainerNode: () => container.current,\n            getCurrentFrame: player.getCurrentFrame,\n            isPlaying: () => player.playing,\n            seekTo: (f) => {\n                const lastFrame = durationInFrames - 1;\n                const frameToSeekTo = Math.max(0, Math.min(lastFrame, f));\n                // continue playing after seeking if the player was playing before\n                if (player.isPlaying()) {\n                    const pauseToResume = frameToSeekTo !== lastFrame || loop;\n                    setHasPausedToResume(pauseToResume);\n                    player.pause();\n                }\n                if (frameToSeekTo === lastFrame && !loop) {\n                    player.emitter.dispatchEnded();\n                }\n                player.seek(frameToSeekTo);\n            },\n            isFullscreen: () => isFullscreen,\n            requestFullscreen,\n            exitFullscreen,\n            getVolume: () => {\n                if (mediaMuted) {\n                    return 0;\n                }\n                return mediaVolume;\n            },\n            setVolume: (vol) => {\n                if (typeof vol !== 'number') {\n                    throw new TypeError(`setVolume() takes a number, got value of type ${typeof vol}`);\n                }\n                if (isNaN(vol)) {\n                    throw new TypeError(`setVolume() got a number that is NaN. Volume must be between 0 and 1.`);\n                }\n                if (vol < 0 || vol > 1) {\n                    throw new TypeError(`setVolume() got a number that is out of range. Must be between 0 and 1, got ${typeof vol}`);\n                }\n                setMediaVolume(vol);\n            },\n            isMuted: () => isMuted,\n            mute: () => {\n                setMediaMuted(true);\n            },\n            unmute: () => {\n                setMediaMuted(false);\n            },\n            getScale: () => scale,\n        };\n        return Object.assign(player.emitter, methods);\n    }, [\n        durationInFrames,\n        exitFullscreen,\n        isFullscreen,\n        loop,\n        mediaMuted,\n        isMuted,\n        mediaVolume,\n        player,\n        requestFullscreen,\n        setMediaMuted,\n        setMediaVolume,\n        toggle,\n        scale,\n    ]);\n    const VideoComponent = video ? video.component : null;\n    const outerStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return calculateOuterStyle({ canvasSize, config, style });\n    }, [canvasSize, config, style]);\n    const outer = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return calculateOuter({ config, layout, scale });\n    }, [config, layout, scale]);\n    const containerStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return calculateContainerStyle({ canvasSize, config, layout, scale });\n    }, [canvasSize, config, layout, scale]);\n    const onError = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((error) => {\n        player.pause();\n        // Pay attention to `this context`\n        player.emitter.dispatchError(error);\n    }, [player]);\n    const onFullscreenButtonClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        e.stopPropagation();\n        requestFullscreen();\n    }, [requestFullscreen]);\n    const onExitFullscreenButtonClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        e.stopPropagation();\n        exitFullscreen();\n    }, [exitFullscreen]);\n    const onSingleClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((e) => {\n        toggle(e);\n    }, [toggle]);\n    const onSeekStart = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        setSeeking(true);\n    }, []);\n    const onSeekEnd = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        setSeeking(false);\n    }, []);\n    const onDoubleClick = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (isFullscreen) {\n            exitFullscreen();\n        }\n        else {\n            requestFullscreen();\n        }\n    }, [exitFullscreen, isFullscreen, requestFullscreen]);\n    const [handleClick, handleDoubleClick] = useClickPreventionOnDoubleClick(onSingleClick, onDoubleClick, doubleClickToFullscreen);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        if (shouldAutoplay) {\n            player.play();\n            setShouldAutoPlay(false);\n        }\n    }, [shouldAutoplay, player]);\n    const loadingMarkup = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return renderLoading\n            ? renderLoading({\n                height: outerStyle.height,\n                width: outerStyle.width,\n            })\n            : null;\n    }, [outerStyle.height, outerStyle.width, renderLoading]);\n    if (!config) {\n        return null;\n    }\n    const poster = renderPoster\n        ? renderPoster({\n            height: outerStyle.height,\n            width: outerStyle.width,\n        })\n        : null;\n    if (poster === undefined) {\n        throw new TypeError('renderPoster() must return a React element, but undefined was returned');\n    }\n    const shouldShowPoster = poster &&\n        [\n            showPosterWhenPaused && !player.isPlaying() && !seeking,\n            showPosterWhenEnded && player.isLastFrame && !player.isPlaying(),\n            showPosterWhenUnplayed && !player.hasPlayed && !player.isPlaying(),\n        ].some(Boolean);\n    const content = ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment, { children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: outer, onClick: clickToPlay ? handleClick : undefined, onDoubleClick: doubleClickToFullscreen ? handleDoubleClick : undefined, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: containerStyle, className: PLAYER_CSS_CLASSNAME, children: VideoComponent ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(ErrorBoundary, { onError: onError, errorFallback: errorFallback, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.ClipComposition, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(VideoComponent, { ...((_c = video === null || video === void 0 ? void 0 : video.props) !== null && _c !== void 0 ? _c : {}), ...(inputProps !== null && inputProps !== void 0 ? inputProps : {}) }) }) })) : null }) }), shouldShowPoster ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: outer, onClick: clickToPlay ? handleClick : undefined, onDoubleClick: doubleClickToFullscreen ? handleDoubleClick : undefined, children: poster })) : null, controls ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(Controls, { fps: config.fps, durationInFrames: config.durationInFrames, player: player, containerRef: container, onFullscreenButtonClick: onFullscreenButtonClick, isFullscreen: isFullscreen, allowFullscreen: allowFullscreen, showVolumeControls: showVolumeControls, onExitFullscreenButtonClick: onExitFullscreenButtonClick, spaceKeyToPlayOrPause: spaceKeyToPlayOrPause, onSeekEnd: onSeekEnd, onSeekStart: onSeekStart, inFrame: inFrame, outFrame: outFrame, initiallyShowControls: initiallyShowControls, canvasSize: canvasSize, renderFullscreenButton: renderFullscreenButton, renderPlayPauseButton: renderPlayPauseButton, alwaysShowControls: alwaysShowControls, showPlaybackRateControl: showPlaybackRateControl })) : null] }));\n    if (IS_NODE && !doesReactVersionSupportSuspense$1) {\n        return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { ref: container, style: outerStyle, className: className, children: content }));\n    }\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { ref: container, style: outerStyle, className: className, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react__WEBPACK_IMPORTED_MODULE_0__.Suspense, { fallback: loadingMarkup, children: content }) }));\n};\nvar PlayerUI$1 = (0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(PlayerUI);\n\nconst VOLUME_PERSISTANCE_KEY = 'remotion.volumePreference';\nconst persistVolume = (volume) => {\n    if (typeof window === 'undefined') {\n        return;\n    }\n    window.localStorage.setItem(VOLUME_PERSISTANCE_KEY, String(volume));\n};\nconst getPreferredVolume = () => {\n    if (typeof window === 'undefined') {\n        return 1;\n    }\n    const val = window.localStorage.getItem(VOLUME_PERSISTANCE_KEY);\n    return val ? Number(val) : 1;\n};\n\nconst PLAYER_COMP_ID = 'player-comp';\nconst SharedPlayerContexts = ({ children, timelineContext, fps, compositionHeight, compositionWidth, durationInFrames, component, numberOfSharedAudioTags, initiallyMuted, }) => {\n    const compositionManagerContext = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        const context = {\n            compositions: [\n                {\n                    component: component,\n                    durationInFrames,\n                    height: compositionHeight,\n                    width: compositionWidth,\n                    fps,\n                    id: PLAYER_COMP_ID,\n                    nonce: 777,\n                    folderName: null,\n                    parentFolderName: null,\n                    schema: null,\n                    calculateMetadata: null,\n                },\n            ],\n            folders: [],\n            registerFolder: () => undefined,\n            unregisterFolder: () => undefined,\n            registerComposition: () => undefined,\n            unregisterComposition: () => undefined,\n            currentCompositionMetadata: null,\n            setCurrentCompositionMetadata: () => undefined,\n            canvasContent: { type: 'composition', compositionId: 'player-comp' },\n            setCanvasContent: () => undefined,\n        };\n        return context;\n    }, [component, durationInFrames, compositionHeight, compositionWidth, fps]);\n    const [mediaMuted, setMediaMuted] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => initiallyMuted);\n    const [mediaVolume, setMediaVolume] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => getPreferredVolume());\n    const mediaVolumeContextValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            mediaMuted,\n            mediaVolume,\n        };\n    }, [mediaMuted, mediaVolume]);\n    const setMediaVolumeAndPersist = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((vol) => {\n        setMediaVolume(vol);\n        persistVolume(vol);\n    }, []);\n    const setMediaVolumeContextValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            setMediaMuted,\n            setMediaVolume: setMediaVolumeAndPersist,\n        };\n    }, [setMediaVolumeAndPersist]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.CanUseRemotionHooksProvider, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.TimelineContext.Provider, { value: timelineContext, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.CompositionManager.Provider, { value: compositionManagerContext, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.ResolveCompositionConfig, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.PrefetchProvider, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.DurationsContextProvider, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.MediaVolumeContext.Provider, { value: mediaVolumeContextValue, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.NativeLayersProvider, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.SetMediaVolumeContext.Provider, { value: setMediaVolumeContextValue, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.SharedAudioContextProvider, { numberOfAudioTags: numberOfSharedAudioTags, component: component, children: children }) }) }) }) }) }) }) }) }) }));\n};\n\nconst validateSingleFrame = (frame, variableName) => {\n    if (typeof frame === 'undefined' || frame === null) {\n        return frame !== null && frame !== void 0 ? frame : null;\n    }\n    if (typeof frame !== 'number') {\n        throw new TypeError(`\"${variableName}\" must be a number, but is ${JSON.stringify(frame)}`);\n    }\n    if (Number.isNaN(frame)) {\n        throw new TypeError(`\"${variableName}\" must not be NaN, but is ${JSON.stringify(frame)}`);\n    }\n    if (!Number.isFinite(frame)) {\n        throw new TypeError(`\"${variableName}\" must be finite, but is ${JSON.stringify(frame)}`);\n    }\n    if (frame % 1 !== 0) {\n        throw new TypeError(`\"${variableName}\" must be an integer, but is ${JSON.stringify(frame)}`);\n    }\n    return frame;\n};\nconst validateInOutFrames = ({ inFrame, durationInFrames, outFrame, }) => {\n    const validatedInFrame = validateSingleFrame(inFrame, 'inFrame');\n    const validatedOutFrame = validateSingleFrame(outFrame, 'outFrame');\n    if (validatedInFrame === null && validatedOutFrame === null) {\n        return;\n    }\n    // Must not be over the duration\n    if (validatedInFrame !== null && validatedInFrame > durationInFrames - 1) {\n        throw new Error('inFrame must be less than (durationInFrames - 1), but is ' +\n            validatedInFrame);\n    }\n    if (validatedOutFrame !== null && validatedOutFrame > durationInFrames - 1) {\n        throw new Error('outFrame must be less than (durationInFrames - 1), but is ' +\n            validatedOutFrame);\n    }\n    // Must not be under 0\n    if (validatedInFrame !== null && validatedInFrame < 0) {\n        throw new Error('inFrame must be greater than 0, but is ' + validatedInFrame);\n    }\n    if (validatedOutFrame !== null && validatedOutFrame <= 0) {\n        throw new Error(`outFrame must be greater than 0, but is ${validatedOutFrame}. If you want to render a single frame, use <Thumbnail /> instead.`);\n    }\n    if (validatedOutFrame !== null &&\n        validatedInFrame !== null &&\n        validatedOutFrame <= validatedInFrame) {\n        throw new Error('outFrame must be greater than inFrame, but is ' +\n            validatedOutFrame +\n            ' <= ' +\n            validatedInFrame);\n    }\n};\n\nconst validateInitialFrame = ({ initialFrame, durationInFrames, }) => {\n    if (typeof durationInFrames !== 'number') {\n        throw new Error(`\\`durationInFrames\\` must be a number, but is ${JSON.stringify(durationInFrames)}`);\n    }\n    if (typeof initialFrame === 'undefined') {\n        return;\n    }\n    if (typeof initialFrame !== 'number') {\n        throw new Error(`\\`initialFrame\\` must be a number, but is ${JSON.stringify(initialFrame)}`);\n    }\n    if (Number.isNaN(initialFrame)) {\n        throw new Error(`\\`initialFrame\\` must be a number, but is NaN`);\n    }\n    if (!Number.isFinite(initialFrame)) {\n        throw new Error(`\\`initialFrame\\` must be a number, but is Infinity`);\n    }\n    if (initialFrame % 1 !== 0) {\n        throw new Error(`\\`initialFrame\\` must be an integer, but is ${JSON.stringify(initialFrame)}`);\n    }\n    if (initialFrame > durationInFrames - 1) {\n        throw new Error(`\\`initialFrame\\` must be less or equal than \\`durationInFrames - 1\\`, but is ${JSON.stringify(initialFrame)}`);\n    }\n};\n\nconst validatePlaybackRate = (playbackRate) => {\n    if (playbackRate === undefined) {\n        return;\n    }\n    if (playbackRate > 4) {\n        throw new Error(`The highest possible playback rate is 4. You passed: ${playbackRate}`);\n    }\n    if (playbackRate < -4) {\n        throw new Error(`The lowest possible playback rate is -4. You passed: ${playbackRate}`);\n    }\n    if (playbackRate === 0) {\n        throw new Error(`A playback rate of 0 is not supported.`);\n    }\n};\n\n/* eslint-disable prefer-destructuring */\nconst validateFps = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.validateFps;\nconst validateDimension = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.validateDimension;\nconst validateDurationInFrames = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.validateDurationInFrames;\nconst validateDefaultAndInputProps = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.validateDefaultAndInputProps;\n\nconst componentOrNullIfLazy = (props) => {\n    if ('component' in props) {\n        return props.component;\n    }\n    return null;\n};\nconst PlayerFn = ({ durationInFrames, compositionHeight, compositionWidth, fps, inputProps, style, controls = false, loop = false, autoPlay = false, showVolumeControls = true, allowFullscreen = true, clickToPlay, doubleClickToFullscreen = false, spaceKeyToPlayOrPause = true, moveToBeginningWhenEnded = true, numberOfSharedAudioTags = 5, errorFallback = () => '⚠️', playbackRate = 1, renderLoading, className, showPosterWhenUnplayed, showPosterWhenEnded, showPosterWhenPaused, initialFrame, renderPoster, inFrame, outFrame, initiallyShowControls, renderFullscreenButton, renderPlayPauseButton, alwaysShowControls = false, initiallyMuted = false, showPlaybackRateControl = false, ...componentProps }, ref) => {\n    if (typeof window !== 'undefined') {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        (0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {\n            window.remotion_isPlayer = true;\n        }, []);\n    }\n    // @ts-expect-error\n    if (componentProps.defaultProps !== undefined) {\n        throw new Error('The <Player /> component does not accept `defaultProps`, but some were passed. Use `inputProps` instead.');\n    }\n    const componentForValidation = componentOrNullIfLazy(componentProps);\n    // @ts-expect-error\n    if ((componentForValidation === null || componentForValidation === void 0 ? void 0 : componentForValidation.type) === remotion__WEBPACK_IMPORTED_MODULE_1__.Composition) {\n        throw new TypeError(`'component' should not be an instance of <Composition/>. Pass the React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.`);\n    }\n    if (componentForValidation === remotion__WEBPACK_IMPORTED_MODULE_1__.Composition) {\n        throw new TypeError(`'component' must not be the 'Composition' component. Pass your own React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.`);\n    }\n    const component = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useLazyComponent(componentProps);\n    validateInitialFrame({ initialFrame, durationInFrames });\n    const [frame, setFrame] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => ({\n        [PLAYER_COMP_ID]: initialFrame !== null && initialFrame !== void 0 ? initialFrame : 0,\n    }));\n    const [playing, setPlaying] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [rootId] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)('player-comp');\n    const [emitter] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => new PlayerEmitter());\n    const rootRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const audioAndVideoTags = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)([]);\n    const imperativePlaying = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);\n    const [currentPlaybackRate, setCurrentPlaybackRate] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(playbackRate);\n    if (typeof compositionHeight !== 'number') {\n        throw new TypeError(`'compositionHeight' must be a number but got '${typeof compositionHeight}' instead`);\n    }\n    if (typeof compositionWidth !== 'number') {\n        throw new TypeError(`'compositionWidth' must be a number but got '${typeof compositionWidth}' instead`);\n    }\n    validateDimension(compositionHeight, 'compositionHeight', 'of the <Player /> component');\n    validateDimension(compositionWidth, 'compositionWidth', 'of the <Player /> component');\n    validateDurationInFrames(durationInFrames, {\n        component: 'of the <Player/> component',\n        allowFloats: false,\n    });\n    validateFps(fps, 'as a prop of the <Player/> component', false);\n    validateDefaultAndInputProps(inputProps, 'inputProps', null);\n    validateInOutFrames({\n        durationInFrames,\n        inFrame,\n        outFrame,\n    });\n    if (typeof controls !== 'boolean' && typeof controls !== 'undefined') {\n        throw new TypeError(`'controls' must be a boolean or undefined but got '${typeof controls}' instead`);\n    }\n    if (typeof autoPlay !== 'boolean' && typeof autoPlay !== 'undefined') {\n        throw new TypeError(`'autoPlay' must be a boolean or undefined but got '${typeof autoPlay}' instead`);\n    }\n    if (typeof loop !== 'boolean' && typeof loop !== 'undefined') {\n        throw new TypeError(`'loop' must be a boolean or undefined but got '${typeof loop}' instead`);\n    }\n    if (typeof doubleClickToFullscreen !== 'boolean' &&\n        typeof doubleClickToFullscreen !== 'undefined') {\n        throw new TypeError(`'doubleClickToFullscreen' must be a boolean or undefined but got '${typeof doubleClickToFullscreen}' instead`);\n    }\n    if (typeof showVolumeControls !== 'boolean' &&\n        typeof showVolumeControls !== 'undefined') {\n        throw new TypeError(`'showVolumeControls' must be a boolean or undefined but got '${typeof showVolumeControls}' instead`);\n    }\n    if (typeof allowFullscreen !== 'boolean' &&\n        typeof allowFullscreen !== 'undefined') {\n        throw new TypeError(`'allowFullscreen' must be a boolean or undefined but got '${typeof allowFullscreen}' instead`);\n    }\n    if (typeof clickToPlay !== 'boolean' && typeof clickToPlay !== 'undefined') {\n        throw new TypeError(`'clickToPlay' must be a boolean or undefined but got '${typeof clickToPlay}' instead`);\n    }\n    if (typeof spaceKeyToPlayOrPause !== 'boolean' &&\n        typeof spaceKeyToPlayOrPause !== 'undefined') {\n        throw new TypeError(`'spaceKeyToPlayOrPause' must be a boolean or undefined but got '${typeof spaceKeyToPlayOrPause}' instead`);\n    }\n    if (typeof numberOfSharedAudioTags !== 'number' ||\n        numberOfSharedAudioTags % 1 !== 0 ||\n        !Number.isFinite(numberOfSharedAudioTags) ||\n        Number.isNaN(numberOfSharedAudioTags) ||\n        numberOfSharedAudioTags < 0) {\n        throw new TypeError(`'numberOfSharedAudioTags' must be an integer but got '${numberOfSharedAudioTags}' instead`);\n    }\n    validatePlaybackRate(currentPlaybackRate);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        emitter.dispatchRateChange(currentPlaybackRate);\n    }, [emitter, currentPlaybackRate]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n        setCurrentPlaybackRate(playbackRate);\n    }, [playbackRate]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useImperativeHandle)(ref, () => rootRef.current, []);\n    const timelineContextValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            frame,\n            playing,\n            rootId,\n            playbackRate: currentPlaybackRate,\n            imperativePlaying,\n            setPlaybackRate: (rate) => {\n                setCurrentPlaybackRate(rate);\n            },\n            audioAndVideoTags,\n        };\n    }, [frame, currentPlaybackRate, playing, rootId]);\n    const setTimelineContextValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            setFrame,\n            setPlaying,\n        };\n    }, [setFrame]);\n    if (typeof window !== 'undefined') {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        (0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {\n            // Inject CSS only on client, and also only after the Player has hydrated\n            remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.CSSUtils.injectCSS(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.CSSUtils.makeDefaultCSS(`.${PLAYER_CSS_CLASSNAME}`, '#fff'));\n        }, []);\n    }\n    const actualInputProps = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => inputProps !== null && inputProps !== void 0 ? inputProps : {}, [inputProps]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.IsPlayerContextProvider, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(SharedPlayerContexts, { timelineContext: timelineContextValue, component: component, compositionHeight: compositionHeight, compositionWidth: compositionWidth, durationInFrames: durationInFrames, fps: fps, numberOfSharedAudioTags: numberOfSharedAudioTags, initiallyMuted: initiallyMuted, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.Timeline.SetTimelineContext.Provider, { value: setTimelineContextValue, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlayerEventEmitterContext.Provider, { value: emitter, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(PlayerUI$1, { ref: rootRef, renderLoading: renderLoading, autoPlay: Boolean(autoPlay), loop: Boolean(loop), controls: Boolean(controls), errorFallback: errorFallback, style: style, inputProps: actualInputProps, allowFullscreen: Boolean(allowFullscreen), moveToBeginningWhenEnded: Boolean(moveToBeginningWhenEnded), clickToPlay: typeof clickToPlay === 'boolean'\n                            ? clickToPlay\n                            : Boolean(controls), showVolumeControls: Boolean(showVolumeControls), doubleClickToFullscreen: Boolean(doubleClickToFullscreen), spaceKeyToPlayOrPause: Boolean(spaceKeyToPlayOrPause), playbackRate: currentPlaybackRate, className: className !== null && className !== void 0 ? className : undefined, showPosterWhenUnplayed: Boolean(showPosterWhenUnplayed), showPosterWhenEnded: Boolean(showPosterWhenEnded), showPosterWhenPaused: Boolean(showPosterWhenPaused), renderPoster: renderPoster, inFrame: inFrame !== null && inFrame !== void 0 ? inFrame : null, outFrame: outFrame !== null && outFrame !== void 0 ? outFrame : null, initiallyShowControls: initiallyShowControls !== null && initiallyShowControls !== void 0 ? initiallyShowControls : true, renderFullscreen: renderFullscreenButton !== null && renderFullscreenButton !== void 0 ? renderFullscreenButton : null, renderPlayPauseButton: renderPlayPauseButton !== null && renderPlayPauseButton !== void 0 ? renderPlayPauseButton : null, alwaysShowControls: alwaysShowControls, showPlaybackRateControl: showPlaybackRateControl }) }) }) }) }));\n};\nconst forward$1 = react__WEBPACK_IMPORTED_MODULE_0__.forwardRef;\n/**\n * @description A component which can be rendered in a regular React App (for example: Vite, Next.js) to display a Remotion video.\n * @see [Documentation](https://www.remotion.dev/docs/player/player)\n */\nconst Player = forward$1(PlayerFn);\n\nconst useThumbnail = () => {\n    const emitter = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(ThumbnailEmitterContext);\n    if (!emitter) {\n        throw new TypeError('Expected Player event emitter context');\n    }\n    const returnValue = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return {\n            emitter,\n        };\n    }, [emitter]);\n    return returnValue;\n};\n\nconst reactVersion = react__WEBPACK_IMPORTED_MODULE_0__.version.split('.')[0];\nif (reactVersion === '0') {\n    throw new Error(`Version ${reactVersion} of \"react\" is not supported by Remotion`);\n}\nconst doesReactVersionSupportSuspense = parseInt(reactVersion, 10) >= 18;\nconst ThumbnailUI = ({ style, inputProps, errorFallback, renderLoading, className }, ref) => {\n    var _a, _b;\n    const config = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useUnsafeVideoConfig();\n    const video = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useVideo();\n    const container = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const canvasSize = useElementSize(container, {\n        triggerOnWindowResize: false,\n        shouldApplyCssTransforms: false,\n    });\n    const layout = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        if (!config || !canvasSize) {\n            return null;\n        }\n        return calculateCanvasTransformation({\n            canvasSize,\n            compositionHeight: config.height,\n            compositionWidth: config.width,\n            previewSize: 'auto',\n        });\n    }, [canvasSize, config]);\n    const scale = (_a = layout === null || layout === void 0 ? void 0 : layout.scale) !== null && _a !== void 0 ? _a : 1;\n    const thumbnail = useThumbnail();\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useImperativeHandle)(ref, () => {\n        const methods = {\n            getContainerNode: () => container.current,\n            getScale: () => scale,\n        };\n        return Object.assign(thumbnail.emitter, methods);\n    }, [scale, thumbnail.emitter]);\n    const VideoComponent = video ? video.component : null;\n    const outerStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return calculateOuterStyle({ config, style, canvasSize });\n    }, [canvasSize, config, style]);\n    const outer = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return calculateOuter({ config, layout, scale });\n    }, [config, layout, scale]);\n    const containerStyle = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return calculateContainerStyle({\n            canvasSize,\n            config,\n            layout,\n            scale,\n        });\n    }, [canvasSize, config, layout, scale]);\n    const onError = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((error) => {\n        // Pay attention to `this context`\n        thumbnail.emitter.dispatchError(error);\n    }, [thumbnail.emitter]);\n    const rootRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useImperativeHandle)(ref, () => rootRef.current, []);\n    const loadingMarkup = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return renderLoading\n            ? renderLoading({\n                height: outerStyle.height,\n                width: outerStyle.width,\n            })\n            : null;\n    }, [outerStyle.height, outerStyle.width, renderLoading]);\n    if (!config) {\n        return null;\n    }\n    const content = ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: outer, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { style: containerStyle, className: PLAYER_CSS_CLASSNAME, children: VideoComponent ? ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(ErrorBoundary, { onError: onError, errorFallback: errorFallback, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(VideoComponent, { ...((_b = video === null || video === void 0 ? void 0 : video.props) !== null && _b !== void 0 ? _b : {}), ...(inputProps !== null && inputProps !== void 0 ? inputProps : {}) }) })) : null }) }));\n    if (IS_NODE && !doesReactVersionSupportSuspense) {\n        return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { ref: container, style: outerStyle, className: className, children: content }));\n    }\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(\"div\", { ref: container, style: outerStyle, className: className, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react__WEBPACK_IMPORTED_MODULE_0__.Suspense, { fallback: loadingMarkup, children: content }) }));\n};\nvar ThumbnailUI$1 = (0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(ThumbnailUI);\n\nconst ThumbnailFn = ({ frameToDisplay, style, inputProps, compositionHeight, compositionWidth, durationInFrames, fps, className, errorFallback = () => '⚠️', renderLoading, ...componentProps }, ref) => {\n    if (typeof window !== 'undefined') {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        (0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {\n            window.remotion_isPlayer = true;\n        }, []);\n    }\n    const [thumbnailId] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => String((0,remotion__WEBPACK_IMPORTED_MODULE_1__.random)(null)));\n    const rootRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const timelineState = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        const value = {\n            playing: false,\n            frame: {\n                [PLAYER_COMP_ID]: frameToDisplay,\n            },\n            rootId: thumbnailId,\n            imperativePlaying: {\n                current: false,\n            },\n            playbackRate: 1,\n            setPlaybackRate: () => {\n                throw new Error('thumbnail');\n            },\n            audioAndVideoTags: { current: [] },\n        };\n        return value;\n    }, [frameToDisplay, thumbnailId]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useImperativeHandle)(ref, () => rootRef.current, []);\n    const Component = remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.useLazyComponent(componentProps);\n    const [emitter] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(() => new ThumbnailEmitter());\n    const passedInputProps = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {\n        return inputProps !== null && inputProps !== void 0 ? inputProps : {};\n    }, [inputProps]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(remotion__WEBPACK_IMPORTED_MODULE_1__.Internals.IsPlayerContextProvider, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(SharedPlayerContexts, { timelineContext: timelineState, component: Component, compositionHeight: compositionHeight, compositionWidth: compositionWidth, durationInFrames: durationInFrames, fps: fps, numberOfSharedAudioTags: 0, initiallyMuted: true, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(ThumbnailEmitterContext.Provider, { value: emitter, children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(ThumbnailUI$1, { className: className, errorFallback: errorFallback, inputProps: passedInputProps, renderLoading: renderLoading, style: style }) }) }) }));\n};\nconst forward = react__WEBPACK_IMPORTED_MODULE_0__.forwardRef;\n/**\n * @description A component which can be rendered in a regular React App (for example: Create React App, Next.js) to display a single frame of a video.\n * @see [Documentation](https://www.remotion.dev/docs/player/thumbnail)\n */\nconst Thumbnail = forward(ThumbnailFn);\n\nconst PlayerInternals = {\n    PlayerEventEmitterContext,\n    PlayerEmitter,\n    usePlayer,\n    usePlayback,\n    useElementSize,\n    calculateCanvasTransformation,\n    useHoverState,\n    updateAllElementsSizes,\n    calculateScale,\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0ByZW1vdGlvbitwbGF5ZXJANC4wLjQ3X3JlYWN0LWRvbUAxOC4yLjBfcmVhY3RAMTguMi4wL25vZGVfbW9kdWxlcy9AcmVtb3Rpb24vcGxheWVyL2Rpc3QvZXNtL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUN5SjtBQUNsRjtBQUNmOztBQUV4RCwrQkFBK0Isa0VBQWtFO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMEJBQTBCLCtEQUErRDtBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLCtEQUErRDtBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0QkFBNEI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxvQ0FBb0M7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixNQUFNO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsd0JBQXdCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLFlBQVksbUJBQW1CO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0NBQWtDLGdEQUFtQjtBQUNyRCxnQ0FBZ0MsZ0RBQW1COztBQUVuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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LEdBQUc7QUFDM0o7QUFDQSxvQkFBb0IsaURBQVU7O0FBRTlCLHVCQUF1Qix3S0FBd0s7QUFDL0w7QUFDQTtBQUNBLFFBQVEsc0RBQWU7QUFDdkI7QUFDQSxTQUFTO0FBQ1Q7QUFDQSwwQkFBMEIsK0NBQVEsY0FBYyxnREFBTTtBQUN0RCxvQkFBb0IsNkNBQU07QUFDMUIsMEJBQTBCLDhDQUFPO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsaUNBQWlDLGFBQWE7QUFDOUM7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJLDBEQUFtQjtBQUN2QixzQkFBc0IsK0NBQVM7QUFDL0Isc0JBQXNCLCtDQUFRO0FBQzlCLDZCQUE2Qiw4Q0FBTztBQUNwQztBQUNBLEtBQUs7QUFDTCxZQUFZLHNEQUFHLENBQUMsK0NBQVMsNEJBQTRCLFVBQVUsc0RBQUcseUJBQXlCLDBPQUEwTyxzREFBRyxxQ0FBcUMsMEJBQTBCLHNEQUFHLGtCQUFrQiw4SEFBOEgsR0FBRyxHQUFHLEdBQUc7QUFDbmlCO0FBQ0EsZ0JBQWdCLDZDQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFOEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdHVkaW8vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0ByZW1vdGlvbitwbGF5ZXJANC4wLjQ3X3JlYWN0LWRvbUAxOC4yLjBfcmVhY3RAMTguMi4wL25vZGVfbW9kdWxlcy9AcmVtb3Rpb24vcGxheWVyL2Rpc3QvZXNtL2luZGV4Lm1qcz9kOGQ5Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGNsaWVudFwiO1xuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZiwgdXNlQ29udGV4dCwgdXNlQ2FsbGJhY2ssIHVzZU1lbW8sIGZvcndhcmRSZWYsIHVzZUltcGVyYXRpdmVIYW5kbGUsIFN1c3BlbnNlLCB1c2VMYXlvdXRFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBJbnRlcm5hbHMsIHJhbmRvbSwgaW50ZXJwb2xhdGUsIENvbXBvc2l0aW9uIH0gZnJvbSAncmVtb3Rpb24nO1xuaW1wb3J0IHsganN4LCBqc3hzLCBGcmFnbWVudCB9IGZyb20gJ3JlYWN0L2pzeC1ydW50aW1lJztcblxuY29uc3QgY2FsY3VsYXRlUGxheWVyU2l6ZSA9ICh7IGN1cnJlbnRTaXplLCB3aWR0aCwgaGVpZ2h0LCBjb21wb3NpdGlvbldpZHRoLCBjb21wb3NpdGlvbkhlaWdodCwgfSkgPT4ge1xuICAgIGlmICh3aWR0aCAhPT0gdW5kZWZpbmVkICYmIGhlaWdodCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhc3BlY3RSYXRpbzogW2NvbXBvc2l0aW9uV2lkdGgsIGNvbXBvc2l0aW9uSGVpZ2h0XS5qb2luKCcvJyksXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIE9wcG9zaXRlOiBJZiBoYXMgaGVpZ2h0IHNwZWNpZmllZCwgZXZhbHVhdGUgdGhlIGhlaWdodCBhbmQgc3BlY2lmeSBhIGRlZmF1bHQgd2lkdGguXG4gICAgaWYgKGhlaWdodCAhPT0gdW5kZWZpbmVkICYmIHdpZHRoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC8vIEFzcGVjdCByYXRpbyBDU1MgcHJvcCB3aWxsIHdvcmtcbiAgICAgICAgICAgIGFzcGVjdFJhdGlvOiBbY29tcG9zaXRpb25XaWR0aCwgY29tcG9zaXRpb25IZWlnaHRdLmpvaW4oJy8nKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaWYgKCFjdXJyZW50U2l6ZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IGNvbXBvc2l0aW9uV2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGNvbXBvc2l0aW9uSGVpZ2h0LFxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogY29tcG9zaXRpb25XaWR0aCxcbiAgICAgICAgaGVpZ2h0OiBjb21wb3NpdGlvbkhlaWdodCxcbiAgICB9O1xufTtcblxuY29uc3QgY2FsY3VsYXRlU2NhbGUgPSAoeyBjYW52YXNTaXplLCBjb21wb3NpdGlvbkhlaWdodCwgY29tcG9zaXRpb25XaWR0aCwgcHJldmlld1NpemUsIH0pID0+IHtcbiAgICBjb25zdCBoZWlnaHRSYXRpbyA9IGNhbnZhc1NpemUuaGVpZ2h0IC8gY29tcG9zaXRpb25IZWlnaHQ7XG4gICAgY29uc3Qgd2lkdGhSYXRpbyA9IGNhbnZhc1NpemUud2lkdGggLyBjb21wb3NpdGlvbldpZHRoO1xuICAgIGNvbnN0IHJhdGlvID0gTWF0aC5taW4oaGVpZ2h0UmF0aW8sIHdpZHRoUmF0aW8pO1xuICAgIHJldHVybiBwcmV2aWV3U2l6ZSA9PT0gJ2F1dG8nID8gcmF0aW8gOiBOdW1iZXIocHJldmlld1NpemUpO1xufTtcbmNvbnN0IGNhbGN1bGF0ZUNhbnZhc1RyYW5zZm9ybWF0aW9uID0gKHsgcHJldmlld1NpemUsIGNvbXBvc2l0aW9uV2lkdGgsIGNvbXBvc2l0aW9uSGVpZ2h0LCBjYW52YXNTaXplLCB9KSA9PiB7XG4gICAgY29uc3Qgc2NhbGUgPSBjYWxjdWxhdGVTY2FsZSh7XG4gICAgICAgIGNhbnZhc1NpemUsXG4gICAgICAgIGNvbXBvc2l0aW9uSGVpZ2h0LFxuICAgICAgICBjb21wb3NpdGlvbldpZHRoLFxuICAgICAgICBwcmV2aWV3U2l6ZSxcbiAgICB9KTtcbiAgICBjb25zdCBjb3JyZWN0aW9uID0gMCAtICgxIC0gc2NhbGUpIC8gMjtcbiAgICBjb25zdCB4Q29ycmVjdGlvbiA9IGNvcnJlY3Rpb24gKiBjb21wb3NpdGlvbldpZHRoO1xuICAgIGNvbnN0IHlDb3JyZWN0aW9uID0gY29ycmVjdGlvbiAqIGNvbXBvc2l0aW9uSGVpZ2h0O1xuICAgIGNvbnN0IHdpZHRoID0gY29tcG9zaXRpb25XaWR0aCAqIHNjYWxlO1xuICAgIGNvbnN0IGhlaWdodCA9IGNvbXBvc2l0aW9uSGVpZ2h0ICogc2NhbGU7XG4gICAgY29uc3QgY2VudGVyWCA9IGNhbnZhc1NpemUud2lkdGggLyAyIC0gd2lkdGggLyAyO1xuICAgIGNvbnN0IGNlbnRlclkgPSBjYW52YXNTaXplLmhlaWdodCAvIDIgLSBoZWlnaHQgLyAyO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNlbnRlclgsXG4gICAgICAgIGNlbnRlclksXG4gICAgICAgIHhDb3JyZWN0aW9uLFxuICAgICAgICB5Q29ycmVjdGlvbixcbiAgICAgICAgc2NhbGUsXG4gICAgfTtcbn07XG5jb25zdCBjYWxjdWxhdGVPdXRlclN0eWxlID0gKHsgY29uZmlnLCBzdHlsZSwgY2FudmFzU2l6ZSwgfSkgPT4ge1xuICAgIGlmICghY29uZmlnKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICAgICAgLi4uY2FsY3VsYXRlUGxheWVyU2l6ZSh7XG4gICAgICAgICAgICBjb21wb3NpdGlvbkhlaWdodDogY29uZmlnLmhlaWdodCxcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uV2lkdGg6IGNvbmZpZy53aWR0aCxcbiAgICAgICAgICAgIGN1cnJlbnRTaXplOiBjYW52YXNTaXplLFxuICAgICAgICAgICAgaGVpZ2h0OiBzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuaGVpZ2h0LFxuICAgICAgICAgICAgd2lkdGg6IHN0eWxlID09PSBudWxsIHx8IHN0eWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHlsZS53aWR0aCxcbiAgICAgICAgfSksXG4gICAgICAgIC4uLnN0eWxlLFxuICAgIH07XG59O1xuY29uc3QgY2FsY3VsYXRlQ29udGFpbmVyU3R5bGUgPSAoeyBjb25maWcsIGNhbnZhc1NpemUsIGxheW91dCwgc2NhbGUsIH0pID0+IHtcbiAgICBpZiAoIWNvbmZpZyB8fCAhY2FudmFzU2l6ZSB8fCAhbGF5b3V0KSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgIHdpZHRoOiBjb25maWcud2lkdGgsXG4gICAgICAgIGhlaWdodDogY29uZmlnLmhlaWdodCxcbiAgICAgICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgICAgICB0cmFuc2Zvcm06IGBzY2FsZSgke3NjYWxlfSlgLFxuICAgICAgICBtYXJnaW5MZWZ0OiBsYXlvdXQueENvcnJlY3Rpb24sXG4gICAgICAgIG1hcmdpblRvcDogbGF5b3V0LnlDb3JyZWN0aW9uLFxuICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgfTtcbn07XG5jb25zdCBjYWxjdWxhdGVPdXRlciA9ICh7IGxheW91dCwgc2NhbGUsIGNvbmZpZywgfSkgPT4ge1xuICAgIGlmICghbGF5b3V0IHx8ICFjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBjb25zdCB7IGNlbnRlclgsIGNlbnRlclkgfSA9IGxheW91dDtcbiAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogY29uZmlnLndpZHRoICogc2NhbGUsXG4gICAgICAgIGhlaWdodDogY29uZmlnLmhlaWdodCAqIHNjYWxlLFxuICAgICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAgIGZsZXhEaXJlY3Rpb246ICdjb2x1bW4nLFxuICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgbGVmdDogY2VudGVyWCxcbiAgICAgICAgdG9wOiBjZW50ZXJZLFxuICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgfTtcbn07XG5cbmNvbnN0IFBsYXllckV2ZW50RW1pdHRlckNvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0KHVuZGVmaW5lZCk7XG5jb25zdCBUaHVtYm5haWxFbWl0dGVyQ29udGV4dCA9IFJlYWN0LmNyZWF0ZUNvbnRleHQodW5kZWZpbmVkKTtcblxuY2xhc3MgUGxheWVyRW1pdHRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge1xuICAgICAgICAgICAgZW5kZWQ6IFtdLFxuICAgICAgICAgICAgZXJyb3I6IFtdLFxuICAgICAgICAgICAgcGF1c2U6IFtdLFxuICAgICAgICAgICAgcGxheTogW10sXG4gICAgICAgICAgICByYXRlY2hhbmdlOiBbXSxcbiAgICAgICAgICAgIHNjYWxlY2hhbmdlOiBbXSxcbiAgICAgICAgICAgIHNlZWtlZDogW10sXG4gICAgICAgICAgICB0aW1ldXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGZyYW1ldXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGZ1bGxzY3JlZW5jaGFuZ2U6IFtdLFxuICAgICAgICAgICAgdm9sdW1lY2hhbmdlOiBbXSxcbiAgICAgICAgICAgIG11dGVjaGFuZ2U6IFtdLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBhZGRFdmVudExpc3RlbmVyKG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzW25hbWVdLnB1c2goY2FsbGJhY2spO1xuICAgIH1cbiAgICByZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzW25hbWVdID0gdGhpcy5saXN0ZW5lcnNbbmFtZV0uZmlsdGVyKChsKSA9PiBsICE9PSBjYWxsYmFjayk7XG4gICAgfVxuICAgIGRpc3BhdGNoRXZlbnQoZGlzcGF0Y2hOYW1lLCBjb250ZXh0KSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzW2Rpc3BhdGNoTmFtZV0uZm9yRWFjaCgoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHsgZGV0YWlsOiBjb250ZXh0IH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGlzcGF0Y2hTZWVrKGZyYW1lKSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnc2Vla2VkJywge1xuICAgICAgICAgICAgZnJhbWUsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkaXNwYXRjaFZvbHVtZUNoYW5nZSh2b2x1bWUpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCd2b2x1bWVjaGFuZ2UnLCB7XG4gICAgICAgICAgICB2b2x1bWUsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkaXNwYXRjaFBhdXNlKCkge1xuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ3BhdXNlJywgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgZGlzcGF0Y2hQbGF5KCkge1xuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ3BsYXknLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBkaXNwYXRjaEVuZGVkKCkge1xuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2VuZGVkJywgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgZGlzcGF0Y2hSYXRlQ2hhbmdlKHBsYXliYWNrUmF0ZSkge1xuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ3JhdGVjaGFuZ2UnLCB7XG4gICAgICAgICAgICBwbGF5YmFja1JhdGUsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkaXNwYXRjaFNjYWxlQ2hhbmdlKHNjYWxlKSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnc2NhbGVjaGFuZ2UnLCB7XG4gICAgICAgICAgICBzY2FsZSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRpc3BhdGNoRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdlcnJvcicsIHtcbiAgICAgICAgICAgIGVycm9yLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGlzcGF0Y2hUaW1lVXBkYXRlKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgndGltZXVwZGF0ZScsIGV2ZW50KTtcbiAgICB9XG4gICAgZGlzcGF0Y2hGcmFtZVVwZGF0ZShldmVudCkge1xuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2ZyYW1ldXBkYXRlJywgZXZlbnQpO1xuICAgIH1cbiAgICBkaXNwYXRjaEZ1bGxzY3JlZW5DaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdmdWxsc2NyZWVuY2hhbmdlJywgZXZlbnQpO1xuICAgIH1cbiAgICBkaXNwYXRjaE11dGVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdtdXRlY2hhbmdlJywgZXZlbnQpO1xuICAgIH1cbn1cbmNsYXNzIFRodW1ibmFpbEVtaXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IHtcbiAgICAgICAgICAgIGVycm9yOiBbXSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmxpc3RlbmVyc1tuYW1lXS5wdXNoKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmxpc3RlbmVyc1tuYW1lXSA9IHRoaXMubGlzdGVuZXJzW25hbWVdLmZpbHRlcigobCkgPT4gbCAhPT0gY2FsbGJhY2spO1xuICAgIH1cbiAgICBkaXNwYXRjaEV2ZW50KGRpc3BhdGNoTmFtZSwgY29udGV4dCkge1xuICAgICAgICB0aGlzLmxpc3RlbmVyc1tkaXNwYXRjaE5hbWVdLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICBjYWxsYmFjayh7IGRldGFpbDogY29udGV4dCB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRpc3BhdGNoRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdlcnJvcicsIHtcbiAgICAgICAgICAgIGVycm9yLFxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmNvbnN0IHVzZUhvdmVyU3RhdGUgPSAocmVmKSA9PiB7XG4gICAgY29uc3QgW2hvdmVyZWQsIHN0ZXRIb3ZlcmVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCB7IGN1cnJlbnQgfSA9IHJlZjtcbiAgICAgICAgaWYgKCFjdXJyZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb25Ib3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgIHN0ZXRIb3ZlcmVkKHRydWUpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBvbkxlYXZlID0gKCkgPT4ge1xuICAgICAgICAgICAgc3RldEhvdmVyZWQoZmFsc2UpO1xuICAgICAgICB9O1xuICAgICAgICBjdXJyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBvbkhvdmVyKTtcbiAgICAgICAgY3VycmVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgb25MZWF2ZSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBjdXJyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBvbkhvdmVyKTtcbiAgICAgICAgICAgIGN1cnJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIG9uTGVhdmUpO1xuICAgICAgICB9O1xuICAgIH0sIFtyZWZdKTtcbiAgICByZXR1cm4gaG92ZXJlZDtcbn07XG5cbmNvbnN0IGNhbGN1bGF0ZU5leHRGcmFtZSA9ICh7IHRpbWUsIGN1cnJlbnRGcmFtZTogc3RhcnRGcmFtZSwgcGxheWJhY2tTcGVlZCwgZnBzLCBhY3R1YWxMYXN0RnJhbWUsIGFjdHVhbEZpcnN0RnJhbWUsIGZyYW1lc0FkdmFuY2VkLCBzaG91bGRMb29wLCB9KSA9PiB7XG4gICAgY29uc3Qgb3AgPSBwbGF5YmFja1NwZWVkIDwgMCA/IE1hdGguY2VpbCA6IE1hdGguZmxvb3I7XG4gICAgY29uc3QgZnJhbWVzVG9BZHZhbmNlID0gb3AoKHRpbWUgKiBwbGF5YmFja1NwZWVkKSAvICgxMDAwIC8gZnBzKSkgLSBmcmFtZXNBZHZhbmNlZDtcbiAgICBjb25zdCBuZXh0RnJhbWUgPSBmcmFtZXNUb0FkdmFuY2UgKyBzdGFydEZyYW1lO1xuICAgIGNvbnN0IGlzQ3VycmVudEZyYW1lT3V0c2lkZSA9IHN0YXJ0RnJhbWUgPiBhY3R1YWxMYXN0RnJhbWUgfHwgc3RhcnRGcmFtZSA8IGFjdHVhbEZpcnN0RnJhbWU7XG4gICAgY29uc3QgaXNOZXh0RnJhbWVPdXRzaWRlID0gbmV4dEZyYW1lID4gYWN0dWFsTGFzdEZyYW1lIHx8IG5leHRGcmFtZSA8IGFjdHVhbEZpcnN0RnJhbWU7XG4gICAgY29uc3QgaGFzRW5kZWQgPSAhc2hvdWxkTG9vcCAmJiBpc05leHRGcmFtZU91dHNpZGUgJiYgIWlzQ3VycmVudEZyYW1lT3V0c2lkZTtcbiAgICBpZiAocGxheWJhY2tTcGVlZCA+IDApIHtcbiAgICAgICAgLy8gUGxheSBmb3J3YXJkc1xuICAgICAgICBpZiAoaXNOZXh0RnJhbWVPdXRzaWRlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5leHRGcmFtZTogYWN0dWFsRmlyc3RGcmFtZSxcbiAgICAgICAgICAgICAgICBmcmFtZXNUb0FkdmFuY2UsXG4gICAgICAgICAgICAgICAgaGFzRW5kZWQsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IG5leHRGcmFtZSwgZnJhbWVzVG9BZHZhbmNlLCBoYXNFbmRlZCB9O1xuICAgIH1cbiAgICAvLyBSZXZlcnNlIHBsYXliYWNrXG4gICAgaWYgKGlzTmV4dEZyYW1lT3V0c2lkZSkge1xuICAgICAgICByZXR1cm4geyBuZXh0RnJhbWU6IGFjdHVhbExhc3RGcmFtZSwgZnJhbWVzVG9BZHZhbmNlLCBoYXNFbmRlZCB9O1xuICAgIH1cbiAgICByZXR1cm4geyBuZXh0RnJhbWUsIGZyYW1lc1RvQWR2YW5jZSwgaGFzRW5kZWQgfTtcbn07XG5cbmNvbnN0IGdldElzQmFja2dyb3VuZGVkID0gKCkgPT4ge1xuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ2hpZGRlbic7XG59O1xuY29uc3QgdXNlSXNCYWNrZ3JvdW5kZWQgPSAoKSA9PiB7XG4gICAgY29uc3QgaXNCYWNrZ3JvdW5kZWQgPSB1c2VSZWYoZ2V0SXNCYWNrZ3JvdW5kZWQoKSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3Qgb25WaXNpYmlsaXR5Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaXNCYWNrZ3JvdW5kZWQuY3VycmVudCA9IGdldElzQmFja2dyb3VuZGVkKCk7XG4gICAgICAgIH07XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Zpc2liaWxpdHljaGFuZ2UnLCBvblZpc2liaWxpdHlDaGFuZ2UpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsIG9uVmlzaWJpbGl0eUNoYW5nZSk7XG4gICAgICAgIH07XG4gICAgfSwgW10pO1xuICAgIHJldHVybiBpc0JhY2tncm91bmRlZDtcbn07XG5cbmNvbnN0IHVzZVBsYXllciA9ICgpID0+IHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgW3BsYXlpbmcsIHNldFBsYXlpbmcsIGltcGVyYXRpdmVQbGF5aW5nXSA9IEludGVybmFscy5UaW1lbGluZS51c2VQbGF5aW5nU3RhdGUoKTtcbiAgICBjb25zdCBbaGFzUGxheWVkLCBzZXRIYXNQbGF5ZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IGZyYW1lID0gSW50ZXJuYWxzLlRpbWVsaW5lLnVzZVRpbWVsaW5lUG9zaXRpb24oKTtcbiAgICBjb25zdCBwbGF5U3RhcnQgPSB1c2VSZWYoZnJhbWUpO1xuICAgIGNvbnN0IHNldEZyYW1lID0gSW50ZXJuYWxzLlRpbWVsaW5lLnVzZVRpbWVsaW5lU2V0RnJhbWUoKTtcbiAgICBjb25zdCBzZXRUaW1lbGluZVBvc2l0aW9uID0gSW50ZXJuYWxzLlRpbWVsaW5lLnVzZVRpbWVsaW5lU2V0RnJhbWUoKTtcbiAgICBjb25zdCBhdWRpb0NvbnRleHQgPSB1c2VDb250ZXh0KEludGVybmFscy5TaGFyZWRBdWRpb0NvbnRleHQpO1xuICAgIGNvbnN0IHsgYXVkaW9BbmRWaWRlb1RhZ3MgfSA9IHVzZUNvbnRleHQoSW50ZXJuYWxzLlRpbWVsaW5lLlRpbWVsaW5lQ29udGV4dCk7XG4gICAgY29uc3QgZnJhbWVSZWYgPSB1c2VSZWYoKTtcbiAgICBmcmFtZVJlZi5jdXJyZW50ID0gZnJhbWU7XG4gICAgY29uc3QgdmlkZW8gPSBJbnRlcm5hbHMudXNlVmlkZW8oKTtcbiAgICBjb25zdCBjb25maWcgPSBJbnRlcm5hbHMudXNlVW5zYWZlVmlkZW9Db25maWcoKTtcbiAgICBjb25zdCBlbWl0dGVyID0gdXNlQ29udGV4dChQbGF5ZXJFdmVudEVtaXR0ZXJDb250ZXh0KTtcbiAgICBjb25zdCBsYXN0RnJhbWUgPSAoKF9hID0gY29uZmlnID09PSBudWxsIHx8IGNvbmZpZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlnLmR1cmF0aW9uSW5GcmFtZXMpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDEpIC0gMTtcbiAgICBjb25zdCBpc0xhc3RGcmFtZSA9IGZyYW1lID09PSBsYXN0RnJhbWU7XG4gICAgY29uc3QgaXNGaXJzdEZyYW1lID0gZnJhbWUgPT09IDA7XG4gICAgaWYgKCFlbWl0dGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIFBsYXllciBldmVudCBlbWl0dGVyIGNvbnRleHQnKTtcbiAgICB9XG4gICAgY29uc3Qgc2VlayA9IHVzZUNhbGxiYWNrKChuZXdGcmFtZSkgPT4ge1xuICAgICAgICBpZiAodmlkZW8gPT09IG51bGwgfHwgdmlkZW8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZpZGVvLmlkKSB7XG4gICAgICAgICAgICBzZXRUaW1lbGluZVBvc2l0aW9uKChjKSA9PiAoeyAuLi5jLCBbdmlkZW8uaWRdOiBuZXdGcmFtZSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgZW1pdHRlci5kaXNwYXRjaFNlZWsobmV3RnJhbWUpO1xuICAgIH0sIFtlbWl0dGVyLCBzZXRUaW1lbGluZVBvc2l0aW9uLCB2aWRlbyA9PT0gbnVsbCB8fCB2aWRlbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmlkZW8uaWRdKTtcbiAgICBjb25zdCBwbGF5ID0gdXNlQ2FsbGJhY2soKGUpID0+IHtcbiAgICAgICAgaWYgKGltcGVyYXRpdmVQbGF5aW5nLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZXRIYXNQbGF5ZWQodHJ1ZSk7XG4gICAgICAgIGlmIChpc0xhc3RGcmFtZSkge1xuICAgICAgICAgICAgc2VlaygwKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogUGxheSBzaWxlbnQgYXVkaW8gdGFncyB0byB3YXJtIHRoZW0gdXAgZm9yIGF1dG9wbGF5XG4gICAgICAgICAqL1xuICAgICAgICBpZiAoYXVkaW9Db250ZXh0ICYmIGF1ZGlvQ29udGV4dC5udW1iZXJPZkF1ZGlvVGFncyA+IDAgJiYgZSkge1xuICAgICAgICAgICAgYXVkaW9Db250ZXh0LnBsYXlBbGxBdWRpb3MoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogUGxheSBhdWRpb3MgYW5kIHZpZGVvcyBkaXJlY3RseSBoZXJlIHNvIHRoZXkgY2FuIGJlbmVmaXQgZnJvbVxuICAgICAgICAgKiBiZWluZyB0cmlnZ2VyZWQgYnkgYSBjbGlja1xuICAgICAgICAgKi9cbiAgICAgICAgYXVkaW9BbmRWaWRlb1RhZ3MuY3VycmVudC5mb3JFYWNoKChhKSA9PiBhLnBsYXkoKSk7XG4gICAgICAgIGltcGVyYXRpdmVQbGF5aW5nLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICBzZXRQbGF5aW5nKHRydWUpO1xuICAgICAgICBwbGF5U3RhcnQuY3VycmVudCA9IGZyYW1lUmVmLmN1cnJlbnQ7XG4gICAgICAgIGVtaXR0ZXIuZGlzcGF0Y2hQbGF5KCk7XG4gICAgfSwgW1xuICAgICAgICBpbXBlcmF0aXZlUGxheWluZyxcbiAgICAgICAgaXNMYXN0RnJhbWUsXG4gICAgICAgIGF1ZGlvQ29udGV4dCxcbiAgICAgICAgc2V0UGxheWluZyxcbiAgICAgICAgZW1pdHRlcixcbiAgICAgICAgc2VlayxcbiAgICAgICAgYXVkaW9BbmRWaWRlb1RhZ3MsXG4gICAgXSk7XG4gICAgY29uc3QgcGF1c2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIGlmIChpbXBlcmF0aXZlUGxheWluZy5jdXJyZW50KSB7XG4gICAgICAgICAgICBpbXBlcmF0aXZlUGxheWluZy5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgICAgICBzZXRQbGF5aW5nKGZhbHNlKTtcbiAgICAgICAgICAgIGVtaXR0ZXIuZGlzcGF0Y2hQYXVzZSgpO1xuICAgICAgICB9XG4gICAgfSwgW2VtaXR0ZXIsIGltcGVyYXRpdmVQbGF5aW5nLCBzZXRQbGF5aW5nXSk7XG4gICAgY29uc3QgcGF1c2VBbmRSZXR1cm5Ub1BsYXlTdGFydCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgaWYgKGltcGVyYXRpdmVQbGF5aW5nLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGltcGVyYXRpdmVQbGF5aW5nLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChjb25maWcpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lbGluZVBvc2l0aW9uKChjKSA9PiAoe1xuICAgICAgICAgICAgICAgICAgICAuLi5jLFxuICAgICAgICAgICAgICAgICAgICBbY29uZmlnLmlkXTogcGxheVN0YXJ0LmN1cnJlbnQsXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHNldFBsYXlpbmcoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGVtaXR0ZXIuZGlzcGF0Y2hQYXVzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgW2NvbmZpZywgZW1pdHRlciwgaW1wZXJhdGl2ZVBsYXlpbmcsIHNldFBsYXlpbmcsIHNldFRpbWVsaW5lUG9zaXRpb25dKTtcbiAgICBjb25zdCB2aWRlb0lkID0gdmlkZW8gPT09IG51bGwgfHwgdmlkZW8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZpZGVvLmlkO1xuICAgIGNvbnN0IGZyYW1lQmFjayA9IHVzZUNhbGxiYWNrKChmcmFtZXMpID0+IHtcbiAgICAgICAgaWYgKCF2aWRlb0lkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW1wZXJhdGl2ZVBsYXlpbmcuY3VycmVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNldEZyYW1lKChjKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgY29uc3QgcHJldiA9IChfYiA9IChfYSA9IGNbdmlkZW9JZF0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHdpbmRvdy5yZW1vdGlvbl9pbml0aWFsRnJhbWUpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IDA7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIC4uLmMsXG4gICAgICAgICAgICAgICAgW3ZpZGVvSWRdOiBNYXRoLm1heCgwLCBwcmV2IC0gZnJhbWVzKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH0sIFtpbXBlcmF0aXZlUGxheWluZywgc2V0RnJhbWUsIHZpZGVvSWRdKTtcbiAgICBjb25zdCBmcmFtZUZvcndhcmQgPSB1c2VDYWxsYmFjaygoZnJhbWVzKSA9PiB7XG4gICAgICAgIGlmICghdmlkZW9JZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGltcGVyYXRpdmVQbGF5aW5nLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZXRGcmFtZSgoYykgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIGNvbnN0IHByZXYgPSAoX2IgPSAoX2EgPSBjW3ZpZGVvSWRdKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB3aW5kb3cucmVtb3Rpb25faW5pdGlhbEZyYW1lKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiAwO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAuLi5jLFxuICAgICAgICAgICAgICAgIFt2aWRlb0lkXTogTWF0aC5taW4obGFzdEZyYW1lLCBwcmV2ICsgZnJhbWVzKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH0sIFt2aWRlb0lkLCBpbXBlcmF0aXZlUGxheWluZywgbGFzdEZyYW1lLCBzZXRGcmFtZV0pO1xuICAgIGNvbnN0IHJldHVyblZhbHVlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmcmFtZUJhY2ssXG4gICAgICAgICAgICBmcmFtZUZvcndhcmQsXG4gICAgICAgICAgICBpc0xhc3RGcmFtZSxcbiAgICAgICAgICAgIGVtaXR0ZXIsXG4gICAgICAgICAgICBwbGF5aW5nLFxuICAgICAgICAgICAgcGxheSxcbiAgICAgICAgICAgIHBhdXNlLFxuICAgICAgICAgICAgc2VlayxcbiAgICAgICAgICAgIGlzRmlyc3RGcmFtZSxcbiAgICAgICAgICAgIGdldEN1cnJlbnRGcmFtZTogKCkgPT4gZnJhbWVSZWYuY3VycmVudCxcbiAgICAgICAgICAgIGlzUGxheWluZzogKCkgPT4gaW1wZXJhdGl2ZVBsYXlpbmcuY3VycmVudCxcbiAgICAgICAgICAgIHBhdXNlQW5kUmV0dXJuVG9QbGF5U3RhcnQsXG4gICAgICAgICAgICBoYXNQbGF5ZWQsXG4gICAgICAgIH07XG4gICAgfSwgW1xuICAgICAgICBmcmFtZUJhY2ssXG4gICAgICAgIGZyYW1lRm9yd2FyZCxcbiAgICAgICAgaXNMYXN0RnJhbWUsXG4gICAgICAgIGVtaXR0ZXIsXG4gICAgICAgIHBsYXlpbmcsXG4gICAgICAgIHBsYXksXG4gICAgICAgIHBhdXNlLFxuICAgICAgICBzZWVrLFxuICAgICAgICBpc0ZpcnN0RnJhbWUsXG4gICAgICAgIHBhdXNlQW5kUmV0dXJuVG9QbGF5U3RhcnQsXG4gICAgICAgIGltcGVyYXRpdmVQbGF5aW5nLFxuICAgICAgICBoYXNQbGF5ZWQsXG4gICAgXSk7XG4gICAgcmV0dXJuIHJldHVyblZhbHVlO1xufTtcblxuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVzZS1iZWZvcmUtZGVmaW5lICovXG5jb25zdCB1c2VQbGF5YmFjayA9ICh7IGxvb3AsIHBsYXliYWNrUmF0ZSwgbW92ZVRvQmVnaW5uaW5nV2hlbkVuZGVkLCBpbkZyYW1lLCBvdXRGcmFtZSwgfSkgPT4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IEludGVybmFscy51c2VVbnNhZmVWaWRlb0NvbmZpZygpO1xuICAgIGNvbnN0IGZyYW1lID0gSW50ZXJuYWxzLlRpbWVsaW5lLnVzZVRpbWVsaW5lUG9zaXRpb24oKTtcbiAgICBjb25zdCB7IHBsYXlpbmcsIHBhdXNlLCBlbWl0dGVyIH0gPSB1c2VQbGF5ZXIoKTtcbiAgICBjb25zdCBzZXRGcmFtZSA9IEludGVybmFscy5UaW1lbGluZS51c2VUaW1lbGluZVNldEZyYW1lKCk7XG4gICAgLy8gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCkgZG9lcyBub3Qgd29yayBpZiB0aGUgdGFiIGlzIG5vdCBhY3RpdmUuXG4gICAgLy8gVGhpcyBtZWFucyB0aGF0IGF1ZGlvIHdpbGwga2VlcCBwbGF5aW5nIGV2ZW4gaWYgaXQgaGFzIGVuZGVkLlxuICAgIC8vIEluIHRoYXQgY2FzZSwgd2UgdXNlIHNldFRpbWVvdXQoKSBpbnN0ZWFkLlxuICAgIGNvbnN0IGlzQmFja2dyb3VuZGVkUmVmID0gdXNlSXNCYWNrZ3JvdW5kZWQoKTtcbiAgICBjb25zdCBmcmFtZVJlZiA9IHVzZVJlZihmcmFtZSk7XG4gICAgZnJhbWVSZWYuY3VycmVudCA9IGZyYW1lO1xuICAgIGNvbnN0IGxhc3RUaW1lVXBkYXRlRXZlbnQgPSB1c2VSZWYobnVsbCk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFjb25maWcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBsYXlpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgaGFzQmVlblN0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgbGV0IHJlcUFuaW1GcmFtZUNhbGwgPSBudWxsO1xuICAgICAgICBjb25zdCBzdGFydGVkVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICBsZXQgZnJhbWVzQWR2YW5jZWQgPSAwO1xuICAgICAgICBjb25zdCBjYW5jZWxRdWV1ZWRGcmFtZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXFBbmltRnJhbWVDYWxsICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcUFuaW1GcmFtZUNhbGwudHlwZSA9PT0gJ3JhZicpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUocmVxQW5pbUZyYW1lQ2FsbC5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocmVxQW5pbUZyYW1lQ2FsbC5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBzdG9wID0gKCkgPT4ge1xuICAgICAgICAgICAgaGFzQmVlblN0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgICAgY2FuY2VsUXVldWVkRnJhbWUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY2FsbGJhY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydGVkVGltZTtcbiAgICAgICAgICAgIGNvbnN0IGFjdHVhbExhc3RGcmFtZSA9IG91dEZyYW1lICE9PSBudWxsICYmIG91dEZyYW1lICE9PSB2b2lkIDAgPyBvdXRGcmFtZSA6IGNvbmZpZy5kdXJhdGlvbkluRnJhbWVzIC0gMTtcbiAgICAgICAgICAgIGNvbnN0IGFjdHVhbEZpcnN0RnJhbWUgPSBpbkZyYW1lICE9PSBudWxsICYmIGluRnJhbWUgIT09IHZvaWQgMCA/IGluRnJhbWUgOiAwO1xuICAgICAgICAgICAgY29uc3QgeyBuZXh0RnJhbWUsIGZyYW1lc1RvQWR2YW5jZSwgaGFzRW5kZWQgfSA9IGNhbGN1bGF0ZU5leHRGcmFtZSh7XG4gICAgICAgICAgICAgICAgdGltZSxcbiAgICAgICAgICAgICAgICBjdXJyZW50RnJhbWU6IGZyYW1lUmVmLmN1cnJlbnQsXG4gICAgICAgICAgICAgICAgcGxheWJhY2tTcGVlZDogcGxheWJhY2tSYXRlLFxuICAgICAgICAgICAgICAgIGZwczogY29uZmlnLmZwcyxcbiAgICAgICAgICAgICAgICBhY3R1YWxGaXJzdEZyYW1lLFxuICAgICAgICAgICAgICAgIGFjdHVhbExhc3RGcmFtZSxcbiAgICAgICAgICAgICAgICBmcmFtZXNBZHZhbmNlZCxcbiAgICAgICAgICAgICAgICBzaG91bGRMb29wOiBsb29wLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmcmFtZXNBZHZhbmNlZCArPSBmcmFtZXNUb0FkdmFuY2U7XG4gICAgICAgICAgICBpZiAobmV4dEZyYW1lICE9PSBmcmFtZVJlZi5jdXJyZW50ICYmXG4gICAgICAgICAgICAgICAgKCFoYXNFbmRlZCB8fCBtb3ZlVG9CZWdpbm5pbmdXaGVuRW5kZWQpKSB7XG4gICAgICAgICAgICAgICAgc2V0RnJhbWUoKGMpID0+ICh7IC4uLmMsIFtjb25maWcuaWRdOiBuZXh0RnJhbWUgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhhc0VuZGVkKSB7XG4gICAgICAgICAgICAgICAgc3RvcCgpO1xuICAgICAgICAgICAgICAgIHBhdXNlKCk7XG4gICAgICAgICAgICAgICAgZW1pdHRlci5kaXNwYXRjaEVuZGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFoYXNCZWVuU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgIHF1ZXVlTmV4dEZyYW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHF1ZXVlTmV4dEZyYW1lID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGlzQmFja2dyb3VuZGVkUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICByZXFBbmltRnJhbWVDYWxsID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGltZW91dCcsXG4gICAgICAgICAgICAgICAgICAgIC8vIE5vdGU6IE1vc3QgbGlrZWx5LCB0aGlzIHdpbGwgbm90IGJlIDEwMDAgLyBmcHMsIGJ1dCB0aGUgYnJvd3NlciB3aWxsIHRocm90dGxlIGl0IHRvIH4xL3NlYy5cbiAgICAgICAgICAgICAgICAgICAgaWQ6IHNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyBjb25maWcuZnBzKSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVxQW5pbUZyYW1lQ2FsbCA9IHsgdHlwZTogJ3JhZicsIGlkOiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHF1ZXVlTmV4dEZyYW1lKCk7XG4gICAgICAgIGNvbnN0IG9uVmlzaWJpbGl0eUNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT09ICd2aXNpYmxlJykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIHRhYiBnb2VzIGludG8gdGhlIGJhY2tncm91bmQsIGNhbmNlbCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKSBhbmQgdXBkYXRlIGltbWVkaWF0ZWx5LlxuICAgICAgICAgICAgLy8gLCBzbyB0aGUgdHJhbnNpdGlvbiB0byBzZXRUaW1lb3V0KCkgY2FuIGJlIGZ1bGZpbGxlZC5cbiAgICAgICAgICAgIGNhbmNlbFF1ZXVlZEZyYW1lKCk7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9O1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsIG9uVmlzaWJpbGl0eUNoYW5nZSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsIG9uVmlzaWJpbGl0eUNoYW5nZSk7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgIH07XG4gICAgfSwgW1xuICAgICAgICBjb25maWcsXG4gICAgICAgIGxvb3AsXG4gICAgICAgIHBhdXNlLFxuICAgICAgICBwbGF5aW5nLFxuICAgICAgICBzZXRGcmFtZSxcbiAgICAgICAgZW1pdHRlcixcbiAgICAgICAgcGxheWJhY2tSYXRlLFxuICAgICAgICBpbkZyYW1lLFxuICAgICAgICBvdXRGcmFtZSxcbiAgICAgICAgbW92ZVRvQmVnaW5uaW5nV2hlbkVuZGVkLFxuICAgICAgICBpc0JhY2tncm91bmRlZFJlZixcbiAgICBdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChsYXN0VGltZVVwZGF0ZUV2ZW50LmN1cnJlbnQgPT09IGZyYW1lUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbWl0dGVyLmRpc3BhdGNoVGltZVVwZGF0ZSh7IGZyYW1lOiBmcmFtZVJlZi5jdXJyZW50IH0pO1xuICAgICAgICAgICAgbGFzdFRpbWVVcGRhdGVFdmVudC5jdXJyZW50ID0gZnJhbWVSZWYuY3VycmVudDtcbiAgICAgICAgfSwgMjUwKTtcbiAgICAgICAgcmV0dXJuICgpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgIH0sIFtlbWl0dGVyXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgZW1pdHRlci5kaXNwYXRjaEZyYW1lVXBkYXRlKHsgZnJhbWUgfSk7XG4gICAgfSwgW2VtaXR0ZXIsIGZyYW1lXSk7XG59O1xuXG5sZXQgZWxlbWVudFNpemVIb29rcyA9IFtdO1xuY29uc3QgdXBkYXRlQWxsRWxlbWVudHNTaXplcyA9ICgpID0+IHtcbiAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGVsZW1lbnRTaXplSG9va3MpIHtcbiAgICAgICAgbGlzdGVuZXIoKTtcbiAgICB9XG59O1xuY29uc3QgdXNlRWxlbWVudFNpemUgPSAocmVmLCBvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgW3NpemUsIHNldFNpemVdID0gdXNlU3RhdGUoKCkgPT4ge1xuICAgICAgICBpZiAoIXJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZWN0ID0gcmVmLmN1cnJlbnQuZ2V0Q2xpZW50UmVjdHMoKTtcbiAgICAgICAgaWYgKCFyZWN0WzBdKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IHJlY3RbMF0ud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IHJlY3RbMF0uaGVpZ2h0LFxuICAgICAgICAgICAgbGVmdDogcmVjdFswXS54LFxuICAgICAgICAgICAgdG9wOiByZWN0WzBdLnksXG4gICAgICAgICAgICB3aW5kb3dTaXplOiB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQsXG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9KTtcbiAgICBjb25zdCBvYnNlcnZlciA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIFJlc2l6ZU9ic2VydmVyID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBSZXNpemVPYnNlcnZlcigoZW50cmllcykgPT4ge1xuICAgICAgICAgICAgLy8gVGhlIGNvbnRlbnRSZWN0IHJldHVybnMgdGhlIHdpZHRoIHdpdGhvdXQgYW55IGBzY2FsZSgpYCdzIGJlaW5nIGFwcGxpZWQuIFRoZSBoZWlnaHQgaXMgd3JvbmdcbiAgICAgICAgICAgIGNvbnN0IHsgY29udGVudFJlY3QsIHRhcmdldCB9ID0gZW50cmllc1swXTtcbiAgICAgICAgICAgIC8vIFRoZSBjbGllbnRSZWN0IHJldHVybnMgdGhlIHNpemUgd2l0aCBgc2NhbGUoKWAgYmVpbmcgYXBwbGllZC5cbiAgICAgICAgICAgIGNvbnN0IG5ld1NpemUgPSB0YXJnZXQuZ2V0Q2xpZW50UmVjdHMoKTtcbiAgICAgICAgICAgIGlmICghKG5ld1NpemUgPT09IG51bGwgfHwgbmV3U2l6ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmV3U2l6ZVswXSkpIHtcbiAgICAgICAgICAgICAgICBzZXRTaXplKG51bGwpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHByb2JhYmxlQ3NzUGFyZW50U2NhbGUgPSBjb250ZW50UmVjdC53aWR0aCA9PT0gMCA/IDEgOiBuZXdTaXplWzBdLndpZHRoIC8gY29udGVudFJlY3Qud2lkdGg7XG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9IG9wdGlvbnMuc2hvdWxkQXBwbHlDc3NUcmFuc2Zvcm1zXG4gICAgICAgICAgICAgICAgPyBuZXdTaXplWzBdLndpZHRoXG4gICAgICAgICAgICAgICAgOiBuZXdTaXplWzBdLndpZHRoICogKDEgLyBwcm9iYWJsZUNzc1BhcmVudFNjYWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IG9wdGlvbnMuc2hvdWxkQXBwbHlDc3NUcmFuc2Zvcm1zXG4gICAgICAgICAgICAgICAgPyBuZXdTaXplWzBdLmhlaWdodFxuICAgICAgICAgICAgICAgIDogbmV3U2l6ZVswXS5oZWlnaHQgKiAoMSAvIHByb2JhYmxlQ3NzUGFyZW50U2NhbGUpO1xuICAgICAgICAgICAgc2V0U2l6ZSh7XG4gICAgICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgICAgICAgIGxlZnQ6IG5ld1NpemVbMF0ueCxcbiAgICAgICAgICAgICAgICB0b3A6IG5ld1NpemVbMF0ueSxcbiAgICAgICAgICAgICAgICB3aW5kb3dTaXplOiB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGgsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LCBbb3B0aW9ucy5zaG91bGRBcHBseUNzc1RyYW5zZm9ybXNdKTtcbiAgICBjb25zdCB1cGRhdGVTaXplID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBpZiAoIXJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVjdCA9IHJlZi5jdXJyZW50LmdldENsaWVudFJlY3RzKCk7XG4gICAgICAgIGlmICghcmVjdFswXSkge1xuICAgICAgICAgICAgc2V0U2l6ZShudWxsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZXRTaXplKChwcmV2U3RhdGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzU2FtZSA9IHByZXZTdGF0ZSAmJlxuICAgICAgICAgICAgICAgIHByZXZTdGF0ZS53aWR0aCA9PT0gcmVjdFswXS53aWR0aCAmJlxuICAgICAgICAgICAgICAgIHByZXZTdGF0ZS5oZWlnaHQgPT09IHJlY3RbMF0uaGVpZ2h0ICYmXG4gICAgICAgICAgICAgICAgcHJldlN0YXRlLmxlZnQgPT09IHJlY3RbMF0ueCAmJlxuICAgICAgICAgICAgICAgIHByZXZTdGF0ZS50b3AgPT09IHJlY3RbMF0ueSAmJlxuICAgICAgICAgICAgICAgIHByZXZTdGF0ZS53aW5kb3dTaXplLmhlaWdodCA9PT0gd2luZG93LmlubmVySGVpZ2h0ICYmXG4gICAgICAgICAgICAgICAgcHJldlN0YXRlLndpbmRvd1NpemUud2lkdGggPT09IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICAgICAgaWYgKGlzU2FtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcmV2U3RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHdpZHRoOiByZWN0WzBdLndpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogcmVjdFswXS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgbGVmdDogcmVjdFswXS54LFxuICAgICAgICAgICAgICAgIHRvcDogcmVjdFswXS55LFxuICAgICAgICAgICAgICAgIHdpbmRvd1NpemU6IHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfSwgW3JlZl0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmICghb2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGN1cnJlbnQgfSA9IHJlZjtcbiAgICAgICAgaWYgKHJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKHJlZi5jdXJyZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlci51bm9ic2VydmUoY3VycmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSwgW29ic2VydmVyLCByZWYsIHVwZGF0ZVNpemVdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIW9wdGlvbnMudHJpZ2dlck9uV2luZG93UmVzaXplKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHVwZGF0ZVNpemUpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHVwZGF0ZVNpemUpO1xuICAgICAgICB9O1xuICAgIH0sIFtvcHRpb25zLnRyaWdnZXJPbldpbmRvd1Jlc2l6ZSwgdXBkYXRlU2l6ZV0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGVsZW1lbnRTaXplSG9va3MucHVzaCh1cGRhdGVTaXplKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGVsZW1lbnRTaXplSG9va3MgPSBlbGVtZW50U2l6ZUhvb2tzLmZpbHRlcigoZSkgPT4gZSAhPT0gdXBkYXRlU2l6ZSk7XG4gICAgICAgIH07XG4gICAgfSwgW3VwZGF0ZVNpemVdKTtcbiAgICByZXR1cm4gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGlmICghc2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgLi4uc2l6ZSwgcmVmcmVzaDogdXBkYXRlU2l6ZSB9O1xuICAgIH0sIFtzaXplLCB1cGRhdGVTaXplXSk7XG59O1xuXG5jb25zdCBQTEFZRVJfQ1NTX0NMQVNTTkFNRSA9ICdfX3JlbW90aW9uLXBsYXllcic7XG5cbmNvbnN0IGVycm9yU3R5bGUgPSB7XG4gICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICBmbGV4OiAxLFxuICAgIGhlaWdodDogJzEwMCUnLFxuICAgIHdpZHRoOiAnMTAwJScsXG59O1xuY2xhc3MgRXJyb3JCb3VuZGFyeSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7IGhhc0Vycm9yOiBudWxsIH07XG4gICAgfVxuICAgIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgLy8gVXBkYXRlIHN0YXRlIHNvIHRoZSBuZXh0IHJlbmRlciB3aWxsIHNob3cgdGhlIGZhbGxiYWNrIFVJLlxuICAgICAgICByZXR1cm4geyBoYXNFcnJvcjogZXJyb3IgfTtcbiAgICB9XG4gICAgY29tcG9uZW50RGlkQ2F0Y2goZXJyb3IpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5vbkVycm9yKGVycm9yKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5oYXNFcnJvcikge1xuICAgICAgICAgICAgLy8gWW91IGNhbiByZW5kZXIgYW55IGN1c3RvbSBmYWxsYmFjayBVSVxuICAgICAgICAgICAgcmV0dXJuIChqc3goXCJkaXZcIiwgeyBzdHlsZTogZXJyb3JTdHlsZSwgY2hpbGRyZW46IHRoaXMucHJvcHMuZXJyb3JGYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB0aGlzLnN0YXRlLmhhc0Vycm9yLFxuICAgICAgICAgICAgICAgIH0pIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5jaGlsZHJlbjtcbiAgICB9XG59XG5cbmNvbnN0IGZvcm1hdFRpbWUgPSAodGltZUluU2Vjb25kcykgPT4ge1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKHRpbWVJblNlY29uZHMgLyA2MCk7XG4gICAgY29uc3Qgc2Vjb25kcyA9IE1hdGguZmxvb3IodGltZUluU2Vjb25kcyAtIG1pbnV0ZXMgKiA2MCk7XG4gICAgcmV0dXJuIGAke1N0cmluZyhtaW51dGVzKX06JHtTdHJpbmcoc2Vjb25kcykucGFkU3RhcnQoMiwgJzAnKX1gO1xufTtcblxuY29uc3QgSUNPTl9TSVpFID0gMjU7XG5jb25zdCBmdWxsc2NyZWVuSWNvblNpemUgPSAxNjtcbmNvbnN0IFBsYXlJY29uID0gKCkgPT4ge1xuICAgIHJldHVybiAoanN4KFwic3ZnXCIsIHsgd2lkdGg6IElDT05fU0laRSwgaGVpZ2h0OiBJQ09OX1NJWkUsIHZpZXdCb3g6IFwiMCAwIDI1IDI1XCIsIGZpbGw6IFwibm9uZVwiLCB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBjaGlsZHJlbjoganN4KFwicGF0aFwiLCB7IGQ6IFwiTTggNi4zNzVDNy40MDkwNCA4LjE3NTc2IDcuMDY5MjEgMTAuMjQ4NiA3LjAxNDM4IDEyLjM4NzFDNi45NTk1NSAxNC41MjU1IDcuMTkxNjMgMTYuNjU0NyA3LjY4NzUgMTguNTYyNUM5Ljk1MzY0IDE4LjI5OTUgMTIuMTE2IDE3LjYxNjQgMTQuMDA5IDE2LjU2NTVDMTUuOTAyIDE1LjUxNDcgMTcuNDc1NSAxNC4xMjQgMTguNjA4OCAxMi41QzE3LjUxNTggMTAuODk0OSAxNS45OTQ5IDkuNTExMDMgMTQuMTU4NSA4LjQ1MDgyQzEyLjMyMjIgNy4zOTA2IDEwLjIxNzQgNi42ODExNiA4IDYuMzc1WlwiLCBmaWxsOiBcIndoaXRlXCIsIHN0cm9rZTogXCJ3aGl0ZVwiLCBzdHJva2VXaWR0aDogXCI2LjI1XCIsIHN0cm9rZUxpbmVqb2luOiBcInJvdW5kXCIgfSkgfSkpO1xufTtcbmNvbnN0IFBhdXNlSWNvbiA9ICgpID0+IHtcbiAgICByZXR1cm4gKGpzeHMoXCJzdmdcIiwgeyB2aWV3Qm94OiBcIjAgMCAxMDAgMTAwXCIsIHdpZHRoOiBJQ09OX1NJWkUsIGhlaWdodDogSUNPTl9TSVpFLCBjaGlsZHJlbjogW2pzeChcInJlY3RcIiwgeyB4OiBcIjI1XCIsIHk6IFwiMjBcIiwgd2lkdGg6IFwiMjBcIiwgaGVpZ2h0OiBcIjYwXCIsIGZpbGw6IFwiI2ZmZlwiLCByeTogXCI1XCIsIHJ4OiBcIjVcIiB9KSwganN4KFwicmVjdFwiLCB7IHg6IFwiNTVcIiwgeTogXCIyMFwiLCB3aWR0aDogXCIyMFwiLCBoZWlnaHQ6IFwiNjBcIiwgZmlsbDogXCIjZmZmXCIsIHJ5OiBcIjVcIiwgcng6IFwiNVwiIH0pXSB9KSk7XG59O1xuY29uc3QgRnVsbHNjcmVlbkljb24gPSAoeyBpc0Z1bGxzY3JlZW4sIH0pID0+IHtcbiAgICBjb25zdCBzdHJva2VXaWR0aCA9IDY7XG4gICAgY29uc3Qgdmlld1NpemUgPSAzMjtcbiAgICBjb25zdCBvdXQgPSBpc0Z1bGxzY3JlZW4gPyAwIDogc3Ryb2tlV2lkdGggLyAyO1xuICAgIGNvbnN0IG1pZGRsZUluc2V0ID0gaXNGdWxsc2NyZWVuID8gc3Ryb2tlV2lkdGggKiAxLjYgOiBzdHJva2VXaWR0aCAvIDI7XG4gICAgY29uc3QgaW5zZXQgPSBpc0Z1bGxzY3JlZW4gPyBzdHJva2VXaWR0aCAqIDEuNiA6IHN0cm9rZVdpZHRoICogMjtcbiAgICByZXR1cm4gKGpzeHMoXCJzdmdcIiwgeyB2aWV3Qm94OiBgMCAwICR7dmlld1NpemV9ICR7dmlld1NpemV9YCwgaGVpZ2h0OiBmdWxsc2NyZWVuSWNvblNpemUsIHdpZHRoOiBmdWxsc2NyZWVuSWNvblNpemUsIGNoaWxkcmVuOiBbanN4KFwicGF0aFwiLCB7IGQ6IGBcblx0XHRcdFx0TSAke291dH0gJHtpbnNldH1cblx0XHRcdFx0TCAke21pZGRsZUluc2V0fSAke21pZGRsZUluc2V0fVxuXHRcdFx0XHRMICR7aW5zZXR9ICR7b3V0fVxuXHRcdFx0XHRgLCBzdHJva2U6IFwiI2ZmZlwiLCBzdHJva2VXaWR0aDogc3Ryb2tlV2lkdGgsIGZpbGw6IFwibm9uZVwiIH0pLCBqc3goXCJwYXRoXCIsIHsgZDogYFxuXHRcdFx0XHRNICR7dmlld1NpemUgLSBvdXR9ICR7aW5zZXR9XG5cdFx0XHRcdEwgJHt2aWV3U2l6ZSAtIG1pZGRsZUluc2V0fSAke21pZGRsZUluc2V0fVxuXHRcdFx0XHRMICR7dmlld1NpemUgLSBpbnNldH0gJHtvdXR9XG5cdFx0XHRcdGAsIHN0cm9rZTogXCIjZmZmXCIsIHN0cm9rZVdpZHRoOiBzdHJva2VXaWR0aCwgZmlsbDogXCJub25lXCIgfSksIGpzeChcInBhdGhcIiwgeyBkOiBgXG5cdFx0XHRcdE0gJHtvdXR9ICR7dmlld1NpemUgLSBpbnNldH1cblx0XHRcdFx0TCAke21pZGRsZUluc2V0fSAke3ZpZXdTaXplIC0gbWlkZGxlSW5zZXR9XG5cdFx0XHRcdEwgJHtpbnNldH0gJHt2aWV3U2l6ZSAtIG91dH1cblx0XHRcdFx0YCwgc3Ryb2tlOiBcIiNmZmZcIiwgc3Ryb2tlV2lkdGg6IHN0cm9rZVdpZHRoLCBmaWxsOiBcIm5vbmVcIiB9KSwganN4KFwicGF0aFwiLCB7IGQ6IGBcblx0XHRcdFx0TSAke3ZpZXdTaXplIC0gb3V0fSAke3ZpZXdTaXplIC0gaW5zZXR9XG5cdFx0XHRcdEwgJHt2aWV3U2l6ZSAtIG1pZGRsZUluc2V0fSAke3ZpZXdTaXplIC0gbWlkZGxlSW5zZXR9XG5cdFx0XHRcdEwgJHt2aWV3U2l6ZSAtIGluc2V0fSAke3ZpZXdTaXplIC0gb3V0fVxuXHRcdFx0XHRgLCBzdHJva2U6IFwiI2ZmZlwiLCBzdHJva2VXaWR0aDogc3Ryb2tlV2lkdGgsIGZpbGw6IFwibm9uZVwiIH0pXSB9KSk7XG59O1xuY29uc3QgVm9sdW1lT2ZmSWNvbiA9ICgpID0+IHtcbiAgICByZXR1cm4gKGpzeChcInN2Z1wiLCB7IHdpZHRoOiBJQ09OX1NJWkUsIGhlaWdodDogSUNPTl9TSVpFLCB2aWV3Qm94OiBcIjAgMCAyNCAyNFwiLCBjaGlsZHJlbjoganN4KFwicGF0aFwiLCB7IGQ6IFwiTTMuNjMgMy42M2EuOTk2Ljk5NiAwIDAwMCAxLjQxTDcuMjkgOC43IDcgOUg0Yy0uNTUgMC0xIC40NS0xIDF2NGMwIC41NS40NSAxIDEgMWgzbDMuMjkgMy4yOWMuNjMuNjMgMS43MS4xOCAxLjcxLS43MXYtNC4xN2w0LjE4IDQuMThjLS40OS4zNy0xLjAyLjY4LTEuNi45MS0uMzYuMTUtLjU4LjUzLS41OC45MiAwIC43Mi43MyAxLjE4IDEuMzkuOTEuOC0uMzMgMS41NS0uNzcgMi4yMi0xLjMxbDEuMzQgMS4zNGEuOTk2Ljk5NiAwIDEwMS40MS0xLjQxTDUuMDUgMy42M2MtLjM5LS4zOS0xLjAyLS4zOS0xLjQyIDB6TTE5IDEyYzAgLjgyLS4xNSAxLjYxLS40MSAyLjM0bDEuNTMgMS41M2MuNTYtMS4xNy44OC0yLjQ4Ljg4LTMuODcgMC0zLjgzLTIuNC03LjExLTUuNzgtOC40LS41OS0uMjMtMS4yMi4yMy0xLjIyLjg2di4xOWMwIC4zOC4yNS43MS42MS44NUMxNy4xOCA2LjU0IDE5IDkuMDYgMTkgMTJ6bS04LjcxLTYuMjlsLS4xNy4xN0wxMiA3Ljc2VjYuNDFjMC0uODktMS4wOC0xLjMzLTEuNzEtLjd6TTE2LjUgMTJBNC41IDQuNSAwIDAwMTQgNy45N3YxLjc5bDIuNDggMi40OGMuMDEtLjA4LjAyLS4xNi4wMi0uMjR6XCIsIGZpbGw6IFwiI2ZmZlwiIH0pIH0pKTtcbn07XG5jb25zdCBWb2x1bWVPbkljb24gPSAoKSA9PiB7XG4gICAgcmV0dXJuIChqc3goXCJzdmdcIiwgeyB3aWR0aDogSUNPTl9TSVpFLCBoZWlnaHQ6IElDT05fU0laRSwgdmlld0JveDogXCIwIDAgMjQgMjRcIiwgY2hpbGRyZW46IGpzeChcInBhdGhcIiwgeyBkOiBcIk0zIDEwdjRjMCAuNTUuNDUgMSAxIDFoM2wzLjI5IDMuMjljLjYzLjYzIDEuNzEuMTggMS43MS0uNzFWNi40MWMwLS44OS0xLjA4LTEuMzQtMS43MS0uNzFMNyA5SDRjLS41NSAwLTEgLjQ1LTEgMXptMTMuNSAyQTQuNSA0LjUgMCAwMDE0IDcuOTd2OC4wNWMxLjQ4LS43MyAyLjUtMi4yNSAyLjUtNC4wMnpNMTQgNC40NXYuMmMwIC4zOC4yNS43MS42Ljg1QzE3LjE4IDYuNTMgMTkgOS4wNiAxOSAxMnMtMS44MiA1LjQ3LTQuNCA2LjVjLS4zNi4xNC0uNi40Ny0uNi44NXYuMmMwIC42My42MyAxLjA3IDEuMjEuODVDMTguNiAxOS4xMSAyMSAxNS44NCAyMSAxMnMtMi40LTcuMTEtNS43OS04LjRjLS41OC0uMjMtMS4yMS4yMi0xLjIxLjg1elwiLCBmaWxsOiBcIiNmZmZcIiB9KSB9KSk7XG59O1xuXG5jb25zdCBCQVJfSEVJR0hUJDEgPSA1O1xuY29uc3QgS05PQl9TSVpFJDEgPSAxMjtcbmNvbnN0IFZPTFVNRV9TTElERVJfV0lEVEggPSAxMDA7XG5jb25zdCBNZWRpYVZvbHVtZVNsaWRlciA9ICh7IGRpc3BsYXlWZXJ0aWNhbFZvbHVtZVNsaWRlciB9KSA9PiB7XG4gICAgY29uc3QgW21lZGlhTXV0ZWQsIHNldE1lZGlhTXV0ZWRdID0gSW50ZXJuYWxzLnVzZU1lZGlhTXV0ZWRTdGF0ZSgpO1xuICAgIGNvbnN0IFttZWRpYVZvbHVtZSwgc2V0TWVkaWFWb2x1bWVdID0gSW50ZXJuYWxzLnVzZU1lZGlhVm9sdW1lU3RhdGUoKTtcbiAgICBjb25zdCBbZm9jdXNlZCwgc2V0Rm9jdXNlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgcGFyZW50RGl2UmVmID0gdXNlUmVmKG51bGwpO1xuICAgIGNvbnN0IGlucHV0UmVmID0gdXNlUmVmKG51bGwpO1xuICAgIGNvbnN0IGhvdmVyID0gdXNlSG92ZXJTdGF0ZShwYXJlbnREaXZSZWYpO1xuICAgIC8vIE5lZWQgdG8gaW1wb3J0IGl0IGZyb20gUmVhY3QgdG8gZml4IFJlYWN0IDE3IEVTTSBzdXBwb3J0LlxuICAgIGNvbnN0IHJhbmRvbUlkID0gXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gICAgdHlwZW9mIFJlYWN0LnVzZUlkID09PSAndW5kZWZpbmVkJyA/ICd2b2x1bWUtc2xpZGVyJyA6IFJlYWN0LnVzZUlkKCk7XG4gICAgY29uc3QgW3JhbmRvbUNsYXNzXSA9IHVzZVN0YXRlKCgpID0+IGBfX3JlbW90aW9uLXZvbHVtZS1zbGlkZXItJHtyYW5kb20ocmFuZG9tSWQpfWAucmVwbGFjZSgnLicsICcnKSk7XG4gICAgY29uc3QgaXNNdXRlZE9yWmVybyA9IG1lZGlhTXV0ZWQgfHwgbWVkaWFWb2x1bWUgPT09IDA7XG4gICAgY29uc3Qgb25Wb2x1bWVDaGFuZ2UgPSAoZSkgPT4ge1xuICAgICAgICBzZXRNZWRpYVZvbHVtZShwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSk7XG4gICAgfTtcbiAgICBjb25zdCBvbkJsdXIgPSAoKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgLy8gV2UgbmVlZCBhIHNtYWxsIGRlbGF5IHRvIGNoZWNrIHdoaWNoIGVsZW1lbnQgd2FzIGZvY3VzZWQgbmV4dCxcbiAgICAgICAgICAgIC8vIGFuZCBpZiBpdCB3YXNuJ3QgdGhlIHZvbHVtZSBzbGlkZXIsIHdlIGhpZGUgaXRcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9PSBpbnB1dFJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgc2V0Rm9jdXNlZChmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDEwKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uQ2xpY2sgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIGlmIChtZWRpYVZvbHVtZSA9PT0gMCkge1xuICAgICAgICAgICAgc2V0TWVkaWFWb2x1bWUoMSk7XG4gICAgICAgICAgICBzZXRNZWRpYU11dGVkKGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZXRNZWRpYU11dGVkKChtdXRlKSA9PiAhbXV0ZSk7XG4gICAgfSwgW21lZGlhVm9sdW1lLCBzZXRNZWRpYU11dGVkLCBzZXRNZWRpYVZvbHVtZV0pO1xuICAgIGNvbnN0IHBhcmVudERpdlN0eWxlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkaXNwbGF5OiAnaW5saW5lLWZsZXgnLFxuICAgICAgICAgICAgYmFja2dyb3VuZDogJ25vbmUnLFxuICAgICAgICAgICAgYm9yZGVyOiAnbm9uZScsXG4gICAgICAgICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gICAgICAgICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICAgICAgICAgIHRvdWNoQWN0aW9uOiAnbm9uZScsXG4gICAgICAgICAgICAuLi4oZGlzcGxheVZlcnRpY2FsVm9sdW1lU2xpZGVyICYmIHsgcG9zaXRpb246ICdyZWxhdGl2ZScgfSksXG4gICAgICAgIH07XG4gICAgfSwgW2Rpc3BsYXlWZXJ0aWNhbFZvbHVtZVNsaWRlcl0pO1xuICAgIGNvbnN0IHZvbHVtZUNvbnRhaW5lciA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGlzcGxheTogJ2lubGluZScsXG4gICAgICAgICAgICB3aWR0aDogSUNPTl9TSVpFLFxuICAgICAgICAgICAgaGVpZ2h0OiBJQ09OX1NJWkUsXG4gICAgICAgICAgICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgICAgICAgICAgIGFwcGVhcmFuY2U6ICdub25lJyxcbiAgICAgICAgICAgIGJhY2tncm91bmQ6ICdub25lJyxcbiAgICAgICAgICAgIGJvcmRlcjogJ25vbmUnLFxuICAgICAgICAgICAgcGFkZGluZzogMCxcbiAgICAgICAgfTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgaW5wdXRTdHlsZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBjb25zdCBjb21tb25TdHlsZSA9IHtcbiAgICAgICAgICAgIFdlYmtpdEFwcGVhcmFuY2U6ICdub25lJyxcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC41KScsXG4gICAgICAgICAgICBib3JkZXJSYWRpdXM6IEJBUl9IRUlHSFQkMSAvIDIsXG4gICAgICAgICAgICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgICAgICAgICAgIGhlaWdodDogQkFSX0hFSUdIVCQxLFxuICAgICAgICAgICAgd2lkdGg6IFZPTFVNRV9TTElERVJfV0lEVEgsXG4gICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6IGBsaW5lYXItZ3JhZGllbnQoXG5cdFx0XHRcdHRvIHJpZ2h0LFxuXHRcdFx0XHR3aGl0ZSAke21lZGlhVm9sdW1lICogMTAwfSUsIHJnYmEoMjU1LCAyNTUsIDI1NSwgMCkgJHttZWRpYVZvbHVtZSAqIDEwMH0lXG5cdFx0XHQpYCxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGRpc3BsYXlWZXJ0aWNhbFZvbHVtZVNsaWRlcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAuLi5jb21tb25TdHlsZSxcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IGByb3RhdGUoLTkwZGVnKWAsXG4gICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgICAgICAgICAgYm90dG9tOiBJQ09OX1NJWkUgKyBWT0xVTUVfU0xJREVSX1dJRFRIIC8gMiArIDUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5jb21tb25TdHlsZSxcbiAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDUsXG4gICAgICAgIH07XG4gICAgfSwgW2Rpc3BsYXlWZXJ0aWNhbFZvbHVtZVNsaWRlciwgbWVkaWFWb2x1bWVdKTtcbiAgICBjb25zdCBzbGlkZXJTdHlsZSA9IGBcblx0LiR7cmFuZG9tQ2xhc3N9Ojotd2Via2l0LXNsaWRlci10aHVtYiB7XG5cdFx0LXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xuXHRcdGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuXHRcdGJvcmRlci1yYWRpdXM6ICR7S05PQl9TSVpFJDEgLyAyfXB4O1xuXHRcdGJveC1zaGFkb3c6IDAgMCAycHggYmxhY2s7XG5cdFx0aGVpZ2h0OiAke0tOT0JfU0laRSQxfXB4O1xuXHRcdHdpZHRoOiAke0tOT0JfU0laRSQxfXB4O1xuXHR9XG5cblx0LiR7cmFuZG9tQ2xhc3N9OjotbW96LXJhbmdlLXRodW1iIHtcblx0XHQtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7XG5cdFx0YmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG5cdFx0Ym9yZGVyLXJhZGl1czogJHtLTk9CX1NJWkUkMSAvIDJ9cHg7XG5cdFx0Ym94LXNoYWRvdzogMCAwIDJweCBibGFjaztcblx0XHRoZWlnaHQ6ICR7S05PQl9TSVpFJDF9cHg7XG5cdFx0d2lkdGg6ICR7S05PQl9TSVpFJDF9cHg7XG5cdH1cbmA7XG4gICAgcmV0dXJuIChqc3hzKFwiZGl2XCIsIHsgcmVmOiBwYXJlbnREaXZSZWYsIHN0eWxlOiBwYXJlbnREaXZTdHlsZSwgY2hpbGRyZW46IFtqc3goXCJzdHlsZVwiLCB7IFxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9uby1kYW5nZXJcbiAgICAgICAgICAgICAgICBkYW5nZXJvdXNseVNldElubmVySFRNTDoge1xuICAgICAgICAgICAgICAgICAgICBfX2h0bWw6IHNsaWRlclN0eWxlLFxuICAgICAgICAgICAgICAgIH0gfSksIGpzeChcImJ1dHRvblwiLCB7IFwiYXJpYS1sYWJlbFwiOiBpc011dGVkT3JaZXJvID8gJ1VubXV0ZSBzb3VuZCcgOiAnTXV0ZSBzb3VuZCcsIHRpdGxlOiBpc011dGVkT3JaZXJvID8gJ1VubXV0ZSBzb3VuZCcgOiAnTXV0ZSBzb3VuZCcsIG9uQ2xpY2s6IG9uQ2xpY2ssIG9uQmx1cjogb25CbHVyLCBvbkZvY3VzOiAoKSA9PiBzZXRGb2N1c2VkKHRydWUpLCBzdHlsZTogdm9sdW1lQ29udGFpbmVyLCB0eXBlOiBcImJ1dHRvblwiLCBjaGlsZHJlbjogaXNNdXRlZE9yWmVybyA/IGpzeChWb2x1bWVPZmZJY29uLCB7fSkgOiBqc3goVm9sdW1lT25JY29uLCB7fSkgfSksIChmb2N1c2VkIHx8IGhvdmVyKSAmJiAhbWVkaWFNdXRlZCAmJiAhSW50ZXJuYWxzLmlzSW9zU2FmYXJpKCkgPyAoanN4KFwiaW5wdXRcIiwgeyByZWY6IGlucHV0UmVmLCBcImFyaWEtbGFiZWxcIjogXCJDaGFuZ2Ugdm9sdW1lXCIsIGNsYXNzTmFtZTogcmFuZG9tQ2xhc3MsIG1heDogMSwgbWluOiAwLCBvbkJsdXI6ICgpID0+IHNldEZvY3VzZWQoZmFsc2UpLCBvbkNoYW5nZTogb25Wb2x1bWVDaGFuZ2UsIHN0ZXA6IDAuMDEsIHR5cGU6IFwicmFuZ2VcIiwgdmFsdWU6IG1lZGlhVm9sdW1lLCBzdHlsZTogaW5wdXRTdHlsZSB9KSkgOiBudWxsXSB9KSk7XG59O1xuXG4vLyBob29rIHRvIGhpZGUgYSBwb3B1cC9tb2RhbCB3aGVuIGNsaWNrZWQgb3V0c2lkZVxuZnVuY3Rpb24gdXNlQ29tcG9uZW50VmlzaWJsZShpbml0aWFsSXNWaXNpYmxlKSB7XG4gICAgY29uc3QgW2lzQ29tcG9uZW50VmlzaWJsZSwgc2V0SXNDb21wb25lbnRWaXNpYmxlXSA9IHVzZVN0YXRlKGluaXRpYWxJc1Zpc2libGUpO1xuICAgIGNvbnN0IHJlZiA9IHVzZVJlZihudWxsKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBoYW5kbGVDbGlja091dHNpZGUgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChyZWYuY3VycmVudCAmJiAhcmVmLmN1cnJlbnQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIHNldElzQ29tcG9uZW50VmlzaWJsZShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIGhhbmRsZUNsaWNrT3V0c2lkZSwgdHJ1ZSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCBoYW5kbGVDbGlja091dHNpZGUsIHRydWUpO1xuICAgICAgICB9O1xuICAgIH0sIFtdKTtcbiAgICByZXR1cm4geyByZWYsIGlzQ29tcG9uZW50VmlzaWJsZSwgc2V0SXNDb21wb25lbnRWaXNpYmxlIH07XG59XG5cbi8vIFRvIGFsaWduXG5jb25zdCBCT1RUT00gPSAzNTtcbi8vIEFyYml0cmFyeSB0byBjbGFtcCB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cFxuY29uc3QgVEhSRVNIT0xEID0gNzA7XG5jb25zdCByYXRlRGl2ID0ge1xuICAgIGhlaWdodDogMzAsXG4gICAgcGFkZGluZ1JpZ2h0OiAxNSxcbiAgICBwYWRkaW5nTGVmdDogMTIsXG4gICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxufTtcbmNvbnN0IGNoZWNrbWFya0NvbnRhaW5lciA9IHtcbiAgICB3aWR0aDogMjIsXG4gICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxufTtcbmNvbnN0IGNoZWNrbWFya1N0eWxlID0ge1xuICAgIHdpZHRoOiAxNCxcbiAgICBoZWlnaHQ6IDE0LFxuICAgIGNvbG9yOiAnYmxhY2snLFxufTtcbmNvbnN0IENoZWNrbWFyayA9ICgpID0+IChqc3goXCJzdmdcIiwgeyB2aWV3Qm94OiBcIjAgMCA1MTIgNTEyXCIsIHN0eWxlOiBjaGVja21hcmtTdHlsZSwgY2hpbGRyZW46IGpzeChcInBhdGhcIiwgeyBmaWxsOiBcImN1cnJlbnRDb2xvclwiLCBkOiBcIk00MzUuODQ4IDgzLjQ2NkwxNzIuODA0IDM0Ni41MWwtOTYuNjUyLTk2LjY1MmMtNC42ODYtNC42ODYtMTIuMjg0LTQuNjg2LTE2Ljk3MSAwbC0yOC4yODQgMjguMjg0Yy00LjY4NiA0LjY4Ni00LjY4NiAxMi4yODQgMCAxNi45NzFsMTMzLjQyMSAxMzMuNDIxYzQuNjg2IDQuNjg2IDEyLjI4NCA0LjY4NiAxNi45NzEgMGwyOTkuODEzLTI5OS44MTNjNC42ODYtNC42ODYgNC42ODYtMTIuMjg0IDAtMTYuOTcxbC0yOC4yODQtMjguMjg0Yy00LjY4Ni00LjY4Ni0xMi4yODQtNC42ODYtMTYuOTcgMHpcIiB9KSB9KSk7XG5jb25zdCBQbGF5YmFja3JhdGVPcHRpb24gPSAoeyByYXRlLCBvblNlbGVjdCwgc2VsZWN0ZWRSYXRlLCBrZXlib2FyZFNlbGVjdGVkUmF0ZSB9KSA9PiB7XG4gICAgY29uc3Qgb25DbGljayA9IHVzZUNhbGxiYWNrKChlKSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgb25TZWxlY3QocmF0ZSk7XG4gICAgfSwgW29uU2VsZWN0LCByYXRlXSk7XG4gICAgY29uc3QgW2hvdmVyZWQsIHNldEhvdmVyZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IG9uTW91c2VFbnRlciA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgc2V0SG92ZXJlZCh0cnVlKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3Qgb25Nb3VzZUxlYXZlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBzZXRIb3ZlcmVkKGZhbHNlKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgYWN0dWFsU3R5bGUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnJhdGVEaXYsXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGhvdmVyZWQgfHwga2V5Ym9hcmRTZWxlY3RlZFJhdGUgPT09IHJhdGUgPyAnI2VlZScgOiAndHJhbnNwYXJlbnQnLFxuICAgICAgICB9O1xuICAgIH0sIFtob3ZlcmVkLCBrZXlib2FyZFNlbGVjdGVkUmF0ZSwgcmF0ZV0pO1xuICAgIHJldHVybiAoanN4cyhcImRpdlwiLCB7IG9uTW91c2VFbnRlcjogb25Nb3VzZUVudGVyLCBvbk1vdXNlTGVhdmU6IG9uTW91c2VMZWF2ZSwgdGFiSW5kZXg6IDAsIHN0eWxlOiBhY3R1YWxTdHlsZSwgb25DbGljazogb25DbGljaywgY2hpbGRyZW46IFtqc3goXCJkaXZcIiwgeyBzdHlsZTogY2hlY2ttYXJrQ29udGFpbmVyLCBjaGlsZHJlbjogcmF0ZSA9PT0gc2VsZWN0ZWRSYXRlID8ganN4KENoZWNrbWFyaywge30pIDogbnVsbCB9KSwgcmF0ZS50b0ZpeGVkKDEpLCBcInhcIl0gfSwgcmF0ZSkpO1xufTtcbmNvbnN0IFBsYXliYWNrUG9wdXAgPSAoeyBzZXRJc0NvbXBvbmVudFZpc2libGUsIHBsYXliYWNrUmF0ZXMsIGNhbnZhc1NpemUgfSkgPT4ge1xuICAgIGNvbnN0IHsgc2V0UGxheWJhY2tSYXRlLCBwbGF5YmFja1JhdGUgfSA9IHVzZUNvbnRleHQoSW50ZXJuYWxzLlRpbWVsaW5lLlRpbWVsaW5lQ29udGV4dCk7XG4gICAgY29uc3QgW2tleWJvYXJkU2VsZWN0ZWRSYXRlLCBzZXRLZXlib2FyZFNlbGVjdGVkUmF0ZV0gPSB1c2VTdGF0ZShwbGF5YmFja1JhdGUpO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IGxpc3RlbmVyID0gKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0Fycm93VXAnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gcGxheWJhY2tSYXRlcy5maW5kSW5kZXgoKHJhdGUpID0+IHJhdGUgPT09IGtleWJvYXJkU2VsZWN0ZWRSYXRlKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0S2V5Ym9hcmRTZWxlY3RlZFJhdGUocGxheWJhY2tSYXRlc1swXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZXRLZXlib2FyZFNlbGVjdGVkUmF0ZShwbGF5YmFja1JhdGVzW2N1cnJlbnRJbmRleCAtIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBwbGF5YmFja1JhdGVzLmZpbmRJbmRleCgocmF0ZSkgPT4gcmF0ZSA9PT0ga2V5Ym9hcmRTZWxlY3RlZFJhdGUpO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SW5kZXggPT09IHBsYXliYWNrUmF0ZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldEtleWJvYXJkU2VsZWN0ZWRSYXRlKHBsYXliYWNrUmF0ZXNbcGxheWJhY2tSYXRlcy5sZW5ndGggLSAxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZXRLZXlib2FyZFNlbGVjdGVkUmF0ZShwbGF5YmFja1JhdGVzW2N1cnJlbnRJbmRleCArIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICAgIHNldFBsYXliYWNrUmF0ZShrZXlib2FyZFNlbGVjdGVkUmF0ZSk7XG4gICAgICAgICAgICAgICAgc2V0SXNDb21wb25lbnRWaXNpYmxlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBsaXN0ZW5lcik7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGxpc3RlbmVyKTtcbiAgICAgICAgfTtcbiAgICB9LCBbXG4gICAgICAgIHBsYXliYWNrUmF0ZXMsXG4gICAgICAgIGtleWJvYXJkU2VsZWN0ZWRSYXRlLFxuICAgICAgICBzZXRQbGF5YmFja1JhdGUsXG4gICAgICAgIHNldElzQ29tcG9uZW50VmlzaWJsZSxcbiAgICBdKTtcbiAgICBjb25zdCBvblNlbGVjdCA9IHVzZUNhbGxiYWNrKChyYXRlKSA9PiB7XG4gICAgICAgIHNldFBsYXliYWNrUmF0ZShyYXRlKTtcbiAgICAgICAgc2V0SXNDb21wb25lbnRWaXNpYmxlKGZhbHNlKTtcbiAgICB9LCBbc2V0SXNDb21wb25lbnRWaXNpYmxlLCBzZXRQbGF5YmFja1JhdGVdKTtcbiAgICBjb25zdCBwbGF5YmFja1BvcHVwID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgIHJpZ2h0OiAwLFxuICAgICAgICAgICAgd2lkdGg6IDEyNSxcbiAgICAgICAgICAgIG1heEhlaWdodDogY2FudmFzU2l6ZS5oZWlnaHQgLSBUSFJFU0hPTEQgLSBCT1RUT00sXG4gICAgICAgICAgICBib3R0b206IDM1LFxuICAgICAgICAgICAgYmFja2dyb3VuZDogJyNmZmYnLFxuICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiA0LFxuICAgICAgICAgICAgb3ZlcmZsb3c6ICdhdXRvJyxcbiAgICAgICAgICAgIGNvbG9yOiAnYmxhY2snLFxuICAgICAgICAgICAgdGV4dEFsaWduOiAnbGVmdCcsXG4gICAgICAgIH07XG4gICAgfSwgW2NhbnZhc1NpemUuaGVpZ2h0XSk7XG4gICAgcmV0dXJuIChqc3goXCJkaXZcIiwgeyBzdHlsZTogcGxheWJhY2tQb3B1cCwgY2hpbGRyZW46IHBsYXliYWNrUmF0ZXMubWFwKChyYXRlKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKGpzeChQbGF5YmFja3JhdGVPcHRpb24sIHsgc2VsZWN0ZWRSYXRlOiBwbGF5YmFja1JhdGUsIG9uU2VsZWN0OiBvblNlbGVjdCwgcmF0ZTogcmF0ZSwga2V5Ym9hcmRTZWxlY3RlZFJhdGU6IGtleWJvYXJkU2VsZWN0ZWRSYXRlIH0sIHJhdGUpKTtcbiAgICAgICAgfSkgfSkpO1xufTtcbmNvbnN0IGxhYmVsID0ge1xuICAgIGZvbnRTaXplOiAxMyxcbiAgICBmb250V2VpZ2h0OiAnYm9sZCcsXG4gICAgY29sb3I6ICd3aGl0ZScsXG4gICAgYm9yZGVyOiAnMnB4IHNvbGlkIHdoaXRlJyxcbiAgICBib3JkZXJSYWRpdXM6IDIwLFxuICAgIHBhZGRpbmdMZWZ0OiA4LFxuICAgIHBhZGRpbmdSaWdodDogOCxcbiAgICBwYWRkaW5nVG9wOiAyLFxuICAgIHBhZGRpbmdCb3R0b206IDIsXG59O1xuY29uc3QgcGxheWVyQnV0dG9uU3R5bGUgPSB7XG4gICAgYXBwZWFyYW5jZTogJ25vbmUnLFxuICAgIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICBib3JkZXI6ICdub25lJyxcbiAgICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgICBwYWRkaW5nTGVmdDogMCxcbiAgICBwYWRkaW5nUmlnaHQ6IDAsXG4gICAgcGFkZGluZ1RvcDogNixcbiAgICBwYWRkaW5nQm90dG9tOiA2LFxuICAgIGhlaWdodDogMzcsXG4gICAgZGlzcGxheTogJ2lubGluZS1mbGV4JyxcbiAgICBtYXJnaW5Cb3R0b206IDAsXG4gICAgbWFyZ2luVG9wOiAwLFxuICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxufTtcbmNvbnN0IGJ1dHRvbiA9IHtcbiAgICAuLi5wbGF5ZXJCdXR0b25TdHlsZSxcbiAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbn07XG5jb25zdCBQbGF5YmFja3JhdGVDb250cm9sID0gKHsgcGxheWJhY2tSYXRlcywgY2FudmFzU2l6ZSB9KSA9PiB7XG4gICAgY29uc3QgeyByZWYsIGlzQ29tcG9uZW50VmlzaWJsZSwgc2V0SXNDb21wb25lbnRWaXNpYmxlIH0gPSB1c2VDb21wb25lbnRWaXNpYmxlKGZhbHNlKTtcbiAgICBjb25zdCB7IHBsYXliYWNrUmF0ZSB9ID0gdXNlQ29udGV4dChJbnRlcm5hbHMuVGltZWxpbmUuVGltZWxpbmVDb250ZXh0KTtcbiAgICBjb25zdCBvbkNsaWNrID0gdXNlQ2FsbGJhY2soKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzZXRJc0NvbXBvbmVudFZpc2libGUoIWlzQ29tcG9uZW50VmlzaWJsZSk7XG4gICAgfSwgW2lzQ29tcG9uZW50VmlzaWJsZSwgc2V0SXNDb21wb25lbnRWaXNpYmxlXSk7XG4gICAgcmV0dXJuIChqc3goXCJkaXZcIiwgeyByZWY6IHJlZiwgY2hpbGRyZW46IGpzeHMoXCJidXR0b25cIiwgeyB0eXBlOiBcImJ1dHRvblwiLCBcImFyaWEtbGFiZWxcIjogXCJDaGFuZ2UgcGxheWJhY2sgcmF0ZVwiLCBzdHlsZTogYnV0dG9uLCBvbkNsaWNrOiBvbkNsaWNrLCBjaGlsZHJlbjogW2pzeHMoXCJkaXZcIiwgeyBzdHlsZTogbGFiZWwsIGNoaWxkcmVuOiBbcGxheWJhY2tSYXRlLCBcInhcIl0gfSksIGlzQ29tcG9uZW50VmlzaWJsZSAmJiAoanN4KFBsYXliYWNrUG9wdXAsIHsgY2FudmFzU2l6ZTogY2FudmFzU2l6ZSwgcGxheWJhY2tSYXRlczogcGxheWJhY2tSYXRlcywgc2V0SXNDb21wb25lbnRWaXNpYmxlOiBzZXRJc0NvbXBvbmVudFZpc2libGUgfSkpXSB9KSB9KSk7XG59O1xuXG5jb25zdCBnZXRGcmFtZUZyb21YID0gKGNsaWVudFgsIGR1cmF0aW9uSW5GcmFtZXMsIHdpZHRoKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IHBvcyA9IGNsaWVudFg7XG4gICAgY29uc3QgZnJhbWUgPSBNYXRoLnJvdW5kKGludGVycG9sYXRlKHBvcywgWzAsIHdpZHRoXSwgWzAsIChfYSA9IGR1cmF0aW9uSW5GcmFtZXMgLSAxKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAwXSwge1xuICAgICAgICBleHRyYXBvbGF0ZUxlZnQ6ICdjbGFtcCcsXG4gICAgICAgIGV4dHJhcG9sYXRlUmlnaHQ6ICdjbGFtcCcsXG4gICAgfSkpO1xuICAgIHJldHVybiBmcmFtZTtcbn07XG5jb25zdCBCQVJfSEVJR0hUID0gNTtcbmNvbnN0IEtOT0JfU0laRSA9IDEyO1xuY29uc3QgVkVSVElDQUxfUEFERElORyA9IDQ7XG5jb25zdCBjb250YWluZXJTdHlsZSQxID0ge1xuICAgIHVzZXJTZWxlY3Q6ICdub25lJyxcbiAgICBwYWRkaW5nVG9wOiBWRVJUSUNBTF9QQURESU5HLFxuICAgIHBhZGRpbmdCb3R0b206IFZFUlRJQ0FMX1BBRERJTkcsXG4gICAgYm94U2l6aW5nOiAnYm9yZGVyLWJveCcsXG4gICAgY3Vyc29yOiAncG9pbnRlcicsXG4gICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgdG91Y2hBY3Rpb246ICdub25lJyxcbn07XG5jb25zdCBiYXJCYWNrZ3JvdW5kID0ge1xuICAgIGhlaWdodDogQkFSX0hFSUdIVCxcbiAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMjUpJyxcbiAgICB3aWR0aDogJzEwMCUnLFxuICAgIGJvcmRlclJhZGl1czogQkFSX0hFSUdIVCAvIDIsXG59O1xuY29uc3QgZmluZEJvZHlJbldoaWNoRGl2SXNMb2NhdGVkID0gKGRpdikgPT4ge1xuICAgIGxldCBjdXJyZW50ID0gZGl2O1xuICAgIHdoaWxlIChjdXJyZW50LnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50RWxlbWVudDtcbiAgICB9XG4gICAgcmV0dXJuIGN1cnJlbnQ7XG59O1xuY29uc3QgUGxheWVyU2Vla0JhciA9ICh7IGR1cmF0aW9uSW5GcmFtZXMsIG9uU2Vla0VuZCwgb25TZWVrU3RhcnQsIGluRnJhbWUsIG91dEZyYW1lIH0pID0+IHtcbiAgICBjb25zdCBjb250YWluZXJSZWYgPSB1c2VSZWYobnVsbCk7XG4gICAgY29uc3QgYmFySG92ZXJlZCA9IHVzZUhvdmVyU3RhdGUoY29udGFpbmVyUmVmKTtcbiAgICBjb25zdCBzaXplID0gdXNlRWxlbWVudFNpemUoY29udGFpbmVyUmVmLCB7XG4gICAgICAgIHRyaWdnZXJPbldpbmRvd1Jlc2l6ZTogdHJ1ZSxcbiAgICAgICAgc2hvdWxkQXBwbHlDc3NUcmFuc2Zvcm1zOiB0cnVlLFxuICAgIH0pO1xuICAgIGNvbnN0IHsgc2VlaywgcGxheSwgcGF1c2UsIHBsYXlpbmcgfSA9IHVzZVBsYXllcigpO1xuICAgIGNvbnN0IGZyYW1lID0gSW50ZXJuYWxzLlRpbWVsaW5lLnVzZVRpbWVsaW5lUG9zaXRpb24oKTtcbiAgICBjb25zdCBbZHJhZ2dpbmcsIHNldERyYWdnaW5nXSA9IHVzZVN0YXRlKHtcbiAgICAgICAgZHJhZ2dpbmc6IGZhbHNlLFxuICAgIH0pO1xuICAgIGNvbnN0IG9uUG9pbnRlckRvd24gPSB1c2VDYWxsYmFjaygoZSkgPT4ge1xuICAgICAgICBpZiAoIXNpemUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGxheWVyIGhhcyBubyBzaXplJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgX2ZyYW1lID0gZ2V0RnJhbWVGcm9tWChlLmNsaWVudFggLSBzaXplLmxlZnQsIGR1cmF0aW9uSW5GcmFtZXMsIHNpemUud2lkdGgpO1xuICAgICAgICBwYXVzZSgpO1xuICAgICAgICBzZWVrKF9mcmFtZSk7XG4gICAgICAgIHNldERyYWdnaW5nKHtcbiAgICAgICAgICAgIGRyYWdnaW5nOiB0cnVlLFxuICAgICAgICAgICAgd2FzUGxheWluZzogcGxheWluZyxcbiAgICAgICAgfSk7XG4gICAgICAgIG9uU2Vla1N0YXJ0KCk7XG4gICAgfSwgW3NpemUsIGR1cmF0aW9uSW5GcmFtZXMsIHBhdXNlLCBzZWVrLCBwbGF5aW5nLCBvblNlZWtTdGFydF0pO1xuICAgIGNvbnN0IG9uUG9pbnRlck1vdmUgPSB1c2VDYWxsYmFjaygoZSkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICghc2l6ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQbGF5ZXIgaGFzIG5vIHNpemUnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRyYWdnaW5nLmRyYWdnaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgX2ZyYW1lID0gZ2V0RnJhbWVGcm9tWChlLmNsaWVudFggLSAoKF9hID0gc2l6ZSA9PT0gbnVsbCB8fCBzaXplID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaXplLmxlZnQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDApLCBkdXJhdGlvbkluRnJhbWVzLCBzaXplLndpZHRoKTtcbiAgICAgICAgc2VlayhfZnJhbWUpO1xuICAgIH0sIFtkcmFnZ2luZy5kcmFnZ2luZywgZHVyYXRpb25JbkZyYW1lcywgc2Vlaywgc2l6ZV0pO1xuICAgIGNvbnN0IG9uUG9pbnRlclVwID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBzZXREcmFnZ2luZyh7XG4gICAgICAgICAgICBkcmFnZ2luZzogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIWRyYWdnaW5nLmRyYWdnaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRyYWdnaW5nLndhc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHBsYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHBhdXNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgb25TZWVrRW5kKCk7XG4gICAgfSwgW2RyYWdnaW5nLCBvblNlZWtFbmQsIHBhdXNlLCBwbGF5XSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFkcmFnZ2luZy5kcmFnZ2luZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJvZHkgPSBmaW5kQm9keUluV2hpY2hEaXZJc0xvY2F0ZWQoY29udGFpbmVyUmVmLmN1cnJlbnQpO1xuICAgICAgICBib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgb25Qb2ludGVyTW92ZSk7XG4gICAgICAgIGJvZHkuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgb25Qb2ludGVyVXApO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIG9uUG9pbnRlck1vdmUpO1xuICAgICAgICAgICAgYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCBvblBvaW50ZXJVcCk7XG4gICAgICAgIH07XG4gICAgfSwgW2RyYWdnaW5nLmRyYWdnaW5nLCBvblBvaW50ZXJNb3ZlLCBvblBvaW50ZXJVcF0pO1xuICAgIGNvbnN0IGtub2JTdHlsZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoZWlnaHQ6IEtOT0JfU0laRSxcbiAgICAgICAgICAgIHdpZHRoOiBLTk9CX1NJWkUsXG4gICAgICAgICAgICBib3JkZXJSYWRpdXM6IEtOT0JfU0laRSAvIDIsXG4gICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgIHRvcDogVkVSVElDQUxfUEFERElORyAtIEtOT0JfU0laRSAvIDIgKyA1IC8gMixcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3doaXRlJyxcbiAgICAgICAgICAgIGxlZnQ6IE1hdGgubWF4KDAsIChmcmFtZSAvIE1hdGgubWF4KDEsIGR1cmF0aW9uSW5GcmFtZXMgLSAxKSkgKiAoKF9hID0gc2l6ZSA9PT0gbnVsbCB8fCBzaXplID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaXplLndpZHRoKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAwKSAtXG4gICAgICAgICAgICAgICAgS05PQl9TSVpFIC8gMiksXG4gICAgICAgICAgICBib3hTaGFkb3c6ICcwIDAgMnB4IGJsYWNrJyxcbiAgICAgICAgICAgIG9wYWNpdHk6IE51bWJlcihiYXJIb3ZlcmVkKSxcbiAgICAgICAgfTtcbiAgICB9LCBbYmFySG92ZXJlZCwgZHVyYXRpb25JbkZyYW1lcywgZnJhbWUsIHNpemVdKTtcbiAgICBjb25zdCBmaWxsU3R5bGUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhlaWdodDogQkFSX0hFSUdIVCxcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMSknLFxuICAgICAgICAgICAgd2lkdGg6ICgoZnJhbWUgLSAoaW5GcmFtZSAhPT0gbnVsbCAmJiBpbkZyYW1lICE9PSB2b2lkIDAgPyBpbkZyYW1lIDogMCkpIC8gKGR1cmF0aW9uSW5GcmFtZXMgLSAxKSkgKiAxMDAgKyAnJScsXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAoKGluRnJhbWUgIT09IG51bGwgJiYgaW5GcmFtZSAhPT0gdm9pZCAwID8gaW5GcmFtZSA6IDApIC8gKGR1cmF0aW9uSW5GcmFtZXMgLSAxKSkgKiAxMDAgKyAnJScsXG4gICAgICAgICAgICBib3JkZXJSYWRpdXM6IEJBUl9IRUlHSFQgLyAyLFxuICAgICAgICB9O1xuICAgIH0sIFtkdXJhdGlvbkluRnJhbWVzLCBmcmFtZSwgaW5GcmFtZV0pO1xuICAgIGNvbnN0IGFjdGl2ZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaGVpZ2h0OiBCQVJfSEVJR0hULFxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KScsXG4gICAgICAgICAgICB3aWR0aDogKCgob3V0RnJhbWUgIT09IG51bGwgJiYgb3V0RnJhbWUgIT09IHZvaWQgMCA/IG91dEZyYW1lIDogZHVyYXRpb25JbkZyYW1lcyAtIDEpIC0gKGluRnJhbWUgIT09IG51bGwgJiYgaW5GcmFtZSAhPT0gdm9pZCAwID8gaW5GcmFtZSA6IDApKSAvXG4gICAgICAgICAgICAgICAgKGR1cmF0aW9uSW5GcmFtZXMgLSAxKSkgKlxuICAgICAgICAgICAgICAgIDEwMCArXG4gICAgICAgICAgICAgICAgJyUnLFxuICAgICAgICAgICAgbWFyZ2luTGVmdDogKChpbkZyYW1lICE9PSBudWxsICYmIGluRnJhbWUgIT09IHZvaWQgMCA/IGluRnJhbWUgOiAwKSAvIChkdXJhdGlvbkluRnJhbWVzIC0gMSkpICogMTAwICsgJyUnLFxuICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiBCQVJfSEVJR0hUIC8gMixcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICB9O1xuICAgIH0sIFtkdXJhdGlvbkluRnJhbWVzLCBpbkZyYW1lLCBvdXRGcmFtZV0pO1xuICAgIHJldHVybiAoanN4cyhcImRpdlwiLCB7IHJlZjogY29udGFpbmVyUmVmLCBvblBvaW50ZXJEb3duOiBvblBvaW50ZXJEb3duLCBzdHlsZTogY29udGFpbmVyU3R5bGUkMSwgY2hpbGRyZW46IFtqc3hzKFwiZGl2XCIsIHsgc3R5bGU6IGJhckJhY2tncm91bmQsIGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgc3R5bGU6IGFjdGl2ZSB9KSwganN4KFwiZGl2XCIsIHsgc3R5bGU6IGZpbGxTdHlsZSB9KV0gfSksIGpzeChcImRpdlwiLCB7IHN0eWxlOiBrbm9iU3R5bGUgfSldIH0pKTtcbn07XG5cbmNvbnN0IFhfU1BBQ0VSID0gMTA7XG5jb25zdCBYX1BBRERJTkcgPSAxMjtcbmNvbnN0IHVzZVZpZGVvQ29udHJvbHNSZXNpemUgPSAoeyBhbGxvd0Z1bGxzY3JlZW46IGFsbG93RnVsbFNjcmVlbiwgcGxheWVyV2lkdGgsIH0pID0+IHtcbiAgICBjb25zdCByZXNpemVJbmZvID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBsYXlQYXVzZUljb25TaXplID0gSUNPTl9TSVpFO1xuICAgICAgICBjb25zdCB2b2x1bWVJY29uU2l6ZSA9IElDT05fU0laRTtcbiAgICAgICAgY29uc3QgX2Z1bGxzY3JlZW5JY29uU2l6ZSA9IGFsbG93RnVsbFNjcmVlbiA/IGZ1bGxzY3JlZW5JY29uU2l6ZSA6IDA7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzU2l6ZSA9IHZvbHVtZUljb25TaXplICtcbiAgICAgICAgICAgIHBsYXlQYXVzZUljb25TaXplICtcbiAgICAgICAgICAgIF9mdWxsc2NyZWVuSWNvblNpemUgK1xuICAgICAgICAgICAgWF9QQURESU5HICogMiArXG4gICAgICAgICAgICBYX1NQQUNFUiAqIDI7XG4gICAgICAgIGNvbnN0IG1heFRpbWVMYWJlbFdpZHRoID0gcGxheWVyV2lkdGggLSBlbGVtZW50c1NpemU7XG4gICAgICAgIGNvbnN0IG1heFRpbWVMYWJlbFdpZHRoV2l0aG91dE5lZ2F0aXZlVmFsdWUgPSBNYXRoLm1heChtYXhUaW1lTGFiZWxXaWR0aCwgMCk7XG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVRpbWVMYWJlbFdpZHRoSWZWb2x1bWVPcGVuID0gbWF4VGltZUxhYmVsV2lkdGhXaXRob3V0TmVnYXRpdmVWYWx1ZSAtIFZPTFVNRV9TTElERVJfV0lEVEg7XG4gICAgICAgIC8vIElmIG1heCBsYWJlbCB3aWR0aCBpcyBsb3dlciB0aGFuIHRoZSB2b2x1bWUgd2lkdGhcbiAgICAgICAgLy8gdGhlbiBpdCBtZWFucyB3ZSBuZWVkIHRvIHRha2UgaXQncyB3aWR0aCBhcyB0aGUgbWF4IGxhYmVsIHdpZHRoXG4gICAgICAgIC8vIG90aGVyd2lzZSB3ZSB0b29rIHRoZSBhdmFpbGFibGUgd2lkdGggd2hlbiB2b2x1bWUgb3BlblxuICAgICAgICBjb25zdCBjb21wdXRlZExhYmVsV2lkdGggPSBhdmFpbGFibGVUaW1lTGFiZWxXaWR0aElmVm9sdW1lT3BlbiA8IFZPTFVNRV9TTElERVJfV0lEVEhcbiAgICAgICAgICAgID8gbWF4VGltZUxhYmVsV2lkdGhXaXRob3V0TmVnYXRpdmVWYWx1ZVxuICAgICAgICAgICAgOiBhdmFpbGFibGVUaW1lTGFiZWxXaWR0aElmVm9sdW1lT3BlbjtcbiAgICAgICAgY29uc3QgbWluV2lkdGhGb3JIb3Jpem9udGFsRGlzcGxheSA9IGNvbXB1dGVkTGFiZWxXaWR0aCArIGVsZW1lbnRzU2l6ZSArIFZPTFVNRV9TTElERVJfV0lEVEg7XG4gICAgICAgIGNvbnN0IGRpc3BsYXlWZXJ0aWNhbFZvbHVtZVNsaWRlciA9IHBsYXllcldpZHRoIDwgbWluV2lkdGhGb3JIb3Jpem9udGFsRGlzcGxheTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1heFRpbWVMYWJlbFdpZHRoOiBtYXhUaW1lTGFiZWxXaWR0aFdpdGhvdXROZWdhdGl2ZVZhbHVlID09PSAwXG4gICAgICAgICAgICAgICAgPyBudWxsXG4gICAgICAgICAgICAgICAgOiBtYXhUaW1lTGFiZWxXaWR0aFdpdGhvdXROZWdhdGl2ZVZhbHVlLFxuICAgICAgICAgICAgZGlzcGxheVZlcnRpY2FsVm9sdW1lU2xpZGVyLFxuICAgICAgICB9O1xuICAgIH0sIFthbGxvd0Z1bGxTY3JlZW4sIHBsYXllcldpZHRoXSk7XG4gICAgcmV0dXJuIHJlc2l6ZUluZm87XG59O1xuXG5jb25zdCBncmFkaWVudFN0ZXBzID0gW1xuICAgIDAsIDAuMDEzLCAwLjA0OSwgMC4xMDQsIDAuMTc1LCAwLjI1OSwgMC4zNTIsIDAuNDUsIDAuNTUsIDAuNjQ4LCAwLjc0MSwgMC44MjUsXG4gICAgMC44OTYsIDAuOTUxLCAwLjk4Nyxcbl07XG5jb25zdCBncmFkaWVudE9wYWNpdGllcyA9IFtcbiAgICAwLCA4LjEsIDE1LjUsIDIyLjUsIDI5LCAzNS4zLCA0MS4yLCA0Ny4xLCA1Mi45LCA1OC44LCA2NC43LCA3MSwgNzcuNSwgODQuNSxcbiAgICA5MS45LFxuXTtcbmNvbnN0IGdsb2JhbEdyYWRpZW50T3BhY2l0eSA9IDEgLyAwLjc7XG5jb25zdCBjb250YWluZXJTdHlsZSA9IHtcbiAgICBib3hTaXppbmc6ICdib3JkZXItYm94JyxcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICBib3R0b206IDAsXG4gICAgd2lkdGg6ICcxMDAlJyxcbiAgICBwYWRkaW5nVG9wOiA0MCxcbiAgICBwYWRkaW5nQm90dG9tOiAxMCxcbiAgICBiYWNrZ3JvdW5kSW1hZ2U6IGBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCR7Z3JhZGllbnRTdGVwc1xuICAgICAgICAubWFwKChnLCBpKSA9PiB7XG4gICAgICAgIHJldHVybiBgaHNsYSgwLCAwJSwgMCUsICR7Z30pICR7Z3JhZGllbnRPcGFjaXRpZXNbaV0gKiBnbG9iYWxHcmFkaWVudE9wYWNpdHl9JWA7XG4gICAgfSlcbiAgICAgICAgLmpvaW4oJywgJyl9LCBoc2woMCwgMCUsIDAlKSAxMDAlKWAsXG4gICAgYmFja2dyb3VuZFNpemU6ICdhdXRvIDE0NXB4JyxcbiAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgcGFkZGluZ1JpZ2h0OiBYX1BBRERJTkcsXG4gICAgcGFkZGluZ0xlZnQ6IFhfUEFERElORyxcbiAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJyxcbiAgICB0cmFuc2l0aW9uOiAnb3BhY2l0eSAwLjNzJyxcbn07XG5jb25zdCBjb250cm9sc1JvdyA9IHtcbiAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgZmxleERpcmVjdGlvbjogJ3JvdycsXG4gICAgd2lkdGg6ICcxMDAlJyxcbiAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gICAgdXNlclNlbGVjdDogJ25vbmUnLFxufTtcbmNvbnN0IGxlZnRQYXJ0U3R5bGUgPSB7XG4gICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICAgIHVzZXJTZWxlY3Q6ICdub25lJyxcbiAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbn07XG5jb25zdCB4U3BhY2VyID0ge1xuICAgIHdpZHRoOiAxMixcbn07XG5jb25zdCB5U3BhY2VyID0ge1xuICAgIGhlaWdodDogOCxcbn07XG5jb25zdCBmbGV4MSA9IHtcbiAgICBmbGV4OiAxLFxufTtcbmNvbnN0IGZ1bGxzY3JlZW4gPSB7fTtcbmNvbnN0IFBsYXlQYXVzZUJ1dHRvbiA9ICh7IHBsYXlpbmcgfSkgPT4gcGxheWluZyA/IGpzeChQYXVzZUljb24sIHt9KSA6IGpzeChQbGF5SWNvbiwge30pO1xuY29uc3QgQ29udHJvbHMgPSAoeyBkdXJhdGlvbkluRnJhbWVzLCBpc0Z1bGxzY3JlZW4sIGZwcywgcGxheWVyLCBzaG93Vm9sdW1lQ29udHJvbHMsIG9uRnVsbHNjcmVlbkJ1dHRvbkNsaWNrLCBhbGxvd0Z1bGxzY3JlZW4sIG9uRXhpdEZ1bGxzY3JlZW5CdXR0b25DbGljaywgc3BhY2VLZXlUb1BsYXlPclBhdXNlLCBvblNlZWtFbmQsIG9uU2Vla1N0YXJ0LCBpbkZyYW1lLCBvdXRGcmFtZSwgaW5pdGlhbGx5U2hvd0NvbnRyb2xzLCBjYW52YXNTaXplLCByZW5kZXJQbGF5UGF1c2VCdXR0b24sIHJlbmRlckZ1bGxzY3JlZW5CdXR0b24sIGFsd2F5c1Nob3dDb250cm9scywgc2hvd1BsYXliYWNrUmF0ZUNvbnRyb2wsIGNvbnRhaW5lclJlZiwgfSkgPT4ge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBwbGF5QnV0dG9uUmVmID0gdXNlUmVmKG51bGwpO1xuICAgIGNvbnN0IGZyYW1lID0gSW50ZXJuYWxzLlRpbWVsaW5lLnVzZVRpbWVsaW5lUG9zaXRpb24oKTtcbiAgICBjb25zdCBbc3VwcG9ydHNGdWxsc2NyZWVuLCBzZXRTdXBwb3J0c0Z1bGxzY3JlZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IGhvdmVyZWQgPSB1c2VIb3ZlclN0YXRlKGNvbnRhaW5lclJlZik7XG4gICAgY29uc3QgeyBtYXhUaW1lTGFiZWxXaWR0aCwgZGlzcGxheVZlcnRpY2FsVm9sdW1lU2xpZGVyIH0gPSB1c2VWaWRlb0NvbnRyb2xzUmVzaXplKHtcbiAgICAgICAgYWxsb3dGdWxsc2NyZWVuLFxuICAgICAgICBwbGF5ZXJXaWR0aDogKF9hID0gY2FudmFzU2l6ZSA9PT0gbnVsbCB8fCBjYW52YXNTaXplID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjYW52YXNTaXplLndpZHRoKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAwLFxuICAgIH0pO1xuICAgIGNvbnN0IFtzaG91bGRTaG93SW5pdGlhbGx5LCBzZXRJbml0aWFsbHlTaG93Q29udHJvbHNdID0gdXNlU3RhdGUoKCkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIGluaXRpYWxseVNob3dDb250cm9scyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICByZXR1cm4gaW5pdGlhbGx5U2hvd0NvbnRyb2xzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgaW5pdGlhbGx5U2hvd0NvbnRyb2xzID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgaWYgKGluaXRpYWxseVNob3dDb250cm9scyAlIDEgIT09IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luaXRpYWxseVNob3dDb250cm9scyBtdXN0IGJlIGFuIGludGVnZXIgb3IgYSBib29sZWFuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoTnVtYmVyLmlzTmFOKGluaXRpYWxseVNob3dDb250cm9scykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luaXRpYWxseVNob3dDb250cm9scyBtdXN0IG5vdCBiZSBOYU4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghTnVtYmVyLmlzRmluaXRlKGluaXRpYWxseVNob3dDb250cm9scykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luaXRpYWxseVNob3dDb250cm9scyBtdXN0IGJlIGZpbml0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluaXRpYWxseVNob3dDb250cm9scyA8PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbml0aWFsbHlTaG93Q29udHJvbHMgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpbml0aWFsbHlTaG93Q29udHJvbHM7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW5pdGlhbGx5U2hvd0NvbnRyb2xzIG11c3QgYmUgYSBudW1iZXIgb3IgYSBib29sZWFuJyk7XG4gICAgfSk7XG4gICAgY29uc3QgY29udGFpbmVyQ3NzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIC8vIEhpZGUgaWYgcGxheWluZyBhbmQgbW91c2Ugb3V0c2lkZVxuICAgICAgICBjb25zdCBzaG91bGRTaG93ID0gaG92ZXJlZCB8fCAhcGxheWVyLnBsYXlpbmcgfHwgc2hvdWxkU2hvd0luaXRpYWxseSB8fCBhbHdheXNTaG93Q29udHJvbHM7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5jb250YWluZXJTdHlsZSxcbiAgICAgICAgICAgIG9wYWNpdHk6IE51bWJlcihzaG91bGRTaG93KSxcbiAgICAgICAgfTtcbiAgICB9LCBbaG92ZXJlZCwgc2hvdWxkU2hvd0luaXRpYWxseSwgcGxheWVyLnBsYXlpbmcsIGFsd2F5c1Nob3dDb250cm9sc10pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChwbGF5QnV0dG9uUmVmLmN1cnJlbnQgJiYgc3BhY2VLZXlUb1BsYXlPclBhdXNlKSB7XG4gICAgICAgICAgICAvLyBUaGlzIHN3aXRjaGVzIGZvY3VzIHRvIHBsYXkgYnV0dG9uIHdoZW4gcGxheWVyLnBsYXlpbmcgZmxhZyBjaGFuZ2VzXG4gICAgICAgICAgICBwbGF5QnV0dG9uUmVmLmN1cnJlbnQuZm9jdXMoe1xuICAgICAgICAgICAgICAgIHByZXZlbnRTY3JvbGw6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIFtwbGF5ZXIucGxheWluZywgc3BhY2VLZXlUb1BsYXlPclBhdXNlXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICAvLyBNdXN0IGJlIGhhbmRsZWQgY2xpZW50LXNpZGUgdG8gYXZvaWQgU1NSIGh5ZHJhdGlvbiBtaXNtYXRjaFxuICAgICAgICBzZXRTdXBwb3J0c0Z1bGxzY3JlZW4oKF9hID0gKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgICAgIChkb2N1bWVudC5mdWxsc2NyZWVuRW5hYmxlZCB8fCBkb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRW5hYmxlZCkpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBmYWxzZSk7XG4gICAgfSwgW10pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChzaG91bGRTaG93SW5pdGlhbGx5ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRpbWUgPSBzaG91bGRTaG93SW5pdGlhbGx5ID09PSB0cnVlID8gMjAwMCA6IHNob3VsZFNob3dJbml0aWFsbHk7XG4gICAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHNldEluaXRpYWxseVNob3dDb250cm9scyhmYWxzZSk7XG4gICAgICAgIH0sIHRpbWUpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lb3V0KTtcbiAgICAgICAgfTtcbiAgICB9LCBbc2hvdWxkU2hvd0luaXRpYWxseV0pO1xuICAgIGNvbnN0IHRpbWVMYWJlbCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29sb3I6ICd3aGl0ZScsXG4gICAgICAgICAgICBmb250RmFtaWx5OiAnc2Fucy1zZXJpZicsXG4gICAgICAgICAgICBmb250U2l6ZTogMTQsXG4gICAgICAgICAgICBtYXhXaWR0aDogbWF4VGltZUxhYmVsV2lkdGggPT09IG51bGwgPyB1bmRlZmluZWQgOiBtYXhUaW1lTGFiZWxXaWR0aCxcbiAgICAgICAgICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICAgICAgICAgIHRleHRPdmVyZmxvdzogJ2VsbGlwc2lzJyxcbiAgICAgICAgfTtcbiAgICB9LCBbbWF4VGltZUxhYmVsV2lkdGhdKTtcbiAgICBjb25zdCBwbGF5YmFja1JhdGVzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGlmIChzaG93UGxheWJhY2tSYXRlQ29udHJvbCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFswLjUsIDAuOCwgMSwgMS4yLCAxLjUsIDEuOCwgMiwgMi41LCAzXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzaG93UGxheWJhY2tSYXRlQ29udHJvbCkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmF0ZSBvZiBzaG93UGxheWJhY2tSYXRlQ29udHJvbCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmF0ZSAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFdmVyeSBpdGVtIGluIHNob3dQbGF5YmFja1JhdGVDb250cm9sIG11c3QgYmUgYSBudW1iZXInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJhdGUgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V2ZXJ5IGl0ZW0gaW4gc2hvd1BsYXliYWNrUmF0ZUNvbnRyb2wgbXVzdCBiZSBwb3NpdGl2ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzaG93UGxheWJhY2tSYXRlQ29udHJvbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9LCBbc2hvd1BsYXliYWNrUmF0ZUNvbnRyb2xdKTtcbiAgICByZXR1cm4gKGpzeHMoXCJkaXZcIiwgeyBzdHlsZTogY29udGFpbmVyQ3NzLCBjaGlsZHJlbjogW2pzeHMoXCJkaXZcIiwgeyBzdHlsZTogY29udHJvbHNSb3csIGNoaWxkcmVuOiBbanN4cyhcImRpdlwiLCB7IHN0eWxlOiBsZWZ0UGFydFN0eWxlLCBjaGlsZHJlbjogW2pzeChcImJ1dHRvblwiLCB7IHJlZjogcGxheUJ1dHRvblJlZiwgdHlwZTogXCJidXR0b25cIiwgc3R5bGU6IHBsYXllckJ1dHRvblN0eWxlLCBvbkNsaWNrOiBwbGF5ZXIucGxheWluZyA/IHBsYXllci5wYXVzZSA6IHBsYXllci5wbGF5LCBcImFyaWEtbGFiZWxcIjogcGxheWVyLnBsYXlpbmcgPyAnUGF1c2UgdmlkZW8nIDogJ1BsYXkgdmlkZW8nLCB0aXRsZTogcGxheWVyLnBsYXlpbmcgPyAnUGF1c2UgdmlkZW8nIDogJ1BsYXkgdmlkZW8nLCBjaGlsZHJlbjogcmVuZGVyUGxheVBhdXNlQnV0dG9uID09PSBudWxsID8gKGpzeChQbGF5UGF1c2VCdXR0b24sIHsgcGxheWluZzogcGxheWVyLnBsYXlpbmcgfSkpIDogKHJlbmRlclBsYXlQYXVzZUJ1dHRvbih7IHBsYXlpbmc6IHBsYXllci5wbGF5aW5nIH0pKSB9KSwgc2hvd1ZvbHVtZUNvbnRyb2xzID8gKGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtqc3goXCJkaXZcIiwgeyBzdHlsZTogeFNwYWNlciB9KSwganN4KE1lZGlhVm9sdW1lU2xpZGVyLCB7IGRpc3BsYXlWZXJ0aWNhbFZvbHVtZVNsaWRlcjogZGlzcGxheVZlcnRpY2FsVm9sdW1lU2xpZGVyIH0pXSB9KSkgOiBudWxsLCBqc3goXCJkaXZcIiwgeyBzdHlsZTogeFNwYWNlciB9KSwganN4cyhcImRpdlwiLCB7IHN0eWxlOiB0aW1lTGFiZWwsIGNoaWxkcmVuOiBbZm9ybWF0VGltZShmcmFtZSAvIGZwcyksIFwiIC8gXCIsIGZvcm1hdFRpbWUoZHVyYXRpb25JbkZyYW1lcyAvIGZwcyldIH0pLCBqc3goXCJkaXZcIiwgeyBzdHlsZTogeFNwYWNlciB9KV0gfSksIGpzeChcImRpdlwiLCB7IHN0eWxlOiBmbGV4MSB9KSwgcGxheWJhY2tSYXRlcyAmJiBjYW52YXNTaXplICYmIChqc3goUGxheWJhY2tyYXRlQ29udHJvbCwgeyBjYW52YXNTaXplOiBjYW52YXNTaXplLCBwbGF5YmFja1JhdGVzOiBwbGF5YmFja1JhdGVzIH0pKSwgcGxheWJhY2tSYXRlcyAmJiBzdXBwb3J0c0Z1bGxzY3JlZW4gJiYgYWxsb3dGdWxsc2NyZWVuID8gKGpzeChcImRpdlwiLCB7IHN0eWxlOiB4U3BhY2VyIH0pKSA6IG51bGwsIGpzeChcImRpdlwiLCB7IHN0eWxlOiBmdWxsc2NyZWVuLCBjaGlsZHJlbjogc3VwcG9ydHNGdWxsc2NyZWVuICYmIGFsbG93RnVsbHNjcmVlbiA/IChqc3goXCJidXR0b25cIiwgeyB0eXBlOiBcImJ1dHRvblwiLCBcImFyaWEtbGFiZWxcIjogaXNGdWxsc2NyZWVuID8gJ0V4aXQgZnVsbHNjcmVlbicgOiAnRW50ZXIgRnVsbHNjcmVlbicsIHRpdGxlOiBpc0Z1bGxzY3JlZW4gPyAnRXhpdCBmdWxsc2NyZWVuJyA6ICdFbnRlciBGdWxsc2NyZWVuJywgc3R5bGU6IHBsYXllckJ1dHRvblN0eWxlLCBvbkNsaWNrOiBpc0Z1bGxzY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBvbkV4aXRGdWxsc2NyZWVuQnV0dG9uQ2xpY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBvbkZ1bGxzY3JlZW5CdXR0b25DbGljaywgY2hpbGRyZW46IHJlbmRlckZ1bGxzY3JlZW5CdXR0b24gPT09IG51bGwgPyAoanN4KEZ1bGxzY3JlZW5JY29uLCB7IGlzRnVsbHNjcmVlbjogaXNGdWxsc2NyZWVuIH0pKSA6IChyZW5kZXJGdWxsc2NyZWVuQnV0dG9uKHsgaXNGdWxsc2NyZWVuIH0pKSB9KSkgOiBudWxsIH0pXSB9KSwganN4KFwiZGl2XCIsIHsgc3R5bGU6IHlTcGFjZXIgfSksIGpzeChQbGF5ZXJTZWVrQmFyLCB7IG9uU2Vla0VuZDogb25TZWVrRW5kLCBvblNlZWtTdGFydDogb25TZWVrU3RhcnQsIGR1cmF0aW9uSW5GcmFtZXM6IGR1cmF0aW9uSW5GcmFtZXMsIGluRnJhbWU6IGluRnJhbWUsIG91dEZyYW1lOiBvdXRGcmFtZSB9KV0gfSkpO1xufTtcblxuY29uc3QgSVNfTk9ERSA9IHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCc7XG5cbmNvbnN0IGNhbmNlbGxhYmxlUHJvbWlzZSA9IChwcm9taXNlKSA9PiB7XG4gICAgbGV0IGlzQ2FuY2VsZWQgPSBmYWxzZTtcbiAgICBjb25zdCB3cmFwcGVkUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgcHJvbWlzZVxuICAgICAgICAgICAgLnRoZW4oKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBpZiAoaXNDYW5jZWxlZCkge1xuICAgICAgICAgICAgICAgIHJlamVjdCh7IGlzQ2FuY2VsZWQsIHZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KHsgaXNDYW5jZWxlZCwgZXJyb3IgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIHByb21pc2U6IHdyYXBwZWRQcm9taXNlLFxuICAgICAgICBjYW5jZWw6ICgpID0+IHtcbiAgICAgICAgICAgIGlzQ2FuY2VsZWQgPSB0cnVlO1xuICAgICAgICB9LFxuICAgIH07XG59O1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wcm9taXNlLWV4ZWN1dG9yLXJldHVybiAqL1xuY29uc3QgZGVsYXkgPSAobikgPT4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbikpO1xuXG5jb25zdCB1c2VDYW5jZWxsYWJsZVByb21pc2VzID0gKCkgPT4ge1xuICAgIGNvbnN0IHBlbmRpbmdQcm9taXNlcyA9IHVzZVJlZihbXSk7XG4gICAgY29uc3QgYXBwZW5kUGVuZGluZ1Byb21pc2UgPSB1c2VDYWxsYmFjaygocHJvbWlzZSkgPT4ge1xuICAgICAgICBwZW5kaW5nUHJvbWlzZXMuY3VycmVudCA9IFsuLi5wZW5kaW5nUHJvbWlzZXMuY3VycmVudCwgcHJvbWlzZV07XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IHJlbW92ZVBlbmRpbmdQcm9taXNlID0gdXNlQ2FsbGJhY2soKHByb21pc2UpID0+IHtcbiAgICAgICAgcGVuZGluZ1Byb21pc2VzLmN1cnJlbnQgPSBwZW5kaW5nUHJvbWlzZXMuY3VycmVudC5maWx0ZXIoKHApID0+IHAgIT09IHByb21pc2UpO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBjbGVhclBlbmRpbmdQcm9taXNlcyA9IHVzZUNhbGxiYWNrKCgpID0+IHBlbmRpbmdQcm9taXNlcy5jdXJyZW50Lm1hcCgocCkgPT4gcC5jYW5jZWwoKSksIFtdKTtcbiAgICBjb25zdCBhcGkgPSB1c2VNZW1vKCgpID0+ICh7XG4gICAgICAgIGFwcGVuZFBlbmRpbmdQcm9taXNlLFxuICAgICAgICByZW1vdmVQZW5kaW5nUHJvbWlzZSxcbiAgICAgICAgY2xlYXJQZW5kaW5nUHJvbWlzZXMsXG4gICAgfSksIFthcHBlbmRQZW5kaW5nUHJvbWlzZSwgY2xlYXJQZW5kaW5nUHJvbWlzZXMsIHJlbW92ZVBlbmRpbmdQcm9taXNlXSk7XG4gICAgcmV0dXJuIGFwaTtcbn07XG5cbmNvbnN0IHVzZUNsaWNrUHJldmVudGlvbk9uRG91YmxlQ2xpY2sgPSAob25DbGljaywgb25Eb3VibGVDbGljaywgZG91YmxlQ2xpY2tUb0Z1bGxzY3JlZW4pID0+IHtcbiAgICBjb25zdCBhcGkgPSB1c2VDYW5jZWxsYWJsZVByb21pc2VzKCk7XG4gICAgY29uc3QgaGFuZGxlQ2xpY2sgPSB1c2VDYWxsYmFjayhhc3luYyAoZSkgPT4ge1xuICAgICAgICBhcGkuY2xlYXJQZW5kaW5nUHJvbWlzZXMoKTtcbiAgICAgICAgY29uc3Qgd2FpdEZvckNsaWNrID0gY2FuY2VsbGFibGVQcm9taXNlKGRlbGF5KDIwMCkpO1xuICAgICAgICBhcGkuYXBwZW5kUGVuZGluZ1Byb21pc2Uod2FpdEZvckNsaWNrKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHdhaXRGb3JDbGljay5wcm9taXNlO1xuICAgICAgICAgICAgYXBpLnJlbW92ZVBlbmRpbmdQcm9taXNlKHdhaXRGb3JDbGljayk7XG4gICAgICAgICAgICBvbkNsaWNrKGUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvckluZm8pIHtcbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSBlcnJvckluZm87XG4gICAgICAgICAgICBhcGkucmVtb3ZlUGVuZGluZ1Byb21pc2Uod2FpdEZvckNsaWNrKTtcbiAgICAgICAgICAgIGlmICghaW5mby5pc0NhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgaW5mby5lcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIFthcGksIG9uQ2xpY2tdKTtcbiAgICBjb25zdCBoYW5kbGVEb3VibGVDbGljayA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgYXBpLmNsZWFyUGVuZGluZ1Byb21pc2VzKCk7XG4gICAgICAgIG9uRG91YmxlQ2xpY2soKTtcbiAgICB9LCBbYXBpLCBvbkRvdWJsZUNsaWNrXSk7XG4gICAgY29uc3QgcmV0dXJuVmFsdWUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgaWYgKCFkb3VibGVDbGlja1RvRnVsbHNjcmVlbikge1xuICAgICAgICAgICAgcmV0dXJuIFtvbkNsaWNrLCBvbkRvdWJsZUNsaWNrXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW2hhbmRsZUNsaWNrLCBoYW5kbGVEb3VibGVDbGlja107XG4gICAgfSwgW1xuICAgICAgICBkb3VibGVDbGlja1RvRnVsbHNjcmVlbixcbiAgICAgICAgaGFuZGxlQ2xpY2ssXG4gICAgICAgIGhhbmRsZURvdWJsZUNsaWNrLFxuICAgICAgICBvbkNsaWNrLFxuICAgICAgICBvbkRvdWJsZUNsaWNrLFxuICAgIF0pO1xuICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbn07XG5cbmNvbnN0IHJlYWN0VmVyc2lvbiQxID0gUmVhY3QudmVyc2lvbi5zcGxpdCgnLicpWzBdO1xuaWYgKHJlYWN0VmVyc2lvbiQxID09PSAnMCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFZlcnNpb24gJHtyZWFjdFZlcnNpb24kMX0gb2YgXCJyZWFjdFwiIGlzIG5vdCBzdXBwb3J0ZWQgYnkgUmVtb3Rpb25gKTtcbn1cbmNvbnN0IGRvZXNSZWFjdFZlcnNpb25TdXBwb3J0U3VzcGVuc2UkMSA9IHBhcnNlSW50KHJlYWN0VmVyc2lvbiQxLCAxMCkgPj0gMTg7XG5jb25zdCBQbGF5ZXJVSSA9ICh7IGNvbnRyb2xzLCBzdHlsZSwgbG9vcCwgYXV0b1BsYXksIGFsbG93RnVsbHNjcmVlbiwgaW5wdXRQcm9wcywgY2xpY2tUb1BsYXksIHNob3dWb2x1bWVDb250cm9scywgZG91YmxlQ2xpY2tUb0Z1bGxzY3JlZW4sIHNwYWNlS2V5VG9QbGF5T3JQYXVzZSwgZXJyb3JGYWxsYmFjaywgcGxheWJhY2tSYXRlLCByZW5kZXJMb2FkaW5nLCByZW5kZXJQb3N0ZXIsIGNsYXNzTmFtZSwgbW92ZVRvQmVnaW5uaW5nV2hlbkVuZGVkLCBzaG93UG9zdGVyV2hlblVucGxheWVkLCBzaG93UG9zdGVyV2hlbkVuZGVkLCBzaG93UG9zdGVyV2hlblBhdXNlZCwgaW5GcmFtZSwgb3V0RnJhbWUsIGluaXRpYWxseVNob3dDb250cm9scywgcmVuZGVyRnVsbHNjcmVlbjogcmVuZGVyRnVsbHNjcmVlbkJ1dHRvbiwgcmVuZGVyUGxheVBhdXNlQnV0dG9uLCBhbHdheXNTaG93Q29udHJvbHMsIHNob3dQbGF5YmFja1JhdGVDb250cm9sLCB9LCByZWYpID0+IHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCBjb25maWcgPSBJbnRlcm5hbHMudXNlVW5zYWZlVmlkZW9Db25maWcoKTtcbiAgICBjb25zdCB2aWRlbyA9IEludGVybmFscy51c2VWaWRlbygpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHVzZVJlZihudWxsKTtcbiAgICBjb25zdCBjYW52YXNTaXplID0gdXNlRWxlbWVudFNpemUoY29udGFpbmVyLCB7XG4gICAgICAgIHRyaWdnZXJPbldpbmRvd1Jlc2l6ZTogZmFsc2UsXG4gICAgICAgIHNob3VsZEFwcGx5Q3NzVHJhbnNmb3JtczogZmFsc2UsXG4gICAgfSk7XG4gICAgY29uc3QgW2hhc1BhdXNlZFRvUmVzdW1lLCBzZXRIYXNQYXVzZWRUb1Jlc3VtZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW3Nob3VsZEF1dG9wbGF5LCBzZXRTaG91bGRBdXRvUGxheV0gPSB1c2VTdGF0ZShhdXRvUGxheSk7XG4gICAgY29uc3QgW2lzRnVsbHNjcmVlbiwgc2V0SXNGdWxsc2NyZWVuXSA9IHVzZVN0YXRlKCgpID0+IGZhbHNlKTtcbiAgICBjb25zdCBbc2Vla2luZywgc2V0U2Vla2luZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgdXNlUGxheWJhY2soe1xuICAgICAgICBsb29wLFxuICAgICAgICBwbGF5YmFja1JhdGUsXG4gICAgICAgIG1vdmVUb0JlZ2lubmluZ1doZW5FbmRlZCxcbiAgICAgICAgaW5GcmFtZSxcbiAgICAgICAgb3V0RnJhbWUsXG4gICAgfSk7XG4gICAgY29uc3QgcGxheWVyID0gdXNlUGxheWVyKCk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKGhhc1BhdXNlZFRvUmVzdW1lICYmICFwbGF5ZXIucGxheWluZykge1xuICAgICAgICAgICAgc2V0SGFzUGF1c2VkVG9SZXN1bWUoZmFsc2UpO1xuICAgICAgICAgICAgcGxheWVyLnBsYXkoKTtcbiAgICAgICAgfVxuICAgIH0sIFtoYXNQYXVzZWRUb1Jlc3VtZSwgcGxheWVyXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3QgeyBjdXJyZW50IH0gPSBjb250YWluZXI7XG4gICAgICAgIGlmICghY3VycmVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG9uRnVsbHNjcmVlbkNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHNldElzRnVsbHNjcmVlbihkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCA9PT0gY3VycmVudCB8fFxuICAgICAgICAgICAgICAgIGRvY3VtZW50LndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50ID09PSBjdXJyZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZnVsbHNjcmVlbmNoYW5nZScsIG9uRnVsbHNjcmVlbkNoYW5nZSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UnLCBvbkZ1bGxzY3JlZW5DaGFuZ2UpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZnVsbHNjcmVlbmNoYW5nZScsIG9uRnVsbHNjcmVlbkNoYW5nZSk7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd3ZWJraXRmdWxsc2NyZWVuY2hhbmdlJywgb25GdWxsc2NyZWVuQ2hhbmdlKTtcbiAgICAgICAgfTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgdG9nZ2xlID0gdXNlQ2FsbGJhY2soKGUpID0+IHtcbiAgICAgICAgaWYgKHBsYXllci5pc1BsYXlpbmcoKSkge1xuICAgICAgICAgICAgcGxheWVyLnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwbGF5ZXIucGxheShlKTtcbiAgICAgICAgfVxuICAgIH0sIFtwbGF5ZXJdKTtcbiAgICBjb25zdCByZXF1ZXN0RnVsbHNjcmVlbiA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgaWYgKCFhbGxvd0Z1bGxzY3JlZW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignYWxsb3dGdWxsc2NyZWVuIGlzIGZhbHNlJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3VwcG9ydHNGdWxsU2NyZWVuID0gZG9jdW1lbnQuZnVsbHNjcmVlbkVuYWJsZWQgfHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVuYWJsZWQ7XG4gICAgICAgIGlmICghc3VwcG9ydHNGdWxsU2NyZWVuKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Jyb3dzZXIgZG9lc250IHN1cHBvcnQgZnVsbHNjcmVlbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY29udGFpbmVyLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gcGxheWVyIHJlZiBmb3VuZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWluZXIuY3VycmVudC53ZWJraXRSZXF1ZXN0RnVsbFNjcmVlbikge1xuICAgICAgICAgICAgY29udGFpbmVyLmN1cnJlbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW4oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRhaW5lci5jdXJyZW50LnJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gICAgICAgIH1cbiAgICB9LCBbYWxsb3dGdWxsc2NyZWVuXSk7XG4gICAgY29uc3QgZXhpdEZ1bGxzY3JlZW4gPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbikge1xuICAgICAgICAgICAgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7XG4gICAgICAgIH1cbiAgICB9LCBbXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3QgeyBjdXJyZW50IH0gPSBjb250YWluZXI7XG4gICAgICAgIGlmICghY3VycmVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZ1bGxzY3JlZW5DaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gKF9hID0gZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50O1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCA9PT0gY29udGFpbmVyLmN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuZW1pdHRlci5kaXNwYXRjaEZ1bGxzY3JlZW5DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICBpc0Z1bGxzY3JlZW46IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuZW1pdHRlci5kaXNwYXRjaEZ1bGxzY3JlZW5DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICBpc0Z1bGxzY3JlZW46IGZhbHNlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjdXJyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UnLCBmdWxsc2NyZWVuQ2hhbmdlKTtcbiAgICAgICAgY3VycmVudC5hZGRFdmVudExpc3RlbmVyKCdmdWxsc2NyZWVuY2hhbmdlJywgZnVsbHNjcmVlbkNoYW5nZSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBjdXJyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3dlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UnLCBmdWxsc2NyZWVuQ2hhbmdlKTtcbiAgICAgICAgICAgIGN1cnJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZnVsbHNjcmVlbmNoYW5nZScsIGZ1bGxzY3JlZW5DaGFuZ2UpO1xuICAgICAgICB9O1xuICAgIH0sIFtwbGF5ZXIuZW1pdHRlcl0pO1xuICAgIGNvbnN0IGR1cmF0aW9uSW5GcmFtZXMgPSAoX2EgPSBjb25maWcgPT09IG51bGwgfHwgY29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWcuZHVyYXRpb25JbkZyYW1lcykgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMTtcbiAgICBjb25zdCBsYXlvdXQgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgaWYgKCFjb25maWcgfHwgIWNhbnZhc1NpemUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWxjdWxhdGVDYW52YXNUcmFuc2Zvcm1hdGlvbih7XG4gICAgICAgICAgICBjYW52YXNTaXplLFxuICAgICAgICAgICAgY29tcG9zaXRpb25IZWlnaHQ6IGNvbmZpZy5oZWlnaHQsXG4gICAgICAgICAgICBjb21wb3NpdGlvbldpZHRoOiBjb25maWcud2lkdGgsXG4gICAgICAgICAgICBwcmV2aWV3U2l6ZTogJ2F1dG8nLFxuICAgICAgICB9KTtcbiAgICB9LCBbY2FudmFzU2l6ZSwgY29uZmlnXSk7XG4gICAgY29uc3Qgc2NhbGUgPSAoX2IgPSBsYXlvdXQgPT09IG51bGwgfHwgbGF5b3V0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsYXlvdXQuc2NhbGUpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IDE7XG4gICAgY29uc3QgaW5pdGlhbFNjYWxlSWdub3JlZCA9IHVzZVJlZihmYWxzZSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFpbml0aWFsU2NhbGVJZ25vcmVkLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGluaXRpYWxTY2FsZUlnbm9yZWQuY3VycmVudCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcGxheWVyLmVtaXR0ZXIuZGlzcGF0Y2hTY2FsZUNoYW5nZShzY2FsZSk7XG4gICAgfSwgW3BsYXllci5lbWl0dGVyLCBzY2FsZV0pO1xuICAgIGNvbnN0IHsgc2V0TWVkaWFWb2x1bWUsIHNldE1lZGlhTXV0ZWQgfSA9IHVzZUNvbnRleHQoSW50ZXJuYWxzLlNldE1lZGlhVm9sdW1lQ29udGV4dCk7XG4gICAgY29uc3QgeyBtZWRpYU11dGVkLCBtZWRpYVZvbHVtZSB9ID0gdXNlQ29udGV4dChJbnRlcm5hbHMuTWVkaWFWb2x1bWVDb250ZXh0KTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBwbGF5ZXIuZW1pdHRlci5kaXNwYXRjaFZvbHVtZUNoYW5nZShtZWRpYVZvbHVtZSk7XG4gICAgfSwgW3BsYXllci5lbWl0dGVyLCBtZWRpYVZvbHVtZV0pO1xuICAgIGNvbnN0IGlzTXV0ZWQgPSBtZWRpYU11dGVkIHx8IG1lZGlhVm9sdW1lID09PSAwO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHBsYXllci5lbWl0dGVyLmRpc3BhdGNoTXV0ZUNoYW5nZSh7XG4gICAgICAgICAgICBpc011dGVkLFxuICAgICAgICB9KTtcbiAgICB9LCBbcGxheWVyLmVtaXR0ZXIsIGlzTXV0ZWRdKTtcbiAgICB1c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBtZXRob2RzID0ge1xuICAgICAgICAgICAgcGxheTogcGxheWVyLnBsYXksXG4gICAgICAgICAgICBwYXVzZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIElmLCBhZnRlciAuc2VlaygpLWluZywgdGhlIHBsYXllciB3YXMgZXhwbGljaXRseSBwYXVzZWQsIHdlIGRvbid0IHJlc3VtZVxuICAgICAgICAgICAgICAgIHNldEhhc1BhdXNlZFRvUmVzdW1lKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBwbGF5ZXIucGF1c2UoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b2dnbGUsXG4gICAgICAgICAgICBnZXRDb250YWluZXJOb2RlOiAoKSA9PiBjb250YWluZXIuY3VycmVudCxcbiAgICAgICAgICAgIGdldEN1cnJlbnRGcmFtZTogcGxheWVyLmdldEN1cnJlbnRGcmFtZSxcbiAgICAgICAgICAgIGlzUGxheWluZzogKCkgPT4gcGxheWVyLnBsYXlpbmcsXG4gICAgICAgICAgICBzZWVrVG86IChmKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdEZyYW1lID0gZHVyYXRpb25JbkZyYW1lcyAtIDE7XG4gICAgICAgICAgICAgICAgY29uc3QgZnJhbWVUb1NlZWtUbyA9IE1hdGgubWF4KDAsIE1hdGgubWluKGxhc3RGcmFtZSwgZikpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnRpbnVlIHBsYXlpbmcgYWZ0ZXIgc2Vla2luZyBpZiB0aGUgcGxheWVyIHdhcyBwbGF5aW5nIGJlZm9yZVxuICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIuaXNQbGF5aW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF1c2VUb1Jlc3VtZSA9IGZyYW1lVG9TZWVrVG8gIT09IGxhc3RGcmFtZSB8fCBsb29wO1xuICAgICAgICAgICAgICAgICAgICBzZXRIYXNQYXVzZWRUb1Jlc3VtZShwYXVzZVRvUmVzdW1lKTtcbiAgICAgICAgICAgICAgICAgICAgcGxheWVyLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmcmFtZVRvU2Vla1RvID09PSBsYXN0RnJhbWUgJiYgIWxvb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgcGxheWVyLmVtaXR0ZXIuZGlzcGF0Y2hFbmRlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2VlayhmcmFtZVRvU2Vla1RvKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpc0Z1bGxzY3JlZW46ICgpID0+IGlzRnVsbHNjcmVlbixcbiAgICAgICAgICAgIHJlcXVlc3RGdWxsc2NyZWVuLFxuICAgICAgICAgICAgZXhpdEZ1bGxzY3JlZW4sXG4gICAgICAgICAgICBnZXRWb2x1bWU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobWVkaWFNdXRlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lZGlhVm9sdW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldFZvbHVtZTogKHZvbCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygdm9sICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBzZXRWb2x1bWUoKSB0YWtlcyBhIG51bWJlciwgZ290IHZhbHVlIG9mIHR5cGUgJHt0eXBlb2Ygdm9sfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odm9sKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBzZXRWb2x1bWUoKSBnb3QgYSBudW1iZXIgdGhhdCBpcyBOYU4uIFZvbHVtZSBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMS5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZvbCA8IDAgfHwgdm9sID4gMSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBzZXRWb2x1bWUoKSBnb3QgYSBudW1iZXIgdGhhdCBpcyBvdXQgb2YgcmFuZ2UuIE11c3QgYmUgYmV0d2VlbiAwIGFuZCAxLCBnb3QgJHt0eXBlb2Ygdm9sfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRNZWRpYVZvbHVtZSh2b2wpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGlzTXV0ZWQ6ICgpID0+IGlzTXV0ZWQsXG4gICAgICAgICAgICBtdXRlOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0TWVkaWFNdXRlZCh0cnVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1bm11dGU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRNZWRpYU11dGVkKGZhbHNlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRTY2FsZTogKCkgPT4gc2NhbGUsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHBsYXllci5lbWl0dGVyLCBtZXRob2RzKTtcbiAgICB9LCBbXG4gICAgICAgIGR1cmF0aW9uSW5GcmFtZXMsXG4gICAgICAgIGV4aXRGdWxsc2NyZWVuLFxuICAgICAgICBpc0Z1bGxzY3JlZW4sXG4gICAgICAgIGxvb3AsXG4gICAgICAgIG1lZGlhTXV0ZWQsXG4gICAgICAgIGlzTXV0ZWQsXG4gICAgICAgIG1lZGlhVm9sdW1lLFxuICAgICAgICBwbGF5ZXIsXG4gICAgICAgIHJlcXVlc3RGdWxsc2NyZWVuLFxuICAgICAgICBzZXRNZWRpYU11dGVkLFxuICAgICAgICBzZXRNZWRpYVZvbHVtZSxcbiAgICAgICAgdG9nZ2xlLFxuICAgICAgICBzY2FsZSxcbiAgICBdKTtcbiAgICBjb25zdCBWaWRlb0NvbXBvbmVudCA9IHZpZGVvID8gdmlkZW8uY29tcG9uZW50IDogbnVsbDtcbiAgICBjb25zdCBvdXRlclN0eWxlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiBjYWxjdWxhdGVPdXRlclN0eWxlKHsgY2FudmFzU2l6ZSwgY29uZmlnLCBzdHlsZSB9KTtcbiAgICB9LCBbY2FudmFzU2l6ZSwgY29uZmlnLCBzdHlsZV0pO1xuICAgIGNvbnN0IG91dGVyID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiBjYWxjdWxhdGVPdXRlcih7IGNvbmZpZywgbGF5b3V0LCBzY2FsZSB9KTtcbiAgICB9LCBbY29uZmlnLCBsYXlvdXQsIHNjYWxlXSk7XG4gICAgY29uc3QgY29udGFpbmVyU3R5bGUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZUNvbnRhaW5lclN0eWxlKHsgY2FudmFzU2l6ZSwgY29uZmlnLCBsYXlvdXQsIHNjYWxlIH0pO1xuICAgIH0sIFtjYW52YXNTaXplLCBjb25maWcsIGxheW91dCwgc2NhbGVdKTtcbiAgICBjb25zdCBvbkVycm9yID0gdXNlQ2FsbGJhY2soKGVycm9yKSA9PiB7XG4gICAgICAgIHBsYXllci5wYXVzZSgpO1xuICAgICAgICAvLyBQYXkgYXR0ZW50aW9uIHRvIGB0aGlzIGNvbnRleHRgXG4gICAgICAgIHBsYXllci5lbWl0dGVyLmRpc3BhdGNoRXJyb3IoZXJyb3IpO1xuICAgIH0sIFtwbGF5ZXJdKTtcbiAgICBjb25zdCBvbkZ1bGxzY3JlZW5CdXR0b25DbGljayA9IHVzZUNhbGxiYWNrKChlKSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gICAgfSwgW3JlcXVlc3RGdWxsc2NyZWVuXSk7XG4gICAgY29uc3Qgb25FeGl0RnVsbHNjcmVlbkJ1dHRvbkNsaWNrID0gdXNlQ2FsbGJhY2soKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXhpdEZ1bGxzY3JlZW4oKTtcbiAgICB9LCBbZXhpdEZ1bGxzY3JlZW5dKTtcbiAgICBjb25zdCBvblNpbmdsZUNsaWNrID0gdXNlQ2FsbGJhY2soKGUpID0+IHtcbiAgICAgICAgdG9nZ2xlKGUpO1xuICAgIH0sIFt0b2dnbGVdKTtcbiAgICBjb25zdCBvblNlZWtTdGFydCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgc2V0U2Vla2luZyh0cnVlKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3Qgb25TZWVrRW5kID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBzZXRTZWVraW5nKGZhbHNlKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3Qgb25Eb3VibGVDbGljayA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgaWYgKGlzRnVsbHNjcmVlbikge1xuICAgICAgICAgICAgZXhpdEZ1bGxzY3JlZW4oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gICAgICAgIH1cbiAgICB9LCBbZXhpdEZ1bGxzY3JlZW4sIGlzRnVsbHNjcmVlbiwgcmVxdWVzdEZ1bGxzY3JlZW5dKTtcbiAgICBjb25zdCBbaGFuZGxlQ2xpY2ssIGhhbmRsZURvdWJsZUNsaWNrXSA9IHVzZUNsaWNrUHJldmVudGlvbk9uRG91YmxlQ2xpY2sob25TaW5nbGVDbGljaywgb25Eb3VibGVDbGljaywgZG91YmxlQ2xpY2tUb0Z1bGxzY3JlZW4pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChzaG91bGRBdXRvcGxheSkge1xuICAgICAgICAgICAgcGxheWVyLnBsYXkoKTtcbiAgICAgICAgICAgIHNldFNob3VsZEF1dG9QbGF5KGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0sIFtzaG91bGRBdXRvcGxheSwgcGxheWVyXSk7XG4gICAgY29uc3QgbG9hZGluZ01hcmt1cCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4gcmVuZGVyTG9hZGluZ1xuICAgICAgICAgICAgPyByZW5kZXJMb2FkaW5nKHtcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IG91dGVyU3R5bGUuaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHdpZHRoOiBvdXRlclN0eWxlLndpZHRoLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICB9LCBbb3V0ZXJTdHlsZS5oZWlnaHQsIG91dGVyU3R5bGUud2lkdGgsIHJlbmRlckxvYWRpbmddKTtcbiAgICBpZiAoIWNvbmZpZykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgcG9zdGVyID0gcmVuZGVyUG9zdGVyXG4gICAgICAgID8gcmVuZGVyUG9zdGVyKHtcbiAgICAgICAgICAgIGhlaWdodDogb3V0ZXJTdHlsZS5oZWlnaHQsXG4gICAgICAgICAgICB3aWR0aDogb3V0ZXJTdHlsZS53aWR0aCxcbiAgICAgICAgfSlcbiAgICAgICAgOiBudWxsO1xuICAgIGlmIChwb3N0ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdyZW5kZXJQb3N0ZXIoKSBtdXN0IHJldHVybiBhIFJlYWN0IGVsZW1lbnQsIGJ1dCB1bmRlZmluZWQgd2FzIHJldHVybmVkJyk7XG4gICAgfVxuICAgIGNvbnN0IHNob3VsZFNob3dQb3N0ZXIgPSBwb3N0ZXIgJiZcbiAgICAgICAgW1xuICAgICAgICAgICAgc2hvd1Bvc3RlcldoZW5QYXVzZWQgJiYgIXBsYXllci5pc1BsYXlpbmcoKSAmJiAhc2Vla2luZyxcbiAgICAgICAgICAgIHNob3dQb3N0ZXJXaGVuRW5kZWQgJiYgcGxheWVyLmlzTGFzdEZyYW1lICYmICFwbGF5ZXIuaXNQbGF5aW5nKCksXG4gICAgICAgICAgICBzaG93UG9zdGVyV2hlblVucGxheWVkICYmICFwbGF5ZXIuaGFzUGxheWVkICYmICFwbGF5ZXIuaXNQbGF5aW5nKCksXG4gICAgICAgIF0uc29tZShCb29sZWFuKTtcbiAgICBjb25zdCBjb250ZW50ID0gKGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtqc3goXCJkaXZcIiwgeyBzdHlsZTogb3V0ZXIsIG9uQ2xpY2s6IGNsaWNrVG9QbGF5ID8gaGFuZGxlQ2xpY2sgOiB1bmRlZmluZWQsIG9uRG91YmxlQ2xpY2s6IGRvdWJsZUNsaWNrVG9GdWxsc2NyZWVuID8gaGFuZGxlRG91YmxlQ2xpY2sgOiB1bmRlZmluZWQsIGNoaWxkcmVuOiBqc3goXCJkaXZcIiwgeyBzdHlsZTogY29udGFpbmVyU3R5bGUsIGNsYXNzTmFtZTogUExBWUVSX0NTU19DTEFTU05BTUUsIGNoaWxkcmVuOiBWaWRlb0NvbXBvbmVudCA/IChqc3goRXJyb3JCb3VuZGFyeSwgeyBvbkVycm9yOiBvbkVycm9yLCBlcnJvckZhbGxiYWNrOiBlcnJvckZhbGxiYWNrLCBjaGlsZHJlbjoganN4KEludGVybmFscy5DbGlwQ29tcG9zaXRpb24sIHsgY2hpbGRyZW46IGpzeChWaWRlb0NvbXBvbmVudCwgeyAuLi4oKF9jID0gdmlkZW8gPT09IG51bGwgfHwgdmlkZW8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZpZGVvLnByb3BzKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiB7fSksIC4uLihpbnB1dFByb3BzICE9PSBudWxsICYmIGlucHV0UHJvcHMgIT09IHZvaWQgMCA/IGlucHV0UHJvcHMgOiB7fSkgfSkgfSkgfSkpIDogbnVsbCB9KSB9KSwgc2hvdWxkU2hvd1Bvc3RlciA/IChqc3goXCJkaXZcIiwgeyBzdHlsZTogb3V0ZXIsIG9uQ2xpY2s6IGNsaWNrVG9QbGF5ID8gaGFuZGxlQ2xpY2sgOiB1bmRlZmluZWQsIG9uRG91YmxlQ2xpY2s6IGRvdWJsZUNsaWNrVG9GdWxsc2NyZWVuID8gaGFuZGxlRG91YmxlQ2xpY2sgOiB1bmRlZmluZWQsIGNoaWxkcmVuOiBwb3N0ZXIgfSkpIDogbnVsbCwgY29udHJvbHMgPyAoanN4KENvbnRyb2xzLCB7IGZwczogY29uZmlnLmZwcywgZHVyYXRpb25JbkZyYW1lczogY29uZmlnLmR1cmF0aW9uSW5GcmFtZXMsIHBsYXllcjogcGxheWVyLCBjb250YWluZXJSZWY6IGNvbnRhaW5lciwgb25GdWxsc2NyZWVuQnV0dG9uQ2xpY2s6IG9uRnVsbHNjcmVlbkJ1dHRvbkNsaWNrLCBpc0Z1bGxzY3JlZW46IGlzRnVsbHNjcmVlbiwgYWxsb3dGdWxsc2NyZWVuOiBhbGxvd0Z1bGxzY3JlZW4sIHNob3dWb2x1bWVDb250cm9sczogc2hvd1ZvbHVtZUNvbnRyb2xzLCBvbkV4aXRGdWxsc2NyZWVuQnV0dG9uQ2xpY2s6IG9uRXhpdEZ1bGxzY3JlZW5CdXR0b25DbGljaywgc3BhY2VLZXlUb1BsYXlPclBhdXNlOiBzcGFjZUtleVRvUGxheU9yUGF1c2UsIG9uU2Vla0VuZDogb25TZWVrRW5kLCBvblNlZWtTdGFydDogb25TZWVrU3RhcnQsIGluRnJhbWU6IGluRnJhbWUsIG91dEZyYW1lOiBvdXRGcmFtZSwgaW5pdGlhbGx5U2hvd0NvbnRyb2xzOiBpbml0aWFsbHlTaG93Q29udHJvbHMsIGNhbnZhc1NpemU6IGNhbnZhc1NpemUsIHJlbmRlckZ1bGxzY3JlZW5CdXR0b246IHJlbmRlckZ1bGxzY3JlZW5CdXR0b24sIHJlbmRlclBsYXlQYXVzZUJ1dHRvbjogcmVuZGVyUGxheVBhdXNlQnV0dG9uLCBhbHdheXNTaG93Q29udHJvbHM6IGFsd2F5c1Nob3dDb250cm9scywgc2hvd1BsYXliYWNrUmF0ZUNvbnRyb2w6IHNob3dQbGF5YmFja1JhdGVDb250cm9sIH0pKSA6IG51bGxdIH0pKTtcbiAgICBpZiAoSVNfTk9ERSAmJiAhZG9lc1JlYWN0VmVyc2lvblN1cHBvcnRTdXNwZW5zZSQxKSB7XG4gICAgICAgIHJldHVybiAoanN4KFwiZGl2XCIsIHsgcmVmOiBjb250YWluZXIsIHN0eWxlOiBvdXRlclN0eWxlLCBjbGFzc05hbWU6IGNsYXNzTmFtZSwgY2hpbGRyZW46IGNvbnRlbnQgfSkpO1xuICAgIH1cbiAgICByZXR1cm4gKGpzeChcImRpdlwiLCB7IHJlZjogY29udGFpbmVyLCBzdHlsZTogb3V0ZXJTdHlsZSwgY2xhc3NOYW1lOiBjbGFzc05hbWUsIGNoaWxkcmVuOiBqc3goU3VzcGVuc2UsIHsgZmFsbGJhY2s6IGxvYWRpbmdNYXJrdXAsIGNoaWxkcmVuOiBjb250ZW50IH0pIH0pKTtcbn07XG52YXIgUGxheWVyVUkkMSA9IGZvcndhcmRSZWYoUGxheWVyVUkpO1xuXG5jb25zdCBWT0xVTUVfUEVSU0lTVEFOQ0VfS0VZID0gJ3JlbW90aW9uLnZvbHVtZVByZWZlcmVuY2UnO1xuY29uc3QgcGVyc2lzdFZvbHVtZSA9ICh2b2x1bWUpID0+IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oVk9MVU1FX1BFUlNJU1RBTkNFX0tFWSwgU3RyaW5nKHZvbHVtZSkpO1xufTtcbmNvbnN0IGdldFByZWZlcnJlZFZvbHVtZSA9ICgpID0+IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGNvbnN0IHZhbCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShWT0xVTUVfUEVSU0lTVEFOQ0VfS0VZKTtcbiAgICByZXR1cm4gdmFsID8gTnVtYmVyKHZhbCkgOiAxO1xufTtcblxuY29uc3QgUExBWUVSX0NPTVBfSUQgPSAncGxheWVyLWNvbXAnO1xuY29uc3QgU2hhcmVkUGxheWVyQ29udGV4dHMgPSAoeyBjaGlsZHJlbiwgdGltZWxpbmVDb250ZXh0LCBmcHMsIGNvbXBvc2l0aW9uSGVpZ2h0LCBjb21wb3NpdGlvbldpZHRoLCBkdXJhdGlvbkluRnJhbWVzLCBjb21wb25lbnQsIG51bWJlck9mU2hhcmVkQXVkaW9UYWdzLCBpbml0aWFsbHlNdXRlZCwgfSkgPT4ge1xuICAgIGNvbnN0IGNvbXBvc2l0aW9uTWFuYWdlckNvbnRleHQgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IHtcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50OiBjb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uSW5GcmFtZXMsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogY29tcG9zaXRpb25IZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBjb21wb3NpdGlvbldpZHRoLFxuICAgICAgICAgICAgICAgICAgICBmcHMsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBQTEFZRVJfQ09NUF9JRCxcbiAgICAgICAgICAgICAgICAgICAgbm9uY2U6IDc3NyxcbiAgICAgICAgICAgICAgICAgICAgZm9sZGVyTmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Rm9sZGVyTmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVNZXRhZGF0YTogbnVsbCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGZvbGRlcnM6IFtdLFxuICAgICAgICAgICAgcmVnaXN0ZXJGb2xkZXI6ICgpID0+IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHVucmVnaXN0ZXJGb2xkZXI6ICgpID0+IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHJlZ2lzdGVyQ29tcG9zaXRpb246ICgpID0+IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHVucmVnaXN0ZXJDb21wb3NpdGlvbjogKCkgPT4gdW5kZWZpbmVkLFxuICAgICAgICAgICAgY3VycmVudENvbXBvc2l0aW9uTWV0YWRhdGE6IG51bGwsXG4gICAgICAgICAgICBzZXRDdXJyZW50Q29tcG9zaXRpb25NZXRhZGF0YTogKCkgPT4gdW5kZWZpbmVkLFxuICAgICAgICAgICAgY2FudmFzQ29udGVudDogeyB0eXBlOiAnY29tcG9zaXRpb24nLCBjb21wb3NpdGlvbklkOiAncGxheWVyLWNvbXAnIH0sXG4gICAgICAgICAgICBzZXRDYW52YXNDb250ZW50OiAoKSA9PiB1bmRlZmluZWQsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH0sIFtjb21wb25lbnQsIGR1cmF0aW9uSW5GcmFtZXMsIGNvbXBvc2l0aW9uSGVpZ2h0LCBjb21wb3NpdGlvbldpZHRoLCBmcHNdKTtcbiAgICBjb25zdCBbbWVkaWFNdXRlZCwgc2V0TWVkaWFNdXRlZF0gPSB1c2VTdGF0ZSgoKSA9PiBpbml0aWFsbHlNdXRlZCk7XG4gICAgY29uc3QgW21lZGlhVm9sdW1lLCBzZXRNZWRpYVZvbHVtZV0gPSB1c2VTdGF0ZSgoKSA9PiBnZXRQcmVmZXJyZWRWb2x1bWUoKSk7XG4gICAgY29uc3QgbWVkaWFWb2x1bWVDb250ZXh0VmFsdWUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lZGlhTXV0ZWQsXG4gICAgICAgICAgICBtZWRpYVZvbHVtZSxcbiAgICAgICAgfTtcbiAgICB9LCBbbWVkaWFNdXRlZCwgbWVkaWFWb2x1bWVdKTtcbiAgICBjb25zdCBzZXRNZWRpYVZvbHVtZUFuZFBlcnNpc3QgPSB1c2VDYWxsYmFjaygodm9sKSA9PiB7XG4gICAgICAgIHNldE1lZGlhVm9sdW1lKHZvbCk7XG4gICAgICAgIHBlcnNpc3RWb2x1bWUodm9sKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3Qgc2V0TWVkaWFWb2x1bWVDb250ZXh0VmFsdWUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNldE1lZGlhTXV0ZWQsXG4gICAgICAgICAgICBzZXRNZWRpYVZvbHVtZTogc2V0TWVkaWFWb2x1bWVBbmRQZXJzaXN0LFxuICAgICAgICB9O1xuICAgIH0sIFtzZXRNZWRpYVZvbHVtZUFuZFBlcnNpc3RdKTtcbiAgICByZXR1cm4gKGpzeChJbnRlcm5hbHMuQ2FuVXNlUmVtb3Rpb25Ib29rc1Byb3ZpZGVyLCB7IGNoaWxkcmVuOiBqc3goSW50ZXJuYWxzLlRpbWVsaW5lLlRpbWVsaW5lQ29udGV4dC5Qcm92aWRlciwgeyB2YWx1ZTogdGltZWxpbmVDb250ZXh0LCBjaGlsZHJlbjoganN4KEludGVybmFscy5Db21wb3NpdGlvbk1hbmFnZXIuUHJvdmlkZXIsIHsgdmFsdWU6IGNvbXBvc2l0aW9uTWFuYWdlckNvbnRleHQsIGNoaWxkcmVuOiBqc3goSW50ZXJuYWxzLlJlc29sdmVDb21wb3NpdGlvbkNvbmZpZywgeyBjaGlsZHJlbjoganN4KEludGVybmFscy5QcmVmZXRjaFByb3ZpZGVyLCB7IGNoaWxkcmVuOiBqc3goSW50ZXJuYWxzLkR1cmF0aW9uc0NvbnRleHRQcm92aWRlciwgeyBjaGlsZHJlbjoganN4KEludGVybmFscy5NZWRpYVZvbHVtZUNvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IG1lZGlhVm9sdW1lQ29udGV4dFZhbHVlLCBjaGlsZHJlbjoganN4KEludGVybmFscy5OYXRpdmVMYXllcnNQcm92aWRlciwgeyBjaGlsZHJlbjoganN4KEludGVybmFscy5TZXRNZWRpYVZvbHVtZUNvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IHNldE1lZGlhVm9sdW1lQ29udGV4dFZhbHVlLCBjaGlsZHJlbjoganN4KEludGVybmFscy5TaGFyZWRBdWRpb0NvbnRleHRQcm92aWRlciwgeyBudW1iZXJPZkF1ZGlvVGFnczogbnVtYmVyT2ZTaGFyZWRBdWRpb1RhZ3MsIGNvbXBvbmVudDogY29tcG9uZW50LCBjaGlsZHJlbjogY2hpbGRyZW4gfSkgfSkgfSkgfSkgfSkgfSkgfSkgfSkgfSkgfSkpO1xufTtcblxuY29uc3QgdmFsaWRhdGVTaW5nbGVGcmFtZSA9IChmcmFtZSwgdmFyaWFibGVOYW1lKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBmcmFtZSA9PT0gJ3VuZGVmaW5lZCcgfHwgZnJhbWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZyYW1lICE9PSBudWxsICYmIGZyYW1lICE9PSB2b2lkIDAgPyBmcmFtZSA6IG51bGw7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZnJhbWUgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYFwiJHt2YXJpYWJsZU5hbWV9XCIgbXVzdCBiZSBhIG51bWJlciwgYnV0IGlzICR7SlNPTi5zdHJpbmdpZnkoZnJhbWUpfWApO1xuICAgIH1cbiAgICBpZiAoTnVtYmVyLmlzTmFOKGZyYW1lKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBcIiR7dmFyaWFibGVOYW1lfVwiIG11c3Qgbm90IGJlIE5hTiwgYnV0IGlzICR7SlNPTi5zdHJpbmdpZnkoZnJhbWUpfWApO1xuICAgIH1cbiAgICBpZiAoIU51bWJlci5pc0Zpbml0ZShmcmFtZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgXCIke3ZhcmlhYmxlTmFtZX1cIiBtdXN0IGJlIGZpbml0ZSwgYnV0IGlzICR7SlNPTi5zdHJpbmdpZnkoZnJhbWUpfWApO1xuICAgIH1cbiAgICBpZiAoZnJhbWUgJSAxICE9PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYFwiJHt2YXJpYWJsZU5hbWV9XCIgbXVzdCBiZSBhbiBpbnRlZ2VyLCBidXQgaXMgJHtKU09OLnN0cmluZ2lmeShmcmFtZSl9YCk7XG4gICAgfVxuICAgIHJldHVybiBmcmFtZTtcbn07XG5jb25zdCB2YWxpZGF0ZUluT3V0RnJhbWVzID0gKHsgaW5GcmFtZSwgZHVyYXRpb25JbkZyYW1lcywgb3V0RnJhbWUsIH0pID0+IHtcbiAgICBjb25zdCB2YWxpZGF0ZWRJbkZyYW1lID0gdmFsaWRhdGVTaW5nbGVGcmFtZShpbkZyYW1lLCAnaW5GcmFtZScpO1xuICAgIGNvbnN0IHZhbGlkYXRlZE91dEZyYW1lID0gdmFsaWRhdGVTaW5nbGVGcmFtZShvdXRGcmFtZSwgJ291dEZyYW1lJyk7XG4gICAgaWYgKHZhbGlkYXRlZEluRnJhbWUgPT09IG51bGwgJiYgdmFsaWRhdGVkT3V0RnJhbWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBNdXN0IG5vdCBiZSBvdmVyIHRoZSBkdXJhdGlvblxuICAgIGlmICh2YWxpZGF0ZWRJbkZyYW1lICE9PSBudWxsICYmIHZhbGlkYXRlZEluRnJhbWUgPiBkdXJhdGlvbkluRnJhbWVzIC0gMSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luRnJhbWUgbXVzdCBiZSBsZXNzIHRoYW4gKGR1cmF0aW9uSW5GcmFtZXMgLSAxKSwgYnV0IGlzICcgK1xuICAgICAgICAgICAgdmFsaWRhdGVkSW5GcmFtZSk7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0ZWRPdXRGcmFtZSAhPT0gbnVsbCAmJiB2YWxpZGF0ZWRPdXRGcmFtZSA+IGR1cmF0aW9uSW5GcmFtZXMgLSAxKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignb3V0RnJhbWUgbXVzdCBiZSBsZXNzIHRoYW4gKGR1cmF0aW9uSW5GcmFtZXMgLSAxKSwgYnV0IGlzICcgK1xuICAgICAgICAgICAgdmFsaWRhdGVkT3V0RnJhbWUpO1xuICAgIH1cbiAgICAvLyBNdXN0IG5vdCBiZSB1bmRlciAwXG4gICAgaWYgKHZhbGlkYXRlZEluRnJhbWUgIT09IG51bGwgJiYgdmFsaWRhdGVkSW5GcmFtZSA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbkZyYW1lIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAsIGJ1dCBpcyAnICsgdmFsaWRhdGVkSW5GcmFtZSk7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0ZWRPdXRGcmFtZSAhPT0gbnVsbCAmJiB2YWxpZGF0ZWRPdXRGcmFtZSA8PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgb3V0RnJhbWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCwgYnV0IGlzICR7dmFsaWRhdGVkT3V0RnJhbWV9LiBJZiB5b3Ugd2FudCB0byByZW5kZXIgYSBzaW5nbGUgZnJhbWUsIHVzZSA8VGh1bWJuYWlsIC8+IGluc3RlYWQuYCk7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0ZWRPdXRGcmFtZSAhPT0gbnVsbCAmJlxuICAgICAgICB2YWxpZGF0ZWRJbkZyYW1lICE9PSBudWxsICYmXG4gICAgICAgIHZhbGlkYXRlZE91dEZyYW1lIDw9IHZhbGlkYXRlZEluRnJhbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdvdXRGcmFtZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBpbkZyYW1lLCBidXQgaXMgJyArXG4gICAgICAgICAgICB2YWxpZGF0ZWRPdXRGcmFtZSArXG4gICAgICAgICAgICAnIDw9ICcgK1xuICAgICAgICAgICAgdmFsaWRhdGVkSW5GcmFtZSk7XG4gICAgfVxufTtcblxuY29uc3QgdmFsaWRhdGVJbml0aWFsRnJhbWUgPSAoeyBpbml0aWFsRnJhbWUsIGR1cmF0aW9uSW5GcmFtZXMsIH0pID0+IHtcbiAgICBpZiAodHlwZW9mIGR1cmF0aW9uSW5GcmFtZXMgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgXFxgZHVyYXRpb25JbkZyYW1lc1xcYCBtdXN0IGJlIGEgbnVtYmVyLCBidXQgaXMgJHtKU09OLnN0cmluZ2lmeShkdXJhdGlvbkluRnJhbWVzKX1gKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBpbml0aWFsRnJhbWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBpbml0aWFsRnJhbWUgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgXFxgaW5pdGlhbEZyYW1lXFxgIG11c3QgYmUgYSBudW1iZXIsIGJ1dCBpcyAke0pTT04uc3RyaW5naWZ5KGluaXRpYWxGcmFtZSl9YCk7XG4gICAgfVxuICAgIGlmIChOdW1iZXIuaXNOYU4oaW5pdGlhbEZyYW1lKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFxcYGluaXRpYWxGcmFtZVxcYCBtdXN0IGJlIGEgbnVtYmVyLCBidXQgaXMgTmFOYCk7XG4gICAgfVxuICAgIGlmICghTnVtYmVyLmlzRmluaXRlKGluaXRpYWxGcmFtZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBcXGBpbml0aWFsRnJhbWVcXGAgbXVzdCBiZSBhIG51bWJlciwgYnV0IGlzIEluZmluaXR5YCk7XG4gICAgfVxuICAgIGlmIChpbml0aWFsRnJhbWUgJSAxICE9PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgXFxgaW5pdGlhbEZyYW1lXFxgIG11c3QgYmUgYW4gaW50ZWdlciwgYnV0IGlzICR7SlNPTi5zdHJpbmdpZnkoaW5pdGlhbEZyYW1lKX1gKTtcbiAgICB9XG4gICAgaWYgKGluaXRpYWxGcmFtZSA+IGR1cmF0aW9uSW5GcmFtZXMgLSAxKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgXFxgaW5pdGlhbEZyYW1lXFxgIG11c3QgYmUgbGVzcyBvciBlcXVhbCB0aGFuIFxcYGR1cmF0aW9uSW5GcmFtZXMgLSAxXFxgLCBidXQgaXMgJHtKU09OLnN0cmluZ2lmeShpbml0aWFsRnJhbWUpfWApO1xuICAgIH1cbn07XG5cbmNvbnN0IHZhbGlkYXRlUGxheWJhY2tSYXRlID0gKHBsYXliYWNrUmF0ZSkgPT4ge1xuICAgIGlmIChwbGF5YmFja1JhdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChwbGF5YmFja1JhdGUgPiA0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGhpZ2hlc3QgcG9zc2libGUgcGxheWJhY2sgcmF0ZSBpcyA0LiBZb3UgcGFzc2VkOiAke3BsYXliYWNrUmF0ZX1gKTtcbiAgICB9XG4gICAgaWYgKHBsYXliYWNrUmF0ZSA8IC00KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGxvd2VzdCBwb3NzaWJsZSBwbGF5YmFjayByYXRlIGlzIC00LiBZb3UgcGFzc2VkOiAke3BsYXliYWNrUmF0ZX1gKTtcbiAgICB9XG4gICAgaWYgKHBsYXliYWNrUmF0ZSA9PT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEEgcGxheWJhY2sgcmF0ZSBvZiAwIGlzIG5vdCBzdXBwb3J0ZWQuYCk7XG4gICAgfVxufTtcblxuLyogZXNsaW50LWRpc2FibGUgcHJlZmVyLWRlc3RydWN0dXJpbmcgKi9cbmNvbnN0IHZhbGlkYXRlRnBzID0gSW50ZXJuYWxzLnZhbGlkYXRlRnBzO1xuY29uc3QgdmFsaWRhdGVEaW1lbnNpb24gPSBJbnRlcm5hbHMudmFsaWRhdGVEaW1lbnNpb247XG5jb25zdCB2YWxpZGF0ZUR1cmF0aW9uSW5GcmFtZXMgPSBJbnRlcm5hbHMudmFsaWRhdGVEdXJhdGlvbkluRnJhbWVzO1xuY29uc3QgdmFsaWRhdGVEZWZhdWx0QW5kSW5wdXRQcm9wcyA9IEludGVybmFscy52YWxpZGF0ZURlZmF1bHRBbmRJbnB1dFByb3BzO1xuXG5jb25zdCBjb21wb25lbnRPck51bGxJZkxhenkgPSAocHJvcHMpID0+IHtcbiAgICBpZiAoJ2NvbXBvbmVudCcgaW4gcHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIHByb3BzLmNvbXBvbmVudDtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59O1xuY29uc3QgUGxheWVyRm4gPSAoeyBkdXJhdGlvbkluRnJhbWVzLCBjb21wb3NpdGlvbkhlaWdodCwgY29tcG9zaXRpb25XaWR0aCwgZnBzLCBpbnB1dFByb3BzLCBzdHlsZSwgY29udHJvbHMgPSBmYWxzZSwgbG9vcCA9IGZhbHNlLCBhdXRvUGxheSA9IGZhbHNlLCBzaG93Vm9sdW1lQ29udHJvbHMgPSB0cnVlLCBhbGxvd0Z1bGxzY3JlZW4gPSB0cnVlLCBjbGlja1RvUGxheSwgZG91YmxlQ2xpY2tUb0Z1bGxzY3JlZW4gPSBmYWxzZSwgc3BhY2VLZXlUb1BsYXlPclBhdXNlID0gdHJ1ZSwgbW92ZVRvQmVnaW5uaW5nV2hlbkVuZGVkID0gdHJ1ZSwgbnVtYmVyT2ZTaGFyZWRBdWRpb1RhZ3MgPSA1LCBlcnJvckZhbGxiYWNrID0gKCkgPT4gJ+KaoO+4jycsIHBsYXliYWNrUmF0ZSA9IDEsIHJlbmRlckxvYWRpbmcsIGNsYXNzTmFtZSwgc2hvd1Bvc3RlcldoZW5VbnBsYXllZCwgc2hvd1Bvc3RlcldoZW5FbmRlZCwgc2hvd1Bvc3RlcldoZW5QYXVzZWQsIGluaXRpYWxGcmFtZSwgcmVuZGVyUG9zdGVyLCBpbkZyYW1lLCBvdXRGcmFtZSwgaW5pdGlhbGx5U2hvd0NvbnRyb2xzLCByZW5kZXJGdWxsc2NyZWVuQnV0dG9uLCByZW5kZXJQbGF5UGF1c2VCdXR0b24sIGFsd2F5c1Nob3dDb250cm9scyA9IGZhbHNlLCBpbml0aWFsbHlNdXRlZCA9IGZhbHNlLCBzaG93UGxheWJhY2tSYXRlQ29udHJvbCA9IGZhbHNlLCAuLi5jb21wb25lbnRQcm9wcyB9LCByZWYpID0+IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gICAgICAgIHVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3Rpb25faXNQbGF5ZXIgPSB0cnVlO1xuICAgICAgICB9LCBbXSk7XG4gICAgfVxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICBpZiAoY29tcG9uZW50UHJvcHMuZGVmYXVsdFByb3BzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgPFBsYXllciAvPiBjb21wb25lbnQgZG9lcyBub3QgYWNjZXB0IGBkZWZhdWx0UHJvcHNgLCBidXQgc29tZSB3ZXJlIHBhc3NlZC4gVXNlIGBpbnB1dFByb3BzYCBpbnN0ZWFkLicpO1xuICAgIH1cbiAgICBjb25zdCBjb21wb25lbnRGb3JWYWxpZGF0aW9uID0gY29tcG9uZW50T3JOdWxsSWZMYXp5KGNvbXBvbmVudFByb3BzKTtcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgaWYgKChjb21wb25lbnRGb3JWYWxpZGF0aW9uID09PSBudWxsIHx8IGNvbXBvbmVudEZvclZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbXBvbmVudEZvclZhbGlkYXRpb24udHlwZSkgPT09IENvbXBvc2l0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCdjb21wb25lbnQnIHNob3VsZCBub3QgYmUgYW4gaW5zdGFuY2Ugb2YgPENvbXBvc2l0aW9uLz4uIFBhc3MgdGhlIFJlYWN0IGNvbXBvbmVudCBkaXJlY3RseSwgYW5kIHNldCB0aGUgZHVyYXRpb24sIGZwcyBhbmQgZGltZW5zaW9ucyBhcyBzZXBhcmF0ZSBwcm9wcy4gU2VlIGh0dHBzOi8vd3d3LnJlbW90aW9uLmRldi9kb2NzL3BsYXllci9leGFtcGxlcyBmb3IgYW4gZXhhbXBsZS5gKTtcbiAgICB9XG4gICAgaWYgKGNvbXBvbmVudEZvclZhbGlkYXRpb24gPT09IENvbXBvc2l0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCdjb21wb25lbnQnIG11c3Qgbm90IGJlIHRoZSAnQ29tcG9zaXRpb24nIGNvbXBvbmVudC4gUGFzcyB5b3VyIG93biBSZWFjdCBjb21wb25lbnQgZGlyZWN0bHksIGFuZCBzZXQgdGhlIGR1cmF0aW9uLCBmcHMgYW5kIGRpbWVuc2lvbnMgYXMgc2VwYXJhdGUgcHJvcHMuIFNlZSBodHRwczovL3d3dy5yZW1vdGlvbi5kZXYvZG9jcy9wbGF5ZXIvZXhhbXBsZXMgZm9yIGFuIGV4YW1wbGUuYCk7XG4gICAgfVxuICAgIGNvbnN0IGNvbXBvbmVudCA9IEludGVybmFscy51c2VMYXp5Q29tcG9uZW50KGNvbXBvbmVudFByb3BzKTtcbiAgICB2YWxpZGF0ZUluaXRpYWxGcmFtZSh7IGluaXRpYWxGcmFtZSwgZHVyYXRpb25JbkZyYW1lcyB9KTtcbiAgICBjb25zdCBbZnJhbWUsIHNldEZyYW1lXSA9IHVzZVN0YXRlKCgpID0+ICh7XG4gICAgICAgIFtQTEFZRVJfQ09NUF9JRF06IGluaXRpYWxGcmFtZSAhPT0gbnVsbCAmJiBpbml0aWFsRnJhbWUgIT09IHZvaWQgMCA/IGluaXRpYWxGcmFtZSA6IDAsXG4gICAgfSkpO1xuICAgIGNvbnN0IFtwbGF5aW5nLCBzZXRQbGF5aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbcm9vdElkXSA9IHVzZVN0YXRlKCdwbGF5ZXItY29tcCcpO1xuICAgIGNvbnN0IFtlbWl0dGVyXSA9IHVzZVN0YXRlKCgpID0+IG5ldyBQbGF5ZXJFbWl0dGVyKCkpO1xuICAgIGNvbnN0IHJvb3RSZWYgPSB1c2VSZWYobnVsbCk7XG4gICAgY29uc3QgYXVkaW9BbmRWaWRlb1RhZ3MgPSB1c2VSZWYoW10pO1xuICAgIGNvbnN0IGltcGVyYXRpdmVQbGF5aW5nID0gdXNlUmVmKGZhbHNlKTtcbiAgICBjb25zdCBbY3VycmVudFBsYXliYWNrUmF0ZSwgc2V0Q3VycmVudFBsYXliYWNrUmF0ZV0gPSB1c2VTdGF0ZShwbGF5YmFja1JhdGUpO1xuICAgIGlmICh0eXBlb2YgY29tcG9zaXRpb25IZWlnaHQgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCdjb21wb3NpdGlvbkhlaWdodCcgbXVzdCBiZSBhIG51bWJlciBidXQgZ290ICcke3R5cGVvZiBjb21wb3NpdGlvbkhlaWdodH0nIGluc3RlYWRgKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjb21wb3NpdGlvbldpZHRoICE9PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAnY29tcG9zaXRpb25XaWR0aCcgbXVzdCBiZSBhIG51bWJlciBidXQgZ290ICcke3R5cGVvZiBjb21wb3NpdGlvbldpZHRofScgaW5zdGVhZGApO1xuICAgIH1cbiAgICB2YWxpZGF0ZURpbWVuc2lvbihjb21wb3NpdGlvbkhlaWdodCwgJ2NvbXBvc2l0aW9uSGVpZ2h0JywgJ29mIHRoZSA8UGxheWVyIC8+IGNvbXBvbmVudCcpO1xuICAgIHZhbGlkYXRlRGltZW5zaW9uKGNvbXBvc2l0aW9uV2lkdGgsICdjb21wb3NpdGlvbldpZHRoJywgJ29mIHRoZSA8UGxheWVyIC8+IGNvbXBvbmVudCcpO1xuICAgIHZhbGlkYXRlRHVyYXRpb25JbkZyYW1lcyhkdXJhdGlvbkluRnJhbWVzLCB7XG4gICAgICAgIGNvbXBvbmVudDogJ29mIHRoZSA8UGxheWVyLz4gY29tcG9uZW50JyxcbiAgICAgICAgYWxsb3dGbG9hdHM6IGZhbHNlLFxuICAgIH0pO1xuICAgIHZhbGlkYXRlRnBzKGZwcywgJ2FzIGEgcHJvcCBvZiB0aGUgPFBsYXllci8+IGNvbXBvbmVudCcsIGZhbHNlKTtcbiAgICB2YWxpZGF0ZURlZmF1bHRBbmRJbnB1dFByb3BzKGlucHV0UHJvcHMsICdpbnB1dFByb3BzJywgbnVsbCk7XG4gICAgdmFsaWRhdGVJbk91dEZyYW1lcyh7XG4gICAgICAgIGR1cmF0aW9uSW5GcmFtZXMsXG4gICAgICAgIGluRnJhbWUsXG4gICAgICAgIG91dEZyYW1lLFxuICAgIH0pO1xuICAgIGlmICh0eXBlb2YgY29udHJvbHMgIT09ICdib29sZWFuJyAmJiB0eXBlb2YgY29udHJvbHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCdjb250cm9scycgbXVzdCBiZSBhIGJvb2xlYW4gb3IgdW5kZWZpbmVkIGJ1dCBnb3QgJyR7dHlwZW9mIGNvbnRyb2xzfScgaW5zdGVhZGApO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGF1dG9QbGF5ICE9PSAnYm9vbGVhbicgJiYgdHlwZW9mIGF1dG9QbGF5ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAnYXV0b1BsYXknIG11c3QgYmUgYSBib29sZWFuIG9yIHVuZGVmaW5lZCBidXQgZ290ICcke3R5cGVvZiBhdXRvUGxheX0nIGluc3RlYWRgKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBsb29wICE9PSAnYm9vbGVhbicgJiYgdHlwZW9mIGxvb3AgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCdsb29wJyBtdXN0IGJlIGEgYm9vbGVhbiBvciB1bmRlZmluZWQgYnV0IGdvdCAnJHt0eXBlb2YgbG9vcH0nIGluc3RlYWRgKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBkb3VibGVDbGlja1RvRnVsbHNjcmVlbiAhPT0gJ2Jvb2xlYW4nICYmXG4gICAgICAgIHR5cGVvZiBkb3VibGVDbGlja1RvRnVsbHNjcmVlbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgJ2RvdWJsZUNsaWNrVG9GdWxsc2NyZWVuJyBtdXN0IGJlIGEgYm9vbGVhbiBvciB1bmRlZmluZWQgYnV0IGdvdCAnJHt0eXBlb2YgZG91YmxlQ2xpY2tUb0Z1bGxzY3JlZW59JyBpbnN0ZWFkYCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2hvd1ZvbHVtZUNvbnRyb2xzICE9PSAnYm9vbGVhbicgJiZcbiAgICAgICAgdHlwZW9mIHNob3dWb2x1bWVDb250cm9scyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgJ3Nob3dWb2x1bWVDb250cm9scycgbXVzdCBiZSBhIGJvb2xlYW4gb3IgdW5kZWZpbmVkIGJ1dCBnb3QgJyR7dHlwZW9mIHNob3dWb2x1bWVDb250cm9sc30nIGluc3RlYWRgKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBhbGxvd0Z1bGxzY3JlZW4gIT09ICdib29sZWFuJyAmJlxuICAgICAgICB0eXBlb2YgYWxsb3dGdWxsc2NyZWVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAnYWxsb3dGdWxsc2NyZWVuJyBtdXN0IGJlIGEgYm9vbGVhbiBvciB1bmRlZmluZWQgYnV0IGdvdCAnJHt0eXBlb2YgYWxsb3dGdWxsc2NyZWVufScgaW5zdGVhZGApO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNsaWNrVG9QbGF5ICE9PSAnYm9vbGVhbicgJiYgdHlwZW9mIGNsaWNrVG9QbGF5ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAnY2xpY2tUb1BsYXknIG11c3QgYmUgYSBib29sZWFuIG9yIHVuZGVmaW5lZCBidXQgZ290ICcke3R5cGVvZiBjbGlja1RvUGxheX0nIGluc3RlYWRgKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBzcGFjZUtleVRvUGxheU9yUGF1c2UgIT09ICdib29sZWFuJyAmJlxuICAgICAgICB0eXBlb2Ygc3BhY2VLZXlUb1BsYXlPclBhdXNlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAnc3BhY2VLZXlUb1BsYXlPclBhdXNlJyBtdXN0IGJlIGEgYm9vbGVhbiBvciB1bmRlZmluZWQgYnV0IGdvdCAnJHt0eXBlb2Ygc3BhY2VLZXlUb1BsYXlPclBhdXNlfScgaW5zdGVhZGApO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG51bWJlck9mU2hhcmVkQXVkaW9UYWdzICE9PSAnbnVtYmVyJyB8fFxuICAgICAgICBudW1iZXJPZlNoYXJlZEF1ZGlvVGFncyAlIDEgIT09IDAgfHxcbiAgICAgICAgIU51bWJlci5pc0Zpbml0ZShudW1iZXJPZlNoYXJlZEF1ZGlvVGFncykgfHxcbiAgICAgICAgTnVtYmVyLmlzTmFOKG51bWJlck9mU2hhcmVkQXVkaW9UYWdzKSB8fFxuICAgICAgICBudW1iZXJPZlNoYXJlZEF1ZGlvVGFncyA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgJ251bWJlck9mU2hhcmVkQXVkaW9UYWdzJyBtdXN0IGJlIGFuIGludGVnZXIgYnV0IGdvdCAnJHtudW1iZXJPZlNoYXJlZEF1ZGlvVGFnc30nIGluc3RlYWRgKTtcbiAgICB9XG4gICAgdmFsaWRhdGVQbGF5YmFja1JhdGUoY3VycmVudFBsYXliYWNrUmF0ZSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgZW1pdHRlci5kaXNwYXRjaFJhdGVDaGFuZ2UoY3VycmVudFBsYXliYWNrUmF0ZSk7XG4gICAgfSwgW2VtaXR0ZXIsIGN1cnJlbnRQbGF5YmFja1JhdGVdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBzZXRDdXJyZW50UGxheWJhY2tSYXRlKHBsYXliYWNrUmF0ZSk7XG4gICAgfSwgW3BsYXliYWNrUmF0ZV0pO1xuICAgIHVzZUltcGVyYXRpdmVIYW5kbGUocmVmLCAoKSA9PiByb290UmVmLmN1cnJlbnQsIFtdKTtcbiAgICBjb25zdCB0aW1lbGluZUNvbnRleHRWYWx1ZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZnJhbWUsXG4gICAgICAgICAgICBwbGF5aW5nLFxuICAgICAgICAgICAgcm9vdElkLFxuICAgICAgICAgICAgcGxheWJhY2tSYXRlOiBjdXJyZW50UGxheWJhY2tSYXRlLFxuICAgICAgICAgICAgaW1wZXJhdGl2ZVBsYXlpbmcsXG4gICAgICAgICAgICBzZXRQbGF5YmFja1JhdGU6IChyYXRlKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0Q3VycmVudFBsYXliYWNrUmF0ZShyYXRlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhdWRpb0FuZFZpZGVvVGFncyxcbiAgICAgICAgfTtcbiAgICB9LCBbZnJhbWUsIGN1cnJlbnRQbGF5YmFja1JhdGUsIHBsYXlpbmcsIHJvb3RJZF0pO1xuICAgIGNvbnN0IHNldFRpbWVsaW5lQ29udGV4dFZhbHVlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZXRGcmFtZSxcbiAgICAgICAgICAgIHNldFBsYXlpbmcsXG4gICAgICAgIH07XG4gICAgfSwgW3NldEZyYW1lXSk7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICAgICAgICB1c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgICAgICAgICAgLy8gSW5qZWN0IENTUyBvbmx5IG9uIGNsaWVudCwgYW5kIGFsc28gb25seSBhZnRlciB0aGUgUGxheWVyIGhhcyBoeWRyYXRlZFxuICAgICAgICAgICAgSW50ZXJuYWxzLkNTU1V0aWxzLmluamVjdENTUyhJbnRlcm5hbHMuQ1NTVXRpbHMubWFrZURlZmF1bHRDU1MoYC4ke1BMQVlFUl9DU1NfQ0xBU1NOQU1FfWAsICcjZmZmJykpO1xuICAgICAgICB9LCBbXSk7XG4gICAgfVxuICAgIGNvbnN0IGFjdHVhbElucHV0UHJvcHMgPSB1c2VNZW1vKCgpID0+IGlucHV0UHJvcHMgIT09IG51bGwgJiYgaW5wdXRQcm9wcyAhPT0gdm9pZCAwID8gaW5wdXRQcm9wcyA6IHt9LCBbaW5wdXRQcm9wc10pO1xuICAgIHJldHVybiAoanN4KEludGVybmFscy5Jc1BsYXllckNvbnRleHRQcm92aWRlciwgeyBjaGlsZHJlbjoganN4KFNoYXJlZFBsYXllckNvbnRleHRzLCB7IHRpbWVsaW5lQ29udGV4dDogdGltZWxpbmVDb250ZXh0VmFsdWUsIGNvbXBvbmVudDogY29tcG9uZW50LCBjb21wb3NpdGlvbkhlaWdodDogY29tcG9zaXRpb25IZWlnaHQsIGNvbXBvc2l0aW9uV2lkdGg6IGNvbXBvc2l0aW9uV2lkdGgsIGR1cmF0aW9uSW5GcmFtZXM6IGR1cmF0aW9uSW5GcmFtZXMsIGZwczogZnBzLCBudW1iZXJPZlNoYXJlZEF1ZGlvVGFnczogbnVtYmVyT2ZTaGFyZWRBdWRpb1RhZ3MsIGluaXRpYWxseU11dGVkOiBpbml0aWFsbHlNdXRlZCwgY2hpbGRyZW46IGpzeChJbnRlcm5hbHMuVGltZWxpbmUuU2V0VGltZWxpbmVDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiBzZXRUaW1lbGluZUNvbnRleHRWYWx1ZSwgY2hpbGRyZW46IGpzeChQbGF5ZXJFdmVudEVtaXR0ZXJDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiBlbWl0dGVyLCBjaGlsZHJlbjoganN4KFBsYXllclVJJDEsIHsgcmVmOiByb290UmVmLCByZW5kZXJMb2FkaW5nOiByZW5kZXJMb2FkaW5nLCBhdXRvUGxheTogQm9vbGVhbihhdXRvUGxheSksIGxvb3A6IEJvb2xlYW4obG9vcCksIGNvbnRyb2xzOiBCb29sZWFuKGNvbnRyb2xzKSwgZXJyb3JGYWxsYmFjazogZXJyb3JGYWxsYmFjaywgc3R5bGU6IHN0eWxlLCBpbnB1dFByb3BzOiBhY3R1YWxJbnB1dFByb3BzLCBhbGxvd0Z1bGxzY3JlZW46IEJvb2xlYW4oYWxsb3dGdWxsc2NyZWVuKSwgbW92ZVRvQmVnaW5uaW5nV2hlbkVuZGVkOiBCb29sZWFuKG1vdmVUb0JlZ2lubmluZ1doZW5FbmRlZCksIGNsaWNrVG9QbGF5OiB0eXBlb2YgY2xpY2tUb1BsYXkgPT09ICdib29sZWFuJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY2xpY2tUb1BsYXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IEJvb2xlYW4oY29udHJvbHMpLCBzaG93Vm9sdW1lQ29udHJvbHM6IEJvb2xlYW4oc2hvd1ZvbHVtZUNvbnRyb2xzKSwgZG91YmxlQ2xpY2tUb0Z1bGxzY3JlZW46IEJvb2xlYW4oZG91YmxlQ2xpY2tUb0Z1bGxzY3JlZW4pLCBzcGFjZUtleVRvUGxheU9yUGF1c2U6IEJvb2xlYW4oc3BhY2VLZXlUb1BsYXlPclBhdXNlKSwgcGxheWJhY2tSYXRlOiBjdXJyZW50UGxheWJhY2tSYXRlLCBjbGFzc05hbWU6IGNsYXNzTmFtZSAhPT0gbnVsbCAmJiBjbGFzc05hbWUgIT09IHZvaWQgMCA/IGNsYXNzTmFtZSA6IHVuZGVmaW5lZCwgc2hvd1Bvc3RlcldoZW5VbnBsYXllZDogQm9vbGVhbihzaG93UG9zdGVyV2hlblVucGxheWVkKSwgc2hvd1Bvc3RlcldoZW5FbmRlZDogQm9vbGVhbihzaG93UG9zdGVyV2hlbkVuZGVkKSwgc2hvd1Bvc3RlcldoZW5QYXVzZWQ6IEJvb2xlYW4oc2hvd1Bvc3RlcldoZW5QYXVzZWQpLCByZW5kZXJQb3N0ZXI6IHJlbmRlclBvc3RlciwgaW5GcmFtZTogaW5GcmFtZSAhPT0gbnVsbCAmJiBpbkZyYW1lICE9PSB2b2lkIDAgPyBpbkZyYW1lIDogbnVsbCwgb3V0RnJhbWU6IG91dEZyYW1lICE9PSBudWxsICYmIG91dEZyYW1lICE9PSB2b2lkIDAgPyBvdXRGcmFtZSA6IG51bGwsIGluaXRpYWxseVNob3dDb250cm9sczogaW5pdGlhbGx5U2hvd0NvbnRyb2xzICE9PSBudWxsICYmIGluaXRpYWxseVNob3dDb250cm9scyAhPT0gdm9pZCAwID8gaW5pdGlhbGx5U2hvd0NvbnRyb2xzIDogdHJ1ZSwgcmVuZGVyRnVsbHNjcmVlbjogcmVuZGVyRnVsbHNjcmVlbkJ1dHRvbiAhPT0gbnVsbCAmJiByZW5kZXJGdWxsc2NyZWVuQnV0dG9uICE9PSB2b2lkIDAgPyByZW5kZXJGdWxsc2NyZWVuQnV0dG9uIDogbnVsbCwgcmVuZGVyUGxheVBhdXNlQnV0dG9uOiByZW5kZXJQbGF5UGF1c2VCdXR0b24gIT09IG51bGwgJiYgcmVuZGVyUGxheVBhdXNlQnV0dG9uICE9PSB2b2lkIDAgPyByZW5kZXJQbGF5UGF1c2VCdXR0b24gOiBudWxsLCBhbHdheXNTaG93Q29udHJvbHM6IGFsd2F5c1Nob3dDb250cm9scywgc2hvd1BsYXliYWNrUmF0ZUNvbnRyb2w6IHNob3dQbGF5YmFja1JhdGVDb250cm9sIH0pIH0pIH0pIH0pIH0pKTtcbn07XG5jb25zdCBmb3J3YXJkJDEgPSBmb3J3YXJkUmVmO1xuLyoqXG4gKiBAZGVzY3JpcHRpb24gQSBjb21wb25lbnQgd2hpY2ggY2FuIGJlIHJlbmRlcmVkIGluIGEgcmVndWxhciBSZWFjdCBBcHAgKGZvciBleGFtcGxlOiBWaXRlLCBOZXh0LmpzKSB0byBkaXNwbGF5IGEgUmVtb3Rpb24gdmlkZW8uXG4gKiBAc2VlIFtEb2N1bWVudGF0aW9uXShodHRwczovL3d3dy5yZW1vdGlvbi5kZXYvZG9jcy9wbGF5ZXIvcGxheWVyKVxuICovXG5jb25zdCBQbGF5ZXIgPSBmb3J3YXJkJDEoUGxheWVyRm4pO1xuXG5jb25zdCB1c2VUaHVtYm5haWwgPSAoKSA9PiB7XG4gICAgY29uc3QgZW1pdHRlciA9IHVzZUNvbnRleHQoVGh1bWJuYWlsRW1pdHRlckNvbnRleHQpO1xuICAgIGlmICghZW1pdHRlcikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCBQbGF5ZXIgZXZlbnQgZW1pdHRlciBjb250ZXh0Jyk7XG4gICAgfVxuICAgIGNvbnN0IHJldHVyblZhbHVlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBlbWl0dGVyLFxuICAgICAgICB9O1xuICAgIH0sIFtlbWl0dGVyXSk7XG4gICAgcmV0dXJuIHJldHVyblZhbHVlO1xufTtcblxuY29uc3QgcmVhY3RWZXJzaW9uID0gUmVhY3QudmVyc2lvbi5zcGxpdCgnLicpWzBdO1xuaWYgKHJlYWN0VmVyc2lvbiA9PT0gJzAnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBWZXJzaW9uICR7cmVhY3RWZXJzaW9ufSBvZiBcInJlYWN0XCIgaXMgbm90IHN1cHBvcnRlZCBieSBSZW1vdGlvbmApO1xufVxuY29uc3QgZG9lc1JlYWN0VmVyc2lvblN1cHBvcnRTdXNwZW5zZSA9IHBhcnNlSW50KHJlYWN0VmVyc2lvbiwgMTApID49IDE4O1xuY29uc3QgVGh1bWJuYWlsVUkgPSAoeyBzdHlsZSwgaW5wdXRQcm9wcywgZXJyb3JGYWxsYmFjaywgcmVuZGVyTG9hZGluZywgY2xhc3NOYW1lIH0sIHJlZikgPT4ge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgY29uZmlnID0gSW50ZXJuYWxzLnVzZVVuc2FmZVZpZGVvQ29uZmlnKCk7XG4gICAgY29uc3QgdmlkZW8gPSBJbnRlcm5hbHMudXNlVmlkZW8oKTtcbiAgICBjb25zdCBjb250YWluZXIgPSB1c2VSZWYobnVsbCk7XG4gICAgY29uc3QgY2FudmFzU2l6ZSA9IHVzZUVsZW1lbnRTaXplKGNvbnRhaW5lciwge1xuICAgICAgICB0cmlnZ2VyT25XaW5kb3dSZXNpemU6IGZhbHNlLFxuICAgICAgICBzaG91bGRBcHBseUNzc1RyYW5zZm9ybXM6IGZhbHNlLFxuICAgIH0pO1xuICAgIGNvbnN0IGxheW91dCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBpZiAoIWNvbmZpZyB8fCAhY2FudmFzU2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZUNhbnZhc1RyYW5zZm9ybWF0aW9uKHtcbiAgICAgICAgICAgIGNhbnZhc1NpemUsXG4gICAgICAgICAgICBjb21wb3NpdGlvbkhlaWdodDogY29uZmlnLmhlaWdodCxcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uV2lkdGg6IGNvbmZpZy53aWR0aCxcbiAgICAgICAgICAgIHByZXZpZXdTaXplOiAnYXV0bycsXG4gICAgICAgIH0pO1xuICAgIH0sIFtjYW52YXNTaXplLCBjb25maWddKTtcbiAgICBjb25zdCBzY2FsZSA9IChfYSA9IGxheW91dCA9PT0gbnVsbCB8fCBsYXlvdXQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxheW91dC5zY2FsZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMTtcbiAgICBjb25zdCB0aHVtYm5haWwgPSB1c2VUaHVtYm5haWwoKTtcbiAgICB1c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBtZXRob2RzID0ge1xuICAgICAgICAgICAgZ2V0Q29udGFpbmVyTm9kZTogKCkgPT4gY29udGFpbmVyLmN1cnJlbnQsXG4gICAgICAgICAgICBnZXRTY2FsZTogKCkgPT4gc2NhbGUsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHRodW1ibmFpbC5lbWl0dGVyLCBtZXRob2RzKTtcbiAgICB9LCBbc2NhbGUsIHRodW1ibmFpbC5lbWl0dGVyXSk7XG4gICAgY29uc3QgVmlkZW9Db21wb25lbnQgPSB2aWRlbyA/IHZpZGVvLmNvbXBvbmVudCA6IG51bGw7XG4gICAgY29uc3Qgb3V0ZXJTdHlsZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4gY2FsY3VsYXRlT3V0ZXJTdHlsZSh7IGNvbmZpZywgc3R5bGUsIGNhbnZhc1NpemUgfSk7XG4gICAgfSwgW2NhbnZhc1NpemUsIGNvbmZpZywgc3R5bGVdKTtcbiAgICBjb25zdCBvdXRlciA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4gY2FsY3VsYXRlT3V0ZXIoeyBjb25maWcsIGxheW91dCwgc2NhbGUgfSk7XG4gICAgfSwgW2NvbmZpZywgbGF5b3V0LCBzY2FsZV0pO1xuICAgIGNvbnN0IGNvbnRhaW5lclN0eWxlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiBjYWxjdWxhdGVDb250YWluZXJTdHlsZSh7XG4gICAgICAgICAgICBjYW52YXNTaXplLFxuICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgbGF5b3V0LFxuICAgICAgICAgICAgc2NhbGUsXG4gICAgICAgIH0pO1xuICAgIH0sIFtjYW52YXNTaXplLCBjb25maWcsIGxheW91dCwgc2NhbGVdKTtcbiAgICBjb25zdCBvbkVycm9yID0gdXNlQ2FsbGJhY2soKGVycm9yKSA9PiB7XG4gICAgICAgIC8vIFBheSBhdHRlbnRpb24gdG8gYHRoaXMgY29udGV4dGBcbiAgICAgICAgdGh1bWJuYWlsLmVtaXR0ZXIuZGlzcGF0Y2hFcnJvcihlcnJvcik7XG4gICAgfSwgW3RodW1ibmFpbC5lbWl0dGVyXSk7XG4gICAgY29uc3Qgcm9vdFJlZiA9IHVzZVJlZihudWxsKTtcbiAgICB1c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgKCkgPT4gcm9vdFJlZi5jdXJyZW50LCBbXSk7XG4gICAgY29uc3QgbG9hZGluZ01hcmt1cCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4gcmVuZGVyTG9hZGluZ1xuICAgICAgICAgICAgPyByZW5kZXJMb2FkaW5nKHtcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IG91dGVyU3R5bGUuaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHdpZHRoOiBvdXRlclN0eWxlLndpZHRoLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICB9LCBbb3V0ZXJTdHlsZS5oZWlnaHQsIG91dGVyU3R5bGUud2lkdGgsIHJlbmRlckxvYWRpbmddKTtcbiAgICBpZiAoIWNvbmZpZykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IChqc3goXCJkaXZcIiwgeyBzdHlsZTogb3V0ZXIsIGNoaWxkcmVuOiBqc3goXCJkaXZcIiwgeyBzdHlsZTogY29udGFpbmVyU3R5bGUsIGNsYXNzTmFtZTogUExBWUVSX0NTU19DTEFTU05BTUUsIGNoaWxkcmVuOiBWaWRlb0NvbXBvbmVudCA/IChqc3goRXJyb3JCb3VuZGFyeSwgeyBvbkVycm9yOiBvbkVycm9yLCBlcnJvckZhbGxiYWNrOiBlcnJvckZhbGxiYWNrLCBjaGlsZHJlbjoganN4KFZpZGVvQ29tcG9uZW50LCB7IC4uLigoX2IgPSB2aWRlbyA9PT0gbnVsbCB8fCB2aWRlbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmlkZW8ucHJvcHMpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHt9KSwgLi4uKGlucHV0UHJvcHMgIT09IG51bGwgJiYgaW5wdXRQcm9wcyAhPT0gdm9pZCAwID8gaW5wdXRQcm9wcyA6IHt9KSB9KSB9KSkgOiBudWxsIH0pIH0pKTtcbiAgICBpZiAoSVNfTk9ERSAmJiAhZG9lc1JlYWN0VmVyc2lvblN1cHBvcnRTdXNwZW5zZSkge1xuICAgICAgICByZXR1cm4gKGpzeChcImRpdlwiLCB7IHJlZjogY29udGFpbmVyLCBzdHlsZTogb3V0ZXJTdHlsZSwgY2xhc3NOYW1lOiBjbGFzc05hbWUsIGNoaWxkcmVuOiBjb250ZW50IH0pKTtcbiAgICB9XG4gICAgcmV0dXJuIChqc3goXCJkaXZcIiwgeyByZWY6IGNvbnRhaW5lciwgc3R5bGU6IG91dGVyU3R5bGUsIGNsYXNzTmFtZTogY2xhc3NOYW1lLCBjaGlsZHJlbjoganN4KFN1c3BlbnNlLCB7IGZhbGxiYWNrOiBsb2FkaW5nTWFya3VwLCBjaGlsZHJlbjogY29udGVudCB9KSB9KSk7XG59O1xudmFyIFRodW1ibmFpbFVJJDEgPSBmb3J3YXJkUmVmKFRodW1ibmFpbFVJKTtcblxuY29uc3QgVGh1bWJuYWlsRm4gPSAoeyBmcmFtZVRvRGlzcGxheSwgc3R5bGUsIGlucHV0UHJvcHMsIGNvbXBvc2l0aW9uSGVpZ2h0LCBjb21wb3NpdGlvbldpZHRoLCBkdXJhdGlvbkluRnJhbWVzLCBmcHMsIGNsYXNzTmFtZSwgZXJyb3JGYWxsYmFjayA9ICgpID0+ICfimqDvuI8nLCByZW5kZXJMb2FkaW5nLCAuLi5jb21wb25lbnRQcm9wcyB9LCByZWYpID0+IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gICAgICAgIHVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3Rpb25faXNQbGF5ZXIgPSB0cnVlO1xuICAgICAgICB9LCBbXSk7XG4gICAgfVxuICAgIGNvbnN0IFt0aHVtYm5haWxJZF0gPSB1c2VTdGF0ZSgoKSA9PiBTdHJpbmcocmFuZG9tKG51bGwpKSk7XG4gICAgY29uc3Qgcm9vdFJlZiA9IHVzZVJlZihudWxsKTtcbiAgICBjb25zdCB0aW1lbGluZVN0YXRlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0ge1xuICAgICAgICAgICAgcGxheWluZzogZmFsc2UsXG4gICAgICAgICAgICBmcmFtZToge1xuICAgICAgICAgICAgICAgIFtQTEFZRVJfQ09NUF9JRF06IGZyYW1lVG9EaXNwbGF5LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJvb3RJZDogdGh1bWJuYWlsSWQsXG4gICAgICAgICAgICBpbXBlcmF0aXZlUGxheWluZzoge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQ6IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBsYXliYWNrUmF0ZTogMSxcbiAgICAgICAgICAgIHNldFBsYXliYWNrUmF0ZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndGh1bWJuYWlsJyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXVkaW9BbmRWaWRlb1RhZ3M6IHsgY3VycmVudDogW10gfSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sIFtmcmFtZVRvRGlzcGxheSwgdGh1bWJuYWlsSWRdKTtcbiAgICB1c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgKCkgPT4gcm9vdFJlZi5jdXJyZW50LCBbXSk7XG4gICAgY29uc3QgQ29tcG9uZW50ID0gSW50ZXJuYWxzLnVzZUxhenlDb21wb25lbnQoY29tcG9uZW50UHJvcHMpO1xuICAgIGNvbnN0IFtlbWl0dGVyXSA9IHVzZVN0YXRlKCgpID0+IG5ldyBUaHVtYm5haWxFbWl0dGVyKCkpO1xuICAgIGNvbnN0IHBhc3NlZElucHV0UHJvcHMgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIGlucHV0UHJvcHMgIT09IG51bGwgJiYgaW5wdXRQcm9wcyAhPT0gdm9pZCAwID8gaW5wdXRQcm9wcyA6IHt9O1xuICAgIH0sIFtpbnB1dFByb3BzXSk7XG4gICAgcmV0dXJuIChqc3goSW50ZXJuYWxzLklzUGxheWVyQ29udGV4dFByb3ZpZGVyLCB7IGNoaWxkcmVuOiBqc3goU2hhcmVkUGxheWVyQ29udGV4dHMsIHsgdGltZWxpbmVDb250ZXh0OiB0aW1lbGluZVN0YXRlLCBjb21wb25lbnQ6IENvbXBvbmVudCwgY29tcG9zaXRpb25IZWlnaHQ6IGNvbXBvc2l0aW9uSGVpZ2h0LCBjb21wb3NpdGlvbldpZHRoOiBjb21wb3NpdGlvbldpZHRoLCBkdXJhdGlvbkluRnJhbWVzOiBkdXJhdGlvbkluRnJhbWVzLCBmcHM6IGZwcywgbnVtYmVyT2ZTaGFyZWRBdWRpb1RhZ3M6IDAsIGluaXRpYWxseU11dGVkOiB0cnVlLCBjaGlsZHJlbjoganN4KFRodW1ibmFpbEVtaXR0ZXJDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiBlbWl0dGVyLCBjaGlsZHJlbjoganN4KFRodW1ibmFpbFVJJDEsIHsgY2xhc3NOYW1lOiBjbGFzc05hbWUsIGVycm9yRmFsbGJhY2s6IGVycm9yRmFsbGJhY2ssIGlucHV0UHJvcHM6IHBhc3NlZElucHV0UHJvcHMsIHJlbmRlckxvYWRpbmc6IHJlbmRlckxvYWRpbmcsIHN0eWxlOiBzdHlsZSB9KSB9KSB9KSB9KSk7XG59O1xuY29uc3QgZm9yd2FyZCA9IGZvcndhcmRSZWY7XG4vKipcbiAqIEBkZXNjcmlwdGlvbiBBIGNvbXBvbmVudCB3aGljaCBjYW4gYmUgcmVuZGVyZWQgaW4gYSByZWd1bGFyIFJlYWN0IEFwcCAoZm9yIGV4YW1wbGU6IENyZWF0ZSBSZWFjdCBBcHAsIE5leHQuanMpIHRvIGRpc3BsYXkgYSBzaW5nbGUgZnJhbWUgb2YgYSB2aWRlby5cbiAqIEBzZWUgW0RvY3VtZW50YXRpb25dKGh0dHBzOi8vd3d3LnJlbW90aW9uLmRldi9kb2NzL3BsYXllci90aHVtYm5haWwpXG4gKi9cbmNvbnN0IFRodW1ibmFpbCA9IGZvcndhcmQoVGh1bWJuYWlsRm4pO1xuXG5jb25zdCBQbGF5ZXJJbnRlcm5hbHMgPSB7XG4gICAgUGxheWVyRXZlbnRFbWl0dGVyQ29udGV4dCxcbiAgICBQbGF5ZXJFbWl0dGVyLFxuICAgIHVzZVBsYXllcixcbiAgICB1c2VQbGF5YmFjayxcbiAgICB1c2VFbGVtZW50U2l6ZSxcbiAgICBjYWxjdWxhdGVDYW52YXNUcmFuc2Zvcm1hdGlvbixcbiAgICB1c2VIb3ZlclN0YXRlLFxuICAgIHVwZGF0ZUFsbEVsZW1lbnRzU2l6ZXMsXG4gICAgY2FsY3VsYXRlU2NhbGUsXG59O1xuXG5leHBvcnQgeyBQbGF5ZXIsIFBsYXllckludGVybmFscywgVGh1bWJuYWlsIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@remotion+player@4.0.47_react-dom@18.2.0_react@18.2.0/node_modules/@remotion/player/dist/esm/index.mjs\n");

/***/ })

};
;